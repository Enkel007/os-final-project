<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=fpjTOVmNbO4Lz34iLyptLTi9jKYd1gJzj5O2gWsEpXol-nTHck7FFkZplK5meosG);.lst-kix_ewh8jws4d7aj-7>li:before{content:"\0025cb   "}.lst-kix_ewh8jws4d7aj-8>li:before{content:"\0025a0   "}.lst-kix_9f70qg6dgf9-5>li:before{content:"\0025a0   "}.lst-kix_9f70qg6dgf9-7>li:before{content:"\0025cb   "}.lst-kix_bqcb8qaq4vwy-3>li{counter-increment:lst-ctn-kix_bqcb8qaq4vwy-3}.lst-kix_bu6svid14rcv-5>li:before{content:"\0025a0   "}.lst-kix_bu6svid14rcv-7>li:before{content:"\0025cb   "}ul.lst-kix_9f70qg6dgf9-0{list-style-type:none}ol.lst-kix_bqcb8qaq4vwy-1.start{counter-reset:lst-ctn-kix_bqcb8qaq4vwy-1 0}.lst-kix_9f70qg6dgf9-4>li:before{content:"\0025cb   "}.lst-kix_9f70qg6dgf9-8>li:before{content:"\0025a0   "}.lst-kix_bu6svid14rcv-4>li:before{content:"\0025cb   "}.lst-kix_bu6svid14rcv-8>li:before{content:"\0025a0   "}ul.lst-kix_9f70qg6dgf9-4{list-style-type:none}.lst-kix_ewh8jws4d7aj-3>li:before{content:"\0025cf   "}ul.lst-kix_9f70qg6dgf9-3{list-style-type:none}ul.lst-kix_9f70qg6dgf9-2{list-style-type:none}.lst-kix_9f70qg6dgf9-1>li:before{content:"\0025cb   "}ul.lst-kix_9f70qg6dgf9-1{list-style-type:none}.lst-kix_9f70qg6dgf9-3>li:before{content:"\0025cf   "}ul.lst-kix_9f70qg6dgf9-8{list-style-type:none}.lst-kix_ewh8jws4d7aj-1>li:before{content:"\0025cb   "}.lst-kix_ewh8jws4d7aj-2>li:before{content:"\0025a0   "}ul.lst-kix_9f70qg6dgf9-7{list-style-type:none}ul.lst-kix_9f70qg6dgf9-6{list-style-type:none}.lst-kix_9f70qg6dgf9-2>li:before{content:"\0025a0   "}ul.lst-kix_9f70qg6dgf9-5{list-style-type:none}.lst-kix_bu6svid14rcv-6>li:before{content:"\0025cf   "}.lst-kix_ewh8jws4d7aj-0>li:before{content:"\0025cf   "}.lst-kix_9f70qg6dgf9-0>li:before{content:"\0025cf   "}.lst-kix_bqcb8qaq4vwy-4>li{counter-increment:lst-ctn-kix_bqcb8qaq4vwy-4}.lst-kix_bu6svid14rcv-0>li:before{content:"\0025cf   "}.lst-kix_bu6svid14rcv-1>li:before{content:"\0025cb   "}.lst-kix_bu6svid14rcv-3>li:before{content:"\0025cf   "}.lst-kix_jnx53cv5d6p3-0>li{counter-increment:lst-ctn-kix_jnx53cv5d6p3-0}.lst-kix_bu6svid14rcv-2>li:before{content:"\0025a0   "}.lst-kix_jnx53cv5d6p3-0>li:before{content:"" counter(lst-ctn-kix_jnx53cv5d6p3-0,decimal) ". "}.lst-kix_jnx53cv5d6p3-1>li{counter-increment:lst-ctn-kix_jnx53cv5d6p3-1}.lst-kix_7ye12kprvif2-7>li:before{content:"\0025cb   "}.lst-kix_7ye12kprvif2-6>li:before{content:"\0025cf   "}.lst-kix_7ye12kprvif2-4>li:before{content:"\0025cb   "}.lst-kix_7ye12kprvif2-5>li:before{content:"\0025a0   "}ol.lst-kix_jnx53cv5d6p3-1.start{counter-reset:lst-ctn-kix_jnx53cv5d6p3-1 0}.lst-kix_7ye12kprvif2-2>li:before{content:"\0025a0   "}.lst-kix_ewh8jws4d7aj-4>li:before{content:"\0025cb   "}.lst-kix_ewh8jws4d7aj-5>li:before{content:"\0025a0   "}.lst-kix_ewh8jws4d7aj-6>li:before{content:"\0025cf   "}.lst-kix_7ye12kprvif2-3>li:before{content:"\0025cf   "}.lst-kix_jnx53cv5d6p3-2>li{counter-increment:lst-ctn-kix_jnx53cv5d6p3-2}.lst-kix_jnx53cv5d6p3-8>li{counter-increment:lst-ctn-kix_jnx53cv5d6p3-8}.lst-kix_cij5eybiimv2-3>li:before{content:"\0025cf   "}ol.lst-kix_jnx53cv5d6p3-7.start{counter-reset:lst-ctn-kix_jnx53cv5d6p3-7 0}ol.lst-kix_bqcb8qaq4vwy-3.start{counter-reset:lst-ctn-kix_bqcb8qaq4vwy-3 0}.lst-kix_cij5eybiimv2-2>li:before{content:"\0025a0   "}.lst-kix_7ye12kprvif2-8>li:before{content:"\0025a0   "}.lst-kix_cij5eybiimv2-1>li:before{content:"\0025cb   "}.lst-kix_cij5eybiimv2-0>li:before{content:"\0025cf   "}ul.lst-kix_7ye12kprvif2-0{list-style-type:none}ul.lst-kix_7ye12kprvif2-1{list-style-type:none}ul.lst-kix_7ye12kprvif2-2{list-style-type:none}ul.lst-kix_7ye12kprvif2-3{list-style-type:none}ul.lst-kix_7ye12kprvif2-4{list-style-type:none}ol.lst-kix_jnx53cv5d6p3-0.start{counter-reset:lst-ctn-kix_jnx53cv5d6p3-0 0}ul.lst-kix_7ye12kprvif2-5{list-style-type:none}ul.lst-kix_7ye12kprvif2-6{list-style-type:none}ul.lst-kix_7ye12kprvif2-7{list-style-type:none}ul.lst-kix_7ye12kprvif2-8{list-style-type:none}ol.lst-kix_bqcb8qaq4vwy-4.start{counter-reset:lst-ctn-kix_bqcb8qaq4vwy-4 0}.lst-kix_bqcb8qaq4vwy-8>li{counter-increment:lst-ctn-kix_bqcb8qaq4vwy-8}.lst-kix_bqcb8qaq4vwy-5>li{counter-increment:lst-ctn-kix_bqcb8qaq4vwy-5}ol.lst-kix_jnx53cv5d6p3-6.start{counter-reset:lst-ctn-kix_jnx53cv5d6p3-6 0}.lst-kix_jnx53cv5d6p3-5>li{counter-increment:lst-ctn-kix_jnx53cv5d6p3-5}.lst-kix_9f70qg6dgf9-6>li:before{content:"\0025cf   "}.lst-kix_bqcb8qaq4vwy-2>li{counter-increment:lst-ctn-kix_bqcb8qaq4vwy-2}ul.lst-kix_bu6svid14rcv-2{list-style-type:none}ul.lst-kix_bu6svid14rcv-3{list-style-type:none}ul.lst-kix_bu6svid14rcv-0{list-style-type:none}ul.lst-kix_bu6svid14rcv-1{list-style-type:none}ul.lst-kix_bu6svid14rcv-6{list-style-type:none}ul.lst-kix_bu6svid14rcv-7{list-style-type:none}ul.lst-kix_bu6svid14rcv-4{list-style-type:none}ul.lst-kix_bu6svid14rcv-5{list-style-type:none}ol.lst-kix_bqcb8qaq4vwy-8.start{counter-reset:lst-ctn-kix_bqcb8qaq4vwy-8 0}ul.lst-kix_bu6svid14rcv-8{list-style-type:none}ol.lst-kix_jnx53cv5d6p3-2.start{counter-reset:lst-ctn-kix_jnx53cv5d6p3-2 0}ol.lst-kix_bqcb8qaq4vwy-5.start{counter-reset:lst-ctn-kix_bqcb8qaq4vwy-5 0}ol.lst-kix_jnx53cv5d6p3-5.start{counter-reset:lst-ctn-kix_jnx53cv5d6p3-5 0}ol.lst-kix_jnx53cv5d6p3-8.start{counter-reset:lst-ctn-kix_jnx53cv5d6p3-8 0}ul.lst-kix_cij5eybiimv2-0{list-style-type:none}.lst-kix_jnx53cv5d6p3-6>li{counter-increment:lst-ctn-kix_jnx53cv5d6p3-6}.lst-kix_jnx53cv5d6p3-4>li{counter-increment:lst-ctn-kix_jnx53cv5d6p3-4}ul.lst-kix_cij5eybiimv2-2{list-style-type:none}ul.lst-kix_cij5eybiimv2-1{list-style-type:none}ul.lst-kix_cij5eybiimv2-4{list-style-type:none}ul.lst-kix_cij5eybiimv2-3{list-style-type:none}ul.lst-kix_cij5eybiimv2-6{list-style-type:none}ul.lst-kix_cij5eybiimv2-5{list-style-type:none}ul.lst-kix_cij5eybiimv2-8{list-style-type:none}.lst-kix_cij5eybiimv2-4>li:before{content:"\0025cb   "}ul.lst-kix_cij5eybiimv2-7{list-style-type:none}.lst-kix_cij5eybiimv2-5>li:before{content:"\0025a0   "}ol.lst-kix_jnx53cv5d6p3-8{list-style-type:none}ol.lst-kix_bqcb8qaq4vwy-2.start{counter-reset:lst-ctn-kix_bqcb8qaq4vwy-2 0}ol.lst-kix_jnx53cv5d6p3-6{list-style-type:none}ol.lst-kix_jnx53cv5d6p3-7{list-style-type:none}.lst-kix_cij5eybiimv2-6>li:before{content:"\0025cf   "}.lst-kix_cij5eybiimv2-8>li:before{content:"\0025a0   "}ol.lst-kix_jnx53cv5d6p3-4{list-style-type:none}ol.lst-kix_jnx53cv5d6p3-5{list-style-type:none}ol.lst-kix_jnx53cv5d6p3-2{list-style-type:none}ol.lst-kix_jnx53cv5d6p3-3{list-style-type:none}.lst-kix_cij5eybiimv2-7>li:before{content:"\0025cb   "}ol.lst-kix_jnx53cv5d6p3-0{list-style-type:none}ol.lst-kix_jnx53cv5d6p3-1{list-style-type:none}ol.lst-kix_jnx53cv5d6p3-4.start{counter-reset:lst-ctn-kix_jnx53cv5d6p3-4 0}.lst-kix_7ye12kprvif2-0>li:before{content:"\0025cf   "}ol.lst-kix_bqcb8qaq4vwy-6.start{counter-reset:lst-ctn-kix_bqcb8qaq4vwy-6 0}.lst-kix_7ye12kprvif2-1>li:before{content:"\0025cb   "}.lst-kix_bqcb8qaq4vwy-0>li{counter-increment:lst-ctn-kix_bqcb8qaq4vwy-0}.lst-kix_jnx53cv5d6p3-8>li:before{content:"" counter(lst-ctn-kix_jnx53cv5d6p3-8,lower-roman) ". "}ul.lst-kix_ewh8jws4d7aj-5{list-style-type:none}ul.lst-kix_ewh8jws4d7aj-6{list-style-type:none}ul.lst-kix_ewh8jws4d7aj-7{list-style-type:none}ul.lst-kix_ewh8jws4d7aj-8{list-style-type:none}.lst-kix_bqcb8qaq4vwy-4>li:before{content:"" counter(lst-ctn-kix_bqcb8qaq4vwy-4,lower-latin) ". "}.lst-kix_jnx53cv5d6p3-7>li:before{content:"" counter(lst-ctn-kix_jnx53cv5d6p3-7,lower-latin) ". "}.lst-kix_bqcb8qaq4vwy-6>li{counter-increment:lst-ctn-kix_bqcb8qaq4vwy-6}.lst-kix_jnx53cv5d6p3-4>li:before{content:"" counter(lst-ctn-kix_jnx53cv5d6p3-4,lower-latin) ". "}ol.lst-kix_bqcb8qaq4vwy-1{list-style-type:none}ol.lst-kix_bqcb8qaq4vwy-0{list-style-type:none}ol.lst-kix_bqcb8qaq4vwy-3{list-style-type:none}ul.lst-kix_ewh8jws4d7aj-0{list-style-type:none}.lst-kix_bqcb8qaq4vwy-1>li{counter-increment:lst-ctn-kix_bqcb8qaq4vwy-1}ol.lst-kix_bqcb8qaq4vwy-2{list-style-type:none}.lst-kix_jnx53cv5d6p3-2>li:before{content:"" counter(lst-ctn-kix_jnx53cv5d6p3-2,lower-roman) ". "}.lst-kix_jnx53cv5d6p3-6>li:before{content:"" counter(lst-ctn-kix_jnx53cv5d6p3-6,decimal) ". "}ul.lst-kix_ewh8jws4d7aj-1{list-style-type:none}ul.lst-kix_ewh8jws4d7aj-2{list-style-type:none}.lst-kix_bqcb8qaq4vwy-5>li:before{content:"" counter(lst-ctn-kix_bqcb8qaq4vwy-5,lower-roman) ". "}.lst-kix_jnx53cv5d6p3-1>li:before{content:"" counter(lst-ctn-kix_jnx53cv5d6p3-1,lower-latin) ". "}.lst-kix_jnx53cv5d6p3-3>li{counter-increment:lst-ctn-kix_jnx53cv5d6p3-3}.lst-kix_jnx53cv5d6p3-5>li:before{content:"" counter(lst-ctn-kix_jnx53cv5d6p3-5,lower-roman) ". "}ul.lst-kix_ewh8jws4d7aj-3{list-style-type:none}.lst-kix_jnx53cv5d6p3-7>li{counter-increment:lst-ctn-kix_jnx53cv5d6p3-7}ul.lst-kix_ewh8jws4d7aj-4{list-style-type:none}.lst-kix_bqcb8qaq4vwy-6>li:before{content:"" counter(lst-ctn-kix_bqcb8qaq4vwy-6,decimal) ". "}.lst-kix_bqcb8qaq4vwy-7>li:before{content:"" counter(lst-ctn-kix_bqcb8qaq4vwy-7,lower-latin) ". "}ol.lst-kix_bqcb8qaq4vwy-8{list-style-type:none}ol.lst-kix_bqcb8qaq4vwy-5{list-style-type:none}.lst-kix_bqcb8qaq4vwy-7>li{counter-increment:lst-ctn-kix_bqcb8qaq4vwy-7}ol.lst-kix_bqcb8qaq4vwy-4{list-style-type:none}.lst-kix_bqcb8qaq4vwy-8>li:before{content:"" counter(lst-ctn-kix_bqcb8qaq4vwy-8,lower-roman) ". "}.lst-kix_jnx53cv5d6p3-3>li:before{content:"" counter(lst-ctn-kix_jnx53cv5d6p3-3,decimal) ". "}ol.lst-kix_bqcb8qaq4vwy-7{list-style-type:none}ol.lst-kix_bqcb8qaq4vwy-6{list-style-type:none}ol.lst-kix_jnx53cv5d6p3-3.start{counter-reset:lst-ctn-kix_jnx53cv5d6p3-3 0}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ol.lst-kix_bqcb8qaq4vwy-0.start{counter-reset:lst-ctn-kix_bqcb8qaq4vwy-0 0}.lst-kix_bqcb8qaq4vwy-2>li:before{content:"" counter(lst-ctn-kix_bqcb8qaq4vwy-2,lower-roman) ". "}.lst-kix_bqcb8qaq4vwy-3>li:before{content:"" counter(lst-ctn-kix_bqcb8qaq4vwy-3,decimal) ". "}.lst-kix_bqcb8qaq4vwy-1>li:before{content:"" counter(lst-ctn-kix_bqcb8qaq4vwy-1,lower-latin) ". "}.lst-kix_bqcb8qaq4vwy-0>li:before{content:"" counter(lst-ctn-kix_bqcb8qaq4vwy-0,decimal) ". "}ol.lst-kix_bqcb8qaq4vwy-7.start{counter-reset:lst-ctn-kix_bqcb8qaq4vwy-7 0}ol{margin:0;padding:0}table td,table th{padding:0}.c115{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:466.5pt;border-top-color:#000000;border-bottom-style:solid}.c193{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:200.2pt;border-top-color:#000000;border-bottom-style:solid}.c98{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:472.6pt;border-top-color:#000000;border-bottom-style:solid}.c14{-webkit-text-decoration-skip:none;color:#0000ff;font-weight:400;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-size:11pt;font-family:"Calibri";font-style:normal}.c20{background-color:#ffffff;color:#333333;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Calibri";font-style:normal}.c27{background-color:#ffffff;color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:13.6pt;font-family:"Times New Roman";font-style:normal}.c17{background-color:#ffffff;color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:13.6pt;font-family:"Times New Roman";font-style:normal}.c1{background-color:#e0e0e0;color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Courier New";font-style:normal}.c2{background-color:#ffffff;color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:9.6pt;font-family:"Courier New";font-style:normal}.c18{background-color:#ffffff;color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9.6pt;font-family:"Courier New";font-style:normal}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Courier New";font-style:normal}.c48{margin-left:36.2pt;padding-top:17.4pt;text-indent:-17.6pt;padding-bottom:0pt;line-height:1.0934374332427979;text-align:justify;margin-right:2pt}.c68{margin-left:29pt;padding-top:0.6pt;text-indent:-17.2pt;padding-bottom:0pt;line-height:1.014086365699768;text-align:justify;margin-right:2pt}.c78{margin-left:29.6pt;padding-top:0.4pt;text-indent:-17.9pt;padding-bottom:0pt;line-height:1.0155946016311646;text-align:left;margin-right:2.3pt}.c216{margin-left:36pt;padding-top:15pt;text-indent:-17.9pt;padding-bottom:0pt;line-height:0.9634692668914795;text-align:justify;margin-right:2.2pt}.c75{margin-left:29.5pt;padding-top:0.4pt;text-indent:-18.2pt;padding-bottom:0pt;line-height:1.0140892267227173;text-align:left;margin-right:2.4pt}.c43{margin-left:11.1pt;padding-top:0.4pt;text-indent:-0.3pt;padding-bottom:0pt;line-height:1.0095621347427368;text-align:left;margin-right:2.1pt}.c31{margin-left:29.5pt;padding-top:0.4pt;text-indent:-18.2pt;padding-bottom:0pt;line-height:1.015219807624817;text-align:justify;margin-right:2.1pt}.c118{margin-left:27.5pt;padding-top:25.3pt;text-indent:-17.9pt;padding-bottom:0pt;line-height:1.0140892267227173;text-align:justify;margin-right:2.3pt}.c8{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c165{margin-left:36.2pt;padding-top:14.5pt;text-indent:-17.7pt;padding-bottom:0pt;line-height:1.014086365699768;text-align:left;margin-right:71.8pt}.c150{margin-left:4.2pt;padding-top:0pt;text-indent:-2pt;padding-bottom:0pt;line-height:0.9433979988098145;text-align:left;margin-right:26.2pt}.c206{margin-left:0.3pt;padding-top:13.7pt;text-indent:-0.1pt;padding-bottom:0pt;line-height:0.9509477615356445;text-align:left;margin-right:45.5pt}.c70{margin-left:0.2pt;padding-top:0pt;text-indent:0.8pt;padding-bottom:0pt;line-height:1.0140892267227173;text-align:justify;margin-right:2.2pt}.c85{margin-left:36.2pt;padding-top:0.5pt;text-indent:0.7pt;padding-bottom:0pt;line-height:1.0140869617462158;text-align:left;margin-right:5pt}.c161{margin-left:36.3pt;padding-top:14.6pt;text-indent:-17.8pt;padding-bottom:0pt;line-height:1.0140892267227173;text-align:left;margin-right:34.9pt}.c90{margin-left:36.1pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.963468074798584;text-align:justify;margin-right:2.1pt}.c37{color:#333333;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Courier New";font-style:normal}.c104{color:#231f20;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Times New Roman";font-style:normal}.c64{margin-left:29.3pt;padding-top:0.4pt;text-indent:-18.1pt;padding-bottom:0pt;line-height:1.011068344116211;text-align:justify;margin-right:2.1pt}.c44{color:#333333;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Calibri";font-style:normal}.c175{margin-left:0.3pt;padding-top:0pt;text-indent:-0.2pt;padding-bottom:0pt;line-height:0.9509468674659729;text-align:left;margin-right:31.4pt}.c100{margin-left:29.5pt;padding-top:0.5pt;text-indent:-18.1pt;padding-bottom:0pt;line-height:1.0140892267227173;text-align:left;margin-right:2.4pt}.c12{margin-left:54.2pt;padding-top:0.6pt;text-indent:0.8pt;padding-bottom:0pt;line-height:1.0942202806472778;text-align:justify;margin-right:2pt}.c84{margin-left:0.2pt;padding-top:14.6pt;text-indent:0.8pt;padding-bottom:0pt;line-height:1.0125772953033447;text-align:justify;margin-right:2.1pt}.c50{color:#231f20;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Times New Roman";font-style:normal}.c25{margin-left:54pt;padding-top:1.6pt;text-indent:-0.2pt;padding-bottom:0pt;line-height:1.0930598974227905;text-align:justify;margin-right:2.2pt}.c194{margin-left:36.1pt;padding-top:0pt;text-indent:-18pt;padding-bottom:0pt;line-height:0.9592862129211426;text-align:justify;margin-right:2.1pt}.c63{margin-left:36.7pt;padding-top:14.6pt;text-indent:-17.8pt;padding-bottom:0pt;line-height:1.0050324201583862;text-align:left;margin-right:15.7pt}.c81{margin-left:2.3pt;padding-top:11.6pt;text-indent:0.8pt;padding-bottom:0pt;line-height:0.9466316103935242;text-align:left;margin-right:44.3pt}.c204{margin-left:0.7pt;padding-top:0pt;text-indent:-0.5pt;padding-bottom:0pt;line-height:0.9509468674659729;text-align:left;margin-right:20.7pt}.c154{margin-left:36.5pt;padding-top:14.5pt;text-indent:-18pt;padding-bottom:0pt;line-height:1.014086365699768;text-align:left;margin-right:2.3pt}.c80{margin-left:0.2pt;padding-top:0pt;text-indent:0.4pt;padding-bottom:0pt;line-height:1.8134338855743408;text-align:left;margin-right:44.1pt}.c10{margin-left:2.6pt;padding-top:11.1pt;text-indent:0.3pt;padding-bottom:0pt;line-height:0.943397581577301;text-align:left;margin-right:56.3pt}.c54{margin-left:0.3pt;padding-top:13.6pt;text-indent:0.3pt;padding-bottom:0pt;line-height:0.9583172798156738;text-align:left;margin-right:2.4pt}.c212{margin-left:54.5pt;padding-top:1.5pt;text-indent:-18.3pt;padding-bottom:0pt;line-height:1.0933151245117188;text-align:left;margin-right:2.1pt}.c122{margin-left:54.2pt;padding-top:0.6pt;text-indent:-17.2pt;padding-bottom:0pt;line-height:1.0925571918487549;text-align:justify;margin-right:2.1pt}.c113{margin-left:36.2pt;padding-top:15pt;text-indent:-17.6pt;padding-bottom:0pt;line-height:1.0955767631530762;text-align:left;margin-right:2.2pt}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c49{padding-top:0pt;text-indent:-0.9pt;padding-bottom:0pt;line-height:0.9450671076774597;text-align:left;margin-right:8.3pt}.c40{margin-left:36pt;padding-top:14.4pt;padding-bottom:0pt;line-height:1.0;padding-left:0pt;text-align:left}.c105{margin-left:0.8pt;padding-top:0pt;padding-bottom:0pt;line-height:1.014086365699768;text-align:left;margin-right:43.3pt}.c134{margin-left:55.4pt;padding-top:0pt;padding-bottom:0pt;line-height:0.957949161529541;text-align:center;margin-right:53.2pt}.c109{margin-left:22pt;padding-top:14.6pt;padding-bottom:0pt;line-height:0.957949161529541;text-align:center;margin-right:20.3pt}.c4{padding-top:13.7pt;padding-bottom:0pt;line-height:0.9546334147453308;text-align:left;margin-right:30.7pt;height:11pt}.c158{padding-top:0pt;text-indent:0.9pt;padding-bottom:0pt;line-height:0.953433632850647;text-align:left;margin-right:38.3pt}.c182{-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-style:normal}.c19{margin-left:2.9pt;padding-top:11.1pt;padding-bottom:0pt;line-height:1.8968323469161987;text-align:left;margin-right:110.3pt}.c187{-webkit-text-decoration-skip:none;color:#0000ff;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-style:normal}.c190{margin-left:0.1pt;padding-top:43.2pt;padding-bottom:0pt;line-height:0.955517590045929;text-align:justify;margin-right:1pt}.c162{padding-top:0pt;text-indent:-0pt;padding-bottom:0pt;line-height:1.813433289527893;text-align:left;margin-right:88.2pt}.c183{-webkit-text-decoration-skip:none;color:#000000;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-style:normal}.c214{padding-top:11.1pt;text-indent:6.1pt;padding-bottom:0pt;line-height:0.9433929324150085;text-align:left;margin-right:44.3pt}.c13{margin-left:11.2pt;padding-top:0.4pt;padding-bottom:0pt;line-height:1.0;text-align:left;height:11pt}.c95{margin-left:2.8pt;padding-top:0.6pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c159{margin-left:3.1pt;padding-top:11.1pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c217{margin-left:18.5pt;padding-top:14.5pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c148{padding-top:11.1pt;padding-bottom:0pt;line-height:0.9496691226959229;text-align:left;margin-right:26.2pt}.c42{margin-left:0.2pt;padding-top:14.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c189{padding-top:17.4pt;padding-bottom:0pt;line-height:1.0934374332427979;text-align:justify;margin-right:2pt}.c213{margin-left:72.4pt;padding-top:1.6pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c149{margin-left:2.8pt;padding-top:27.4pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c139{padding-top:13.7pt;padding-bottom:0pt;line-height:0.9546334147453308;text-align:left;margin-right:30.7pt}.c36{margin-left:2.9pt;padding-top:11.1pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c136{padding-top:5.9pt;padding-bottom:0pt;line-height:0.9609602093696594;text-align:justify;margin-right:2.2pt}.c103{padding-top:14pt;padding-bottom:0pt;line-height:0.9579505920410156;text-indent:0.1pt;text-align:justify}.c123{padding-top:66.9pt;padding-bottom:0pt;line-height:0.9584519267082214;text-align:justify;margin-right:2.1pt}.c99{margin-left:18.8pt;padding-top:14.5pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c207{margin-left:3.1pt;padding-top:11.6pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c102{padding-top:11.1pt;padding-bottom:0pt;line-height:1.8968323469161987;text-align:left;margin-right:74.3pt}.c135{margin-left:0.9pt;padding-top:14.5pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c171{padding-top:2pt;padding-bottom:0pt;line-height:0.9534366130828857;text-align:left;margin-right:104.3pt}.c144{margin-left:18.9pt;padding-top:14.6pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c30{margin-left:11.2pt;padding-top:0.4pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c91{margin-left:0.2pt;padding-top:14.1pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c39{padding-top:1.6pt;padding-bottom:0pt;line-height:1.0930598974227905;text-align:justify;margin-right:2.2pt}.c101{padding-top:0pt;padding-bottom:0pt;line-height:1.8134338855743408;text-align:left;margin-right:44.1pt}.c23{padding-top:0pt;padding-bottom:0pt;line-height:0.9474102258682251;text-align:left;margin-right:38.2pt}.c53{margin-left:2.8pt;padding-top:13.9pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c22{margin-left:2.7pt;padding-top:11.1pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c179{padding-top:0pt;padding-bottom:0pt;line-height:0.9433979988098145;text-align:left;margin-right:20.2pt}.c205{padding-top:11.1pt;padding-bottom:0pt;line-height:0.943397581577301;text-align:left;margin-right:56.3pt}.c35{margin-left:2.3pt;padding-top:14pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c164{padding-top:0.6pt;padding-bottom:0pt;line-height:1.014086365699768;text-align:justify;margin-right:2pt}.c24{margin-left:2.5pt;padding-top:0.6pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c66{margin-left:2.3pt;padding-top:0.2pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c3{margin-left:0.2pt;padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c71{padding-top:0pt;padding-bottom:0pt;line-height:0.9509458541870117;text-align:left;margin-right:24.8pt}.c138{padding-top:0.4pt;padding-bottom:0pt;line-height:1.011068344116211;text-align:justify;margin-right:2.1pt}.c9{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left;height:11pt}.c88{padding-top:6pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c129{padding-top:6.4pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c82{padding-top:214.9pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c186{padding-top:46.4pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c79{color:#333333;text-decoration:none;vertical-align:baseline;font-style:normal}.c97{padding-top:0.6pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c133{color:#0000ff;text-decoration:none;vertical-align:baseline;font-style:normal}.c41{background-color:#e0e0e0;font-weight:400;font-size:11pt;font-family:"Calibri"}.c67{padding-top:14.4pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c86{padding-top:14.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c163{padding-top:11.1pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c185{padding-top:13.2pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c47{padding-top:12.6pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c60{color:#333333;text-decoration:none;vertical-align:baseline;font-style:italic}.c46{margin-left:54.2pt;border-spacing:0;border-collapse:collapse;margin-right:auto}.c106{margin-left:36.2pt;border-spacing:0;border-collapse:collapse;margin-right:auto}.c59{color:#000000;text-decoration:none;vertical-align:baseline;font-style:italic}.c199{padding-top:14.5pt;padding-bottom:0pt;line-height:1.0;text-align:center}.c51{margin-left:18.4pt;border-spacing:0;border-collapse:collapse;margin-right:auto}.c108{margin-left:11.2pt;border-spacing:0;border-collapse:collapse;margin-right:auto}.c169{padding-top:14.1pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c26{padding-top:22.9pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c143{padding-top:5.9pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c32{border-spacing:0;border-collapse:collapse;margin-right:auto}.c146{padding-top:13.9pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c152{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:center}.c124{padding-top:22.8pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c21{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c200{padding-top:41.6pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c29{color:#000000;text-decoration:none;vertical-align:baseline;font-style:normal}.c116{padding-top:13.7pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c69{font-size:10pt;font-family:"Cambria";color:#231f20;font-weight:400}.c160{padding-top:13.6pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c6{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c176{padding-top:27.4pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c89{padding-top:0.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c178{padding-top:0.1pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c157{padding-top:0.4pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c195{padding-top:6.1pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c65{font-weight:400;font-size:12pt;font-family:"Times New Roman"}.c57{font-weight:400;font-size:11pt;font-family:"Calibri"}.c72{font-weight:400;font-size:11pt;font-family:"Times New Roman"}.c119{font-weight:700;font-size:13.6pt;font-family:"Times New Roman"}.c34{font-size:12.6pt;font-family:"Times New Roman";font-weight:700}.c73{font-size:9pt;font-weight:400;font-family:"Courier New"}.c52{font-weight:400;font-size:13.6pt;font-family:"Times New Roman"}.c58{font-weight:400;font-size:12.6pt;font-family:"Times New Roman"}.c83{font-size:9.6pt;font-family:"Courier New";font-weight:700}.c15{font-size:11.6pt;font-weight:400;font-family:"Times New Roman"}.c76{font-weight:700;font-size:24pt;font-family:"Times New Roman"}.c33{font-weight:700;font-size:12pt;font-family:"Times New Roman"}.c45{font-weight:700;font-size:17pt;font-family:"Times New Roman"}.c110{border-spacing:0;border-collapse:collapse;margin-right:auto}.c167{font-weight:400;font-size:10pt;font-family:"Courier New"}.c62{font-weight:700;font-size:11pt;font-family:"Calibri"}.c141{color:inherit;text-decoration:inherit}.c92{margin-left:36pt;padding-left:0pt}.c126{font-weight:400;font-family:"Times New Roman"}.c77{margin-left:0.3pt;text-indent:-0pt}.c38{padding:0;margin:0}.c166{max-width:472.6pt;padding:52pt 67.4pt 76pt 72pt}.c74{text-indent:-0pt;margin-right:4.5pt}.c184{height:273.8pt}.c174{margin-left:9.2pt}.c145{margin-left:54.3pt}.c128{margin-left:54pt}.c180{margin-left:29.3pt}.c111{color:#333333}.c203{margin-left:27.5pt}.c107{margin-left:5.1pt}.c191{margin-left:29.6pt}.c170{margin-left:9.1pt}.c125{margin-left:4.5pt}.c127{margin-left:9.3pt}.c196{margin-left:0.6pt}.c94{margin-left:2.3pt}.c168{height:341.8pt}.c87{margin-left:0.5pt}.c202{height:364.4pt}.c140{height:409.7pt}.c61{background-color:#e0e0e0}.c201{height:443.6pt}.c188{height:171.7pt}.c209{height:466.3pt}.c177{margin-left:11.1pt}.c192{margin-left:9pt}.c181{margin-left:2.6pt}.c112{background-color:#fff2cc}.c172{height:203.2pt}.c147{height:28.6pt}.c215{margin-left:29pt}.c130{margin-left:4.3pt}.c55{margin-left:0.4pt}.c197{height:477.7pt}.c120{text-indent:0.1pt}.c210{height:122.6pt}.c93{margin-left:0.2pt}.c96{height:0pt}.c211{height:47.1pt}.c28{background-color:#ffffff}.c156{height:55.5pt}.c11{margin-left:9.4pt}.c117{height:545.7pt}.c114{height:20.2pt}.c56{margin-left:18.4pt}.c121{height:217pt}.c153{height:387pt}.c132{margin-left:2.5pt}.c142{margin-left:11.2pt}.c16{height:11pt}.c151{height:398.4pt}.c155{margin-left:0pt}.c137{height:375.7pt}.c173{margin-left:29.5pt}.c7{margin-left:3.2pt}.c198{margin-left:2.9pt}.c131{height:228.3pt}.c208{margin-left:19.6pt}.title{padding-top:24pt;color:#000000;font-weight:700;font-size:36pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:18pt;color:#666666;font-size:24pt;padding-bottom:4pt;font-family:"Georgia";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:24pt;color:#000000;font-weight:700;font-size:24pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-weight:700;font-size:18pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:14pt;color:#000000;font-weight:700;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:12pt;color:#000000;font-weight:700;font-size:12pt;padding-bottom:2pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:11pt;color:#000000;font-weight:700;font-size:11pt;padding-bottom:2pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:10pt;color:#000000;font-weight:700;font-size:10pt;padding-bottom:2pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}</style></head><body class="c28 c166 doc-content"><p class="c134"><span class="c29 c76 c28">OPERATING SYSTEMS &ndash; FINAL </span><span class="c29 c76">&nbsp;PROJECT </span></p><p class="c109"><span class="c29 c76 c28">Enkel Shehdula, Jord Thanasi</span></p><p class="c16 c109"><span class="c29 c28 c76"></span></p><p class="c199"><span class="c76 c183">Part I</span><span class="c29 c76">&nbsp;</span></p><p class="c55 c103"><span class="c29 c45 c28">Provide a well-documented report with the following parts , </span><span class="c29 c45">&nbsp;</span><span class="c29 c45 c28">both in MS Word and HTML with step by step analysis and </span><span class="c29 c45">&nbsp;</span><span class="c29 c28 c45">explanations in tutorial fashion.</span><span class="c29 c45">&nbsp;</span></p><p class="c169 c208"><span class="c29 c76 c28">1) Running and Analyzing Scripts</span><span class="c29 c76">&nbsp;</span></p><p class="c84"><span class="c29 c72 c28">Examine the following scripts. Run them, then shortly explain them. You should experiment with different </span><span class="c29 c72">&nbsp;</span><span class="c29 c72 c28">inputs, provide the relevant results through screenshots, after extensively commenting the given codes. </span><span class="c29 c72">&nbsp;</span><span class="c29 c72 c28">You should also, provide the intermediate, not only the final results of each script, by adding &ldquo;echo&rdquo; </span><span class="c29 c72">&nbsp;</span><span class="c29 c72 c28">commands whenever needed to show intermediate results and how each script is behaved in detail, so </span><span class="c29 c72">&nbsp;</span><span class="c29 c72 c28">that to support your analysis. Therefore, the analysis of each script will not be only additional comments, </span><span class="c29 c72">&nbsp;in the already existing ones, but, also, step by step intermediate results proving your comments. </span></p><p class="c84 c16"><span class="c29 c72"></span></p><p class="c84 c16"><span class="c29 c72"></span></p><p class="c84 c16"><span class="c29 c72"></span></p><p class="c16 c84"><span class="c29 c72"></span></p><p class="c84 c16"><span class="c29 c72"></span></p><p class="c84 c16"><span class="c29 c72"></span></p><p class="c84 c16"><span class="c29 c72"></span></p><p class="c84 c16"><span class="c29 c72"></span></p><p class="c91"><span class="c27">Example A-1. </span><span class="c59 c119 c28">mailformat</span><span class="c27">: Formatting an e-mail message</span></p><p class="c91"><span class="c72 c28">This Bash script, </span><span class="c72 c28">mail_format.sh</span><span class="c72 c28">, is designed to clean and format email message files by removing unnecessary characters and improving readability. It first checks if exactly one argument (a valid filename) is provided; otherwise, it exits with an error. If the file exists, it uses a predefined </span><span class="c72 c28">sed</span><span class="c72 c28">&nbsp;script to strip out leading </span><span class="c72 c28">&gt;</span><span class="c72 c28">&nbsp;characters (common in quoted emails), remove leading and trailing whitespace, and eliminate tabs. The cleaned content is then piped into the </span><span class="c72 c28">fold</span><span class="c72 c28">&nbsp;command, which wraps lines to a maximum width of 70 characters, ensuring that long lines are broken at word boundaries for better readability. This script serves as a lightweight, efficient alternative to bulky formatting tools by leveraging powerful Unix text utilities.</span></p><p class="c91 c16"><span class="c27"></span></p><table class="c32"><tr class="c121"><td class="c115" colspan="1" rowspan="1"><p class="c6 c7"><span class="c2">#!/bin/bash</span></p><p class="c6 c7"><span class="c2"># mail_format.sh (ver. 1.1): Format email messages.</span></p><p class="c6 c7"><span class="c2"># Gets rid of carets, tabs, and also folds excessively long lines.</span></p><p class="c6 c7"><span class="c2"># =================================================================</span></p><p class="c6 c7"><span class="c2"># Standard Check for Script Argument(s)</span></p><p class="c6 c7"><span class="c2">ARGS=1 &nbsp; &nbsp;#Declare that script expects only 1 argument (FileName)</span></p><p class="c6 c7"><span class="c2">E_BADARGS=85 &nbsp; #Error Code to exit when wrong # of args are entered</span></p><p class="c6 c7"><span class="c2">E_NOFILE=86 &nbsp; &nbsp;#Error Code to exit when filename wrong</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2">if [ $# -ne $ARGS ]; then # Correct number of arguments passed to script?</span></p><p class="c6 c7"><span class="c2">&nbsp; echo &quot;Usage: `basename $0` filename&quot; &nbsp; #Output to help user understand how to run script</span></p><p class="c6 c7"><span class="c2">&nbsp; exit $E_BADARGS</span></p><p class="c6 c7"><span class="c2">fi</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2">if [ -f &quot;$1&quot; ]; then # Check if file exists.</span></p><p class="c6 c7"><span class="c2">&nbsp; file_name=$1 &nbsp; &nbsp;#Saves Filename from argument to variable file_name</span></p><p class="c6 c7"><span class="c2">else</span></p><p class="c6 c7"><span class="c2">&nbsp; echo &quot;File \&quot;$1\&quot; does not exist.&quot;</span></p><p class="c6 c7"><span class="c2">&nbsp; exit $E_NOFILE</span></p><p class="c6 c7"><span class="c2">fi</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># -----------------------------------------------------------------</span></p><p class="c6 c7"><span class="c2">MAXWIDTH=70 # Width to fold excessively long lines to.</span></p><p class="c6 c7"><span class="c2"># =================================</span></p><p class="c6 c7"><span class="c2"># A variable can hold a sed script.</span></p><p class="c6 c7"><span class="c2"># It&#39;s a useful technique.</span></p><p class="c6 c7"><span class="c2">sedscript=&#39;s/^&gt;// &nbsp; #First Line removes all carates , tabs and extensive long spaces The code in the Project file produced outputs so we formated it</span></p><p class="c6 c7"><span class="c2">s/^ *&gt;//</span></p><p class="c6 c7"><span class="c2">s/^[[:space:]]*//</span></p><p class="c6 c7"><span class="c2">s/[[:space:]]*$//&#39;</span></p><p class="c6 c7"><span class="c2"># =================================</span></p><p class="c6 c7"><span class="c2"># Delete carets and tabs at beginning of lines,</span></p><p class="c6 c7"><span class="c2">#+ then fold lines to $MAXWIDTH characters.</span></p><p class="c6 c7"><span class="c2">sed &quot;$sedscript&quot; &quot;$file_name&quot; | fold -s --w=$MAXWIDTH</span></p><p class="c6 c7"><span class="c2">#The above command executes the sedscript with the file as parameter then pipes the</span></p><p class="c6 c7"><span class="c2">#output to the fold command to fold the text with the specficied max width</span></p><p class="c6 c7"><span class="c2"># -s option to &quot;fold&quot; breaks lines at whitespace, if possible.</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># This script was inspired by an article in a well-known trade journal</span></p><p class="c6 c7"><span class="c2">#+ extolling a 164K MS Windows utility with similar functionality.</span></p><p class="c6 c7"><span class="c2">#</span></p><p class="c6 c7"><span class="c2"># A nice set of text processing utilities and an efficient</span></p><p class="c6 c7"><span class="c2">#+ scripting language provide an alternative to the bloated executables</span></p><p class="c6 c7"><span class="c2">#+ of a clunky operating system.</span></p><p class="c6 c7"><span class="c83 c28">exit $? &nbsp;#exit</span></p><p class="c6 c16 c7"><span class="c1"></span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 237.33px;"><img alt="" src="images/image2.png" style="width: 630.14px; height: 237.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c3"><span class="c29 c119">Example A-2. </span><span class="c59 c119">rn</span><span class="c29 c119">: A simple-minded file renaming utility </span></p><p class="c160 c93"><span class="c17">This script is a modification of </span><span class="c187 c52 c28">Example 16-22</span><span class="c17">.</span></p><p class="c93 c160"><span class="c58 c28">This Bash script, rn</span><span class="c58 c28">.sh</span><span class="c58 c28">, is a simple file renaming utility that replaces a specified text pattern in filenames within the current directory. It expects two arguments: the pattern to find and the replacement string. If the correct number of arguments isn&#39;t provided, it displays usage instructions and exits. The script loops through all files whose names contain the old pattern, and for each match, it uses </span><span class="c58 c28">sed</span><span class="c58 c28">&nbsp;to replace the old pattern with the new one in the filename, then renames the file using </span><span class="c58 c28">mv</span><span class="c29 c58 c28">. It keeps a count of how many files were renamed and prints a grammatically correct message based on the count.</span></p><p class="c9"><span class="c0"></span></p><table class="c32"><tr class="c153"><td class="c115" colspan="1" rowspan="1"><p class="c49 c7"><span class="c2">#! /bin/bash</span></p><p class="c49 c7"><span class="c2"># rn.sh</span></p><p class="c49 c7"><span class="c2"># Very simpleminded filename &quot;rename&quot; utility (based on &quot;lowercase.sh&quot;).</span></p><p class="c49 c7"><span class="c2">#</span></p><p class="c49 c7"><span class="c2"># The &quot;ren&quot; utility, by Vladimir Lanin (lanin@csd2.nyu.edu),</span></p><p class="c49 c7"><span class="c2">#+ does a much better job of this.</span></p><p class="c49 c7"><span class="c2">ARGS=2 #Script expects 2 arguments (old format)(new format)</span></p><p class="c49 c7"><span class="c2">E_BADARGS=85 #Exit status for wrong arg count</span></p><p class="c49 c7"><span class="c2">ONE=1 # For getting singular/plural right (see below).</span></p><p class="c49 c7"><span class="c2">if [ $# -ne &quot;$ARGS&quot; ] #checks number of arguments entered</span></p><p class="c49 c7"><span class="c2">then</span></p><p class="c49 c7"><span class="c2">echo &quot;Usage: `basename $0` old-pattern new-pattern&quot; #Print usage in case of wrong arg counter</span></p><p class="c49 c16 c7"><span class="c2"></span></p><p class="c49 c7"><span class="c2"># As in &quot;rn gif jpg&quot;, which renames all gif files in working directory to jpg.</span></p><p class="c49 c7"><span class="c2">exit $E_BADARGS</span></p><p class="c49 c7"><span class="c2">fi</span></p><p class="c49 c7"><span class="c2">number=0 # Keeps track of how many files actually renamed.Later to be incremented</span></p><p class="c49 c7"><span class="c2">for filename in *$1* #Traverse all matching files in directory.</span></p><p class="c49 c7"><span class="c2">do</span></p><p class="c49 c7"><span class="c2">if [ -f &quot;$filename&quot; ] # If finds match...</span></p><p class="c49 c7"><span class="c2">then</span></p><p class="c49 c7"><span class="c2">fname=`basename $filename` # Strip off path.</span></p><p class="c49 c7"><span class="c2">n=`echo $fname | sed -e &quot;s/$1/$2/&quot;` # Substitute new for old in filename.</span></p><p class="c49 c7"><span class="c2">mv $fname $n # Rename.</span></p><p class="c49 c7"><span class="c2">let &quot;number += 1&quot; #Increment every for every file transformed</span></p><p class="c49 c7"><span class="c2">fi #End if</span></p><p class="c49 c7"><span class="c2">done #End loop</span></p><p class="c49 c7"><span class="c2">if [ &quot;$number&quot; -eq &quot;$ONE&quot; ] # For correct grammar.</span></p><p class="c49 c7"><span class="c2">then</span></p><p class="c49 c7"><span class="c2">echo &quot;$number file renamed.&quot; #echo-ed if only 1 file renamed</span></p><p class="c49 c7"><span class="c2">else</span></p><p class="c49 c7"><span class="c2">echo &quot;$number files renamed.&quot; #echo-ed if &nbsp;+1 files renamed</span></p><p class="c49 c7"><span class="c2">fi #End if</span></p><p class="c49 c7"><span class="c2">exit $? #Exit</span></p><p class="c49 c7"><span class="c2"># Exercises:</span></p><p class="c49 c7"><span class="c2"># ---------</span></p><p class="c7 c49"><span class="c2"># What types of files will this not work on?</span></p><p class="c49 c7"><span class="c83 c28"># How can this be fixed?</span></p></td></tr></table><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 221.33px;"><img alt="" src="images/image28.png" style="width: 630.14px; height: 221.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c29 c58 c28"></span></p><p class="c21"><span class="c58 c28">This script won&#39;t handle filenames with spaces or special characters correctly and may overwrite files without warning. It could be improved by quoting variables (e.g., </span><span class="c58 c28">&quot;$fname&quot;</span><span class="c58 c28">), adding checks for file name collisions, and using more robust pattern matching</span><span class="c0">.</span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c93 c162"><span class="c29 c119">Example A-3. </span><span class="c59 c119">blank-rename</span><span class="c29 c119">: Renames filenames containing blanks </span><span class="c17">This is an even simpler-minded version </span><span class="c52 c28">of the previous</span><span class="c17">&nbsp;script.</span></p><p class="c3 c74"><span class="c15 c28">This Bash script, </span><span class="c15 c28">rename_blank.sh</span><span class="c15 c28">, scans all files in the current directory and rename any file that contains spaces in its name by replacing those spaces with underscores (</span><span class="c15 c28">_</span><span class="c15 c28">). It initializes counters and flags to track how many files are renamed. For each file, it checks if the filename contains a space using </span><span class="c15 c28">grep -q &quot; &quot;</span><span class="c15 c28">. If it does, it uses </span><span class="c15 c28">sed</span><span class="c15 c28">&nbsp;to substitute all spaces with underscores and then renames the file using </span><span class="c15 c28">mv</span><span class="c29 c15 c28">. It keeps a count of the renamed files and, at the end, prints a grammatically correct message depending on whether one or multiple files were renamed. This script helps clean up filenames that can cause issues in shell scripts or command-line tools due to unescaped spaces.</span></p><p class="c3 c16 c74"><span class="c29 c58 c28"></span></p><table class="c32"><tr class="c188"><td class="c115" colspan="1" rowspan="1"><p class="c6 c7"><span class="c2">#! /bin/bash</span></p><p class="c6 c7"><span class="c2"># blank-rename.sh</span></p><p class="c6 c7"><span class="c2">#</span></p><p class="c6 c7"><span class="c2"># Substitutes underscores for blanks in all the filenames in a directory.</span></p><p class="c6 c7"><span class="c2">ONE=1 # For getting singular/plural right (see below).For changing echo statements in the final if condition based on # of files renamed</span></p><p class="c6 c7"><span class="c2">number=0 # Keeps track of how many files actually renamed.Counter</span></p><p class="c6 c7"><span class="c2">FOUND=0 # Successful return value.Used as a flag that is true when a file with space in name is found</span></p><p class="c6 c7"><span class="c2">for filename in * #Traverse all files in directory.</span></p><p class="c6 c7"><span class="c2">do</span></p><p class="c6 c7"><span class="c2">echo &quot;$filename&quot; | grep -q &quot; &quot; # Pipes the name of the current file to the grep to check &nbsp;if the file name has spaces</span></p><p class="c6 c7"><span class="c2">if [ $? -eq $FOUND ] # Flag = true if file has space in name</span></p><p class="c6 c7"><span class="c2">then</span></p><p class="c6 c7"><span class="c2">fname=$filename # Assign current file name in a temporary variable fname</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2">n=`echo $fname | sed -e &quot;s/ /_/g&quot;` # Pipe name of the current file in the sedscript to subsitute space with underscore</span></p><p class="c6 c7"><span class="c2"># and save the new name on another temporary variable n.</span></p><p class="c6 c7"><span class="c2">mv &quot;$fname&quot; &quot;$n&quot; # Change the name of the current file with the new name</span></p><p class="c6 c7"><span class="c2">let &quot;number += 1&quot; #Increment the counter of the renamed files</span></p><p class="c6 c7"><span class="c2">fi #If Statement end</span></p><p class="c6 c7"><span class="c2">done #Loop ending</span></p><p class="c6 c7"><span class="c2">if [ &quot;$number&quot; -eq &quot;$ONE&quot; ] #If statement to change the echo statements based on # of files renamed.</span></p><p class="c6 c7"><span class="c2">then</span></p><p class="c6 c7"><span class="c2">echo &quot;$number file renamed.&quot; #Only 1 file renamed</span></p><p class="c6 c7"><span class="c2">else</span></p><p class="c6 c7"><span class="c2">echo &quot;$number files renamed.&quot; #+1 files renamed</span></p><p class="c6 c7"><span class="c2">fi # End if</span></p><p class="c6 c7"><span class="c83 c28">exit 0 #End script</span></p></td></tr></table><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 182.67px;"><img alt="" src="images/image51.png" style="width: 630.14px; height: 182.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c71"><span class="c27">Example A-4. </span><span class="c59 c119 c28">encryptedpw</span><span class="c27">: Uploading to an ftp site, using a locally encrypted </span><span class="c29 c119">&nbsp;</span><span class="c27">password</span></p><p class="c16 c71"><span class="c27"></span></p><p class="c71"><span class="c15 c28">This Bash script (ex72.</span><span class="c15 c28">.sh</span><span class="c15 c28">) is designed to securely upload a file to a remote server using FTP with an encrypted password. It begins by checking if a filename argument is provided; if not, it exits with an error code. The script then sets up key variables: </span><span class="c15 c28">Username</span><span class="c15 c28">&nbsp;for the login name, </span><span class="c15 c28">pword</span><span class="c15 c28">&nbsp;pointing to a file containing an encrypted password, and </span><span class="c15 c28">Filename</span><span class="c15 c28">, which extracts the base name of the file to upload. The encrypted password is decrypted using a utility called </span><span class="c15 c28">cruft</span><span class="c15 c28">, which implements a one-time pad encryption method. The FTP session is then started using the </span><span class="c15 c28">ftp</span><span class="c15 c28">&nbsp;command with the </span><span class="c15 c28">-n</span><span class="c15 c28">&nbsp;option to disable auto-login. Within the FTP session block, the script logs in using the username and decrypted password, switches to binary mode, navigates to the target directory on the remote server, uploads the specified file, and ends the session. Although encryption is used for storing the password, the script notes that transmitting it in plain text (as FTP does) is still insecure, and recommends using </span><span class="c15 c28">ssh</span><span class="c29 c15 c28">&nbsp;for sensitive operations.</span></p><p class="c71 c16"><span class="c29 c15 c28"></span></p><table class="c32"><tr class="c140"><td class="c115" colspan="1" rowspan="1"><p class="c6 c7"><span class="c2">#!/bin/bash</span></p><p class="c6 c7"><span class="c2"># Example &quot;ex72.sh&quot; modified to use encrypted password.</span></p><p class="c6 c7"><span class="c2"># Note that this is still rather insecure,</span></p><p class="c6 c7"><span class="c2">#+ since the decrypted password is sent in the clear.</span></p><p class="c6 c7"><span class="c2"># Use something like &quot;ssh&quot; if this is a concern.</span></p><p class="c6 c7"><span class="c2">E_BADARGS=85</span></p><p class="c6 c7"><span class="c2">if [ -z &quot;$1&quot; ]</span></p><p class="c6 c7"><span class="c2">then</span></p><p class="c6 c7"><span class="c2">echo &quot;Usage: `basename $0` filename&quot;</span></p><p class="c6 c7"><span class="c2">exit $E_BADARGS</span></p><p class="c6 c7"><span class="c2">fi</span></p><p class="c6 c7"><span class="c2">Username=example # Change to suit.</span></p><p class="c6 c7"><span class="c2">pword=/home/bozo/secret/password_encrypted.file</span></p><p class="c6 c7"><span class="c2"># File containing encrypted password.</span></p><p class="c6 c7"><span class="c2">Filename=`basename $1` # Strips pathname out of file name.</span></p><p class="c6 c7"><span class="c2">Server=&quot;XXX&quot;</span></p><p class="c6 c7"><span class="c2">Directory=&quot;YYY&quot; # Change above to actual server name &amp; directory.</span></p><p class="c6 c7"><span class="c2">Password=`cruft &lt;$pword` # Decrypt password.</span></p><p class="c6 c7"><span class="c2"># Uses the author&#39;s own &quot;cruft&quot; file encryption package,</span></p><p class="c6 c7"><span class="c2">#+ based on the classic &quot;onetime pad&quot; algorithm,</span></p><p class="c6 c7"><span class="c2">#+ and obtainable from:</span></p><p class="c6 c7"><span class="c2">#+ Primary-site: ftp://ibiblio.org/pub/Linux/utils/file</span></p><p class="c6 c7"><span class="c2">#+ cruft-0.2.tar.gz [16k]</span></p><p class="c6 c7"><span class="c2">ftp -n $Server &lt;&lt;End-Of-Session</span></p><p class="c6 c7"><span class="c2">user $Username $Password</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2">binary</span></p><p class="c6 c7"><span class="c2">bell</span></p><p class="c6 c7"><span class="c2">cd $Directory</span></p><p class="c6 c7"><span class="c2">put $Filename</span></p><p class="c6 c7"><span class="c2">bye</span></p><p class="c6 c7"><span class="c2">End-Of-Session</span></p><p class="c6 c7"><span class="c2"># -n option to &quot;ftp&quot; disables auto-logon.</span></p><p class="c6 c7"><span class="c2"># Note that &quot;bell&quot; rings &#39;bell&#39; after each file transfer.</span></p><p class="c6 c7"><span class="c83 c28">exit 0</span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 262.67px;"><img alt="" src="images/image61.png" style="width: 630.14px; height: 262.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6"><span class="c27">Example A-5. </span><span class="c59 c119 c28">copy-cd</span><span class="c27">: Copying a data CD</span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6"><span class="c15 c28">&#8203;&#8203;This Bash script, </span><span class="c15 c28">copy-cd.sh</span><span class="c15 c28">, automates the process of copying a data CD to an ISO image and then burning that image onto a blank CD-R. It first defines the CD-ROM device (</span><span class="c15 c28">/dev/cdrom</span><span class="c15 c28">), the output ISO file path, a block size for copying (</span><span class="c15 c28">2048</span><span class="c15 c28">&nbsp;bytes, standard for CDs), and the CD writing device identifier (used by </span><span class="c15 c28">wodim</span><span class="c15 c28">). It prompts the user to insert the source CD (without mounting it), then uses </span><span class="c15 c28">dd</span><span class="c15 c28">&nbsp;to make a raw copy of the CD to an ISO file. After copying, it asks the user to remove the original CD and insert a blank CD-R, then uses </span><span class="c15 c28">wodim</span><span class="c15 c28">&nbsp;(or </span><span class="c15 c28">cdrecord</span><span class="c15 c28">&nbsp;on some systems) to burn the ISO to the new disc. Finally, it offers the user the option to delete the large ISO file and performs the action based on their input. This script is useful for backing up or duplicating data CDs using command-line tools.</span></p><table class="c32"><tr class="c197"><td class="c115" colspan="1" rowspan="1"><p class="c6 c7"><span class="c2">#!/bin/bash</span></p><p class="c6 c7"><span class="c2"># copy-cd.sh: copying a data CD</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># Define the CD-ROM device and output file paths</span></p><p class="c6 c7"><span class="c2">CDROM=/dev/cdrom # CD ROM device</span></p><p class="c6 c7"><span class="c2">OF=/home/bozo/projects/cdimage.iso # output file</span></p><p class="c6 c7"><span class="c2"># Change the output file path to suit your system.</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># Set the block size for copying</span></p><p class="c6 c7"><span class="c2">BLOCKSIZE=2048</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># DEVICE variable for the cdrecord/wodim command</span></p><p class="c6 c7"><span class="c2">DEVICE=&quot;1,0,0&quot;</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># Prompt user to insert the source CD and press ENTER</span></p><p class="c6 c7"><span class="c2">echo; echo &quot;Insert source CD, but do *not* mount it.&quot;</span></p><p class="c6 c7"><span class="c2">echo &quot;Press ENTER when ready.&quot;</span></p><p class="c6 c7"><span class="c2">read ready # Wait for input, $ready not used.</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># Notify user that the CD is being copied to the output file</span></p><p class="c6 c7"><span class="c2">echo; echo &quot;Copying the source CD to $OF.&quot;</span></p><p class="c6 c7"><span class="c2">echo &quot;This may take a while. Please be patient.&quot;</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># Use dd to copy the CD-ROM to the output file with the specified block size</span></p><p class="c6 c7"><span class="c2">dd if=$CDROM of=$OF bs=$BLOCKSIZE # Raw device copy.</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># Prompt user to remove the source CD and insert a blank CD-R</span></p><p class="c6 c7"><span class="c2">echo; echo &quot;Remove data CD.&quot;</span></p><p class="c6 c7"><span class="c2">echo &quot;Insert blank CDR.&quot;</span></p><p class="c6 c7"><span class="c2">echo &quot;Press ENTER when ready.&quot;</span></p><p class="c6 c7"><span class="c2">read ready # Wait for input, $ready not used.</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># Notify user that the output file is being copied to the blank CD-R</span></p><p class="c6 c7"><span class="c2">echo &quot;Copying $OF to CDR.&quot;</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># Use wodim to burn the ISO file to the blank CD-R</span></p><p class="c6 c7"><span class="c2">wodim -v -isosize dev=$DEVICE $OF</span></p><p class="c6 c7"><span class="c2"># Uses Joerg Schilling&#39;s &quot;cdrecord&quot; package (see its docs).</span></p><p class="c6 c7"><span class="c2"># http://www.fokus.gmd.de/nthp/employees/schilling/cdrecord.html</span></p><p class="c6 c7"><span class="c2"># Newer Linux distros may use &quot;wodim&quot; rather than &quot;cdrecord&quot; ...</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># Notify user that the copying process is complete</span></p><p class="c6 c7"><span class="c2">echo; echo &quot;Done copying $OF to CDR on device $CDROM.&quot;</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># Ask user if they want to erase the ISO file</span></p><p class="c6 c7"><span class="c2">echo &quot;Do you want to erase the image file (y/n)? &quot; # Probably a huge file.</span></p><p class="c6 c7"><span class="c2">read answer</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># Case statement to handle user input for erasing the ISO file</span></p><p class="c6 c7"><span class="c2">case &quot;$answer&quot; in</span></p><p class="c6 c7"><span class="c83 c28">&nbsp; [yY]|[yY][eE][sS]) # Accepts &#39;y&#39;, &#39;Y&#39;, &#39;yes&#39;, and &#39;Yes&#39; as input</span></p><p class="c6 c7"><span class="c2">&nbsp; &nbsp; rm -f $OF</span></p><p class="c6 c7"><span class="c2">&nbsp; &nbsp; echo &quot;$OF erased.&quot;</span></p><p class="c6 c7"><span class="c2">&nbsp; &nbsp; ;;</span></p><p class="c6 c7"><span class="c2">&nbsp; *)</span></p><p class="c6 c7"><span class="c2">&nbsp; &nbsp; echo &quot;$OF not erased.&quot;</span></p><p class="c6 c7"><span class="c2">&nbsp; &nbsp; ;;</span></p><p class="c6 c7"><span class="c2">esac</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2"># End of script</span></p><p class="c6 c7"><span class="c2">echo</span></p><p class="c6 c7"><span class="c83 c28">exit 0</span></p><p class="c6 c16 c107"><span class="c1"></span></p><p class="c6 c107 c16"><span class="c1"></span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 418.67px;"><img alt="" src="images/image50.png" style="width: 630.14px; height: 418.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c3"><span class="c27">Example A-6. Collatz series</span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3"><span class="c15 c28">This Bash script, </span><span class="c15 c28">collatz.sh</span><span class="c15 c28">, implements the Collatz sequence (also known as the hailstone sequence), a famous mathematical conjecture that transforms any positive integer into a sequence that always ends in the loop </span><span class="c15 c28">4 &rarr; 2 &rarr; 1</span><span class="c15 c28">. The script accepts a seed number as a command-line argument; if none is provided, it uses the process ID (</span><span class="c15 c28">$$</span><span class="c15 c28">) as a fallback. It then performs up to </span><span class="c15 c28">MAX_ITERATIONS</span><span class="c15 c28">&nbsp;(200 by default) steps, printing the current number at each iteration. If the current number is even, it divides it by 2; if odd, it multiplies it by 3 and adds 1. Each number is neatly printed using </span><span class="c15 c28">printf</span><span class="c15 c28">&nbsp;in a column format, with 10 numbers per line. The result is a visually organized sequence showing how the number fluctuates before (presumably) reaching the repeating </span><span class="c15 c28">4, 2, 1</span><span class="c15 c28">&nbsp;cycle. This script showcases iterative feedback (the output becoming the next input) and is a classic example of chaotic yet eventually stable behavior in simple math.</span></p><table class="c32"><tr class="c209"><td class="c115" colspan="1" rowspan="1"><p class="c6 c7"><span class="c2">#!/bin/bash</span></p><p class="c6 c7"><span class="c2"># collatz.sh</span></p><p class="c6 c7"><span class="c2"># The notorious &quot;hailstone&quot; or Collatz series. </span></p><p class="c6 c7"><span class="c2"># -------------------------------------------</span></p><p class="c6 c7"><span class="c2"># 1) Get the integer &quot;seed&quot; from the command-line.</span></p><p class="c6 c7"><span class="c2"># 2) NUMBER &lt;-- seed</span></p><p class="c6 c7"><span class="c2"># 3) Print NUMBER.</span></p><p class="c6 c7"><span class="c2"># 4) If NUMBER is even, divide by 2, or</span></p><p class="c6 c7"><span class="c2"># 5)+ if odd, multiply by 3 and add 1.</span></p><p class="c6 c7"><span class="c2"># 6) NUMBER &lt;-- result</span></p><p class="c6 c7"><span class="c2"># 7) Loop back to step 3 (for specified number of iterations).</span></p><p class="c6 c7"><span class="c2">#</span></p><p class="c6 c7"><span class="c2"># The theory is that every such sequence,</span></p><p class="c6 c7"><span class="c2">#+ no matter how large the initial value,</span></p><p class="c6 c7"><span class="c2">#+ eventually settles down to repeating &quot;4,2,1...&quot; cycles,</span></p><p class="c6 c7"><span class="c2">#+ even after fluctuating through a wide range of values.</span></p><p class="c6 c7"><span class="c2">#</span></p><p class="c6 c7"><span class="c2"># This is an instance of an &quot;iterate,&quot;</span></p><p class="c6 c7"><span class="c2">#+ an operation that feeds its output back into its input.</span></p><p class="c6 c7"><span class="c2"># Sometimes the result is a &quot;chaotic&quot; series.</span></p><p class="c6 c7"><span class="c2">MAX_ITERATIONS=200 #max number of iterations the algorithm can do</span></p><p class="c6 c7"><span class="c2"># For large seed numbers (&gt;32000), try increasing MAX_ITERATIONS.</span></p><p class="c6 c7"><span class="c2">h=${1:-$$} # Seed.#Use &nbsp;PID if user doesnt gice an argument to the scipt</span></p><p class="c6 c7"><span class="c2"># Use $PID as seed,</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2">#+ if not specified as command-line arg.</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2">echo #Break Line</span></p><p class="c6 c7"><span class="c2">echo &quot;C($h) -*- $MAX_ITERATIONS Iterations&quot; #Header</span></p><p class="c6 c7"><span class="c2">echo #Break Line</span></p><p class="c6 c7"><span class="c2">for ((i=1; i&lt;=MAX_ITERATIONS; i++)) #Loop for maximum number of interations (200)</span></p><p class="c6 c7"><span class="c2">do</span></p><p class="c6 c7"><span class="c2"># echo -n &quot;$h &quot;</span></p><p class="c6 c7"><span class="c2"># ^^^</span></p><p class="c6 c7"><span class="c2"># tab</span></p><p class="c6 c7"><span class="c2"># printf does it better ...</span></p><p class="c6 c16 c7"><span class="c2"></span></p><p class="c6 c7"><span class="c2">COLWIDTH=%7d #specify column width to wrap function</span></p><p class="c6 c7"><span class="c2">printf $COLWIDTH $h</span></p><p class="c6 c7"><span class="c2">let &quot;remainder = h % 2&quot; #Even/Odd checker</span></p><p class="c6 c7"><span class="c2">if [ &quot;$remainder&quot; -eq 0 ] # Even numbers</span></p><p class="c6 c7"><span class="c2">then</span></p><p class="c6 c7"><span class="c2">let &quot;h /= 2&quot; # Divide by 2.</span></p><p class="c6 c7"><span class="c2">else #Odd numbers</span></p><p class="c6 c7"><span class="c2">let &quot;h = h*3 + 1&quot; # Multiply by 3 and add 1.</span></p><p class="c6 c7"><span class="c2">fi #End if</span></p><p class="c6 c7"><span class="c2">COLUMNS=10 # Output 10 values per line.</span></p><p class="c6 c7"><span class="c2">let &quot;line_break = i % $COLUMNS&quot;</span></p><p class="c6 c7"><span class="c2">if [ &quot;$line_break&quot; -eq 0 ] #check for line break</span></p><p class="c6 c7"><span class="c2">then</span></p><p class="c6 c7"><span class="c83 c28">echo #if &nbsp;== true break line</span></p><p class="c6 c7"><span class="c2">fi #End if</span></p><p class="c6 c7"><span class="c2">done #End loop</span></p><p class="c6 c7"><span class="c2">echo #Line Break</span></p><p class="c6 c7"><span class="c83 c28"># For info on this math function,</span></p><p class="c6 c7"><span class="c2">#+ see _Computers, Pattern, Chaos, and Beauty_, by Pickover, p. 185 ff.,</span></p><p class="c6 c7"><span class="c2">#+ as listed in the bibliography.</span></p><p class="c6 c7"><span class="c83 c28">exit 0</span></p><p class="c6 c7 c16"><span class="c1"></span></p><p class="c6 c16 c7"><span class="c1"></span></p><p class="c6 c16 c7"><span class="c1"></span></p><p class="c6 c16 c7"><span class="c1"></span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 387.85px; height: 610.23px;"><img alt="" src="images/image31.png" style="width: 387.85px; height: 610.23px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c3"><span class="c27">Example A-7. </span><span class="c59 c119 c28">days-between</span><span class="c27">: Days between two dates</span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3"><span class="c15 c28">This Bash script days-between</span><span class="c15 c28">.sh</span><span class="c15 c28">&nbsp;calculates the number of days between two dates provided as command-line arguments in </span><span class="c15 c28">MM/DD/YYYY</span><span class="c15 c28">&nbsp;format. It starts by validating that exactly two dates are passed and ensures the dates are after January 3, 1600. It then parses the month, day, and year from each date and uses a simplified version of Gauss&#39;s formula to convert each date into a numerical &quot;day index&quot; &mdash; a rough count of days since the reference year 1600, accounting for leap years and month shifts. The script computes the difference between these two indices and outputs the absolute number of days between them. It includes safeguards for invalid input, such as incorrect day/month values or improper date formatting. Although effective, the script relies on </span><span class="c15 c28">let</span><span class="c15 c28 c29">, command substitution, and return values for numeric extraction, which could be fragile or imprecise for certain edge cases (e.g., months with fewer than 31 days).</span></p><table class="c32"><tr class="c184"><td class="c115" colspan="1" rowspan="1"><p class="c10"><span class="c2">#!/bin/bash</span></p><p class="c10"><span class="c2"># days-between.sh: Number of days between two dates.</span></p><p class="c10"><span class="c2"># Usage: ./days-between.sh [M]M/[D]D/YYYY [M]M/[D]D/YYYY</span></p><p class="c10"><span class="c2">ARGS=2 # Two command-line parameters expected.</span></p><p class="c10"><span class="c2">E_PARAM_ERR=85 # Error code for parameter error.</span></p><p class="c10"><span class="c2">REFYR=1600 # Reference year for calculations.</span></p><p class="c10"><span class="c2">CENTURY=100 # Number of years in a century.</span></p><p class="c10"><span class="c2">DIY=365 # Number of days in a year.</span></p><p class="c10"><span class="c2">ADJ_DIY=367 # Adjusted days in a year for leap years and fractions.</span></p><p class="c10"><span class="c2">MIY=12 # Number of months in a year.</span></p><p class="c10"><span class="c2">DIM=31 # Maximum number of days in a month.</span></p><p class="c10"><span class="c2">LEAPCYCLE=4 # Leap year cycle.</span></p><p class="c10"><span class="c2">MAXRETVAL=255 # Largest permissible positive return value from a function.</span></p><p class="c10"><span class="c2"># Declare global variables for date difference and absolute value.</span></p><p class="c10"><span class="c2">diff=</span></p><p class="c10"><span class="c2">value=</span></p><p class="c10"><span class="c2"># Declare global variables for day, month, year.</span></p><p class="c10"><span class="c2">day=</span></p><p class="c10"><span class="c2">month=</span></p><p class="c10"><span class="c2">year=</span></p><p class="c10"><span class="c2"># Function to handle parameter errors.</span></p><p class="c10"><span class="c2">Param_Error () {</span></p><p class="c10"><span class="c2">&nbsp; echo &quot;Usage: $(basename $0) [M]M/[D]D/YYYY [M]M/[D]D/YYYY&quot;</span></p><p class="c10"><span class="c2">&nbsp; echo &quot; (date must be after 1/3/1600)&quot;</span></p><p class="c10"><span class="c2">&nbsp; exit $E_PARAM_ERR</span></p><p class="c10"><span class="c2">}</span></p><p class="c10"><span class="c2"># Function to parse date from command-line parameters.</span></p><p class="c10"><span class="c2">Parse_Date () {</span></p><p class="c10"><span class="c2">&nbsp; month=${1%%/**} # Extract month.</span></p><p class="c10"><span class="c2">&nbsp; dm=${1%/**} # Extract day and month.</span></p><p class="c10"><span class="c2">&nbsp; day=${dm#*/} # Extract day.</span></p><p class="c10"><span class="c2">&nbsp; year=${1##*/} # Extract year.</span></p><p class="c10"><span class="c2">}</span></p><p class="c10"><span class="c2"># Function to check for invalid dates.</span></p><p class="c10"><span class="c2">check_date () {</span></p><p class="c10"><span class="c2">&nbsp; if [ &quot;$day&quot; -gt &quot;$DIM&quot; ] || [ &quot;$month&quot; -gt &quot;$MIY&quot; ] || [ &quot;$year&quot; -lt &quot;$REFYR&quot; ]; then</span></p><p class="c10"><span class="c2">&nbsp; &nbsp; Param_Error # Exit script on invalid date.</span></p><p class="c10"><span class="c2">&nbsp; fi</span></p><p class="c10"><span class="c2">}</span></p><p class="c181 c205"><span class="c2"># Function to strip leading zeros from day and month.</span></p><p class="c10"><span class="c2">strip_leading_zero () {</span></p><p class="c10"><span class="c2">&nbsp; return ${1#0} # Remove leading zero.</span></p><p class="c10"><span class="c2">}</span></p><p class="c10"><span class="c2"># Function to calculate the day index using Gauss&#39; formula.</span></p><p class="c10"><span class="c2">day_index () {</span></p><p class="c10"><span class="c2">&nbsp; day=$1</span></p><p class="c10"><span class="c2">&nbsp; month=$2</span></p><p class="c10"><span class="c2">&nbsp; year=$3</span></p><p class="c10"><span class="c2">&nbsp; let &quot;month = $month - 2&quot; # Adjust month.</span></p><p class="c10"><span class="c2">&nbsp; if [ &quot;$month&quot; -le 0 ]; then</span></p><p class="c10"><span class="c2">&nbsp; &nbsp; let &quot;month += 12&quot; # Adjust month for negative values.</span></p><p class="c10"><span class="c2">&nbsp; &nbsp; let &quot;year -= 1&quot; # Adjust year.</span></p><p class="c10"><span class="c2">&nbsp; fi</span></p><p class="c10"><span class="c2">&nbsp; let &quot;year -= $REFYR&quot; # Adjust year by reference year.</span></p><p class="c10"><span class="c2">&nbsp; let &quot;indexyr = $year / $CENTURY&quot; # Calculate index year.</span></p><p class="c10"><span class="c2">&nbsp; let &quot;Days = $DIY*$year + $year/$LEAPCYCLE - $indexyr + $indexyr/$LEAPCYCLE + $ADJ_DIY*$month/$MIY + $day - $DIM&quot;</span></p><p class="c10"><span class="c2">&nbsp; # Calculate total days using Gauss&#39; formula.</span></p><p class="c10"><span class="c2">&nbsp; echo $Days</span></p><p class="c10"><span class="c2">}</span></p><p class="c10"><span class="c2"># Function to calculate the difference between two day indices.</span></p><p class="c10"><span class="c2">calculate_difference () {</span></p><p class="c10"><span class="c2">&nbsp; let &quot;diff = $1 - $2&quot; # Calculate difference.</span></p><p class="c10"><span class="c2">}</span></p><p class="c10"><span class="c2"># Function to calculate the absolute value.</span></p><p class="c10"><span class="c2">abs () {</span></p><p class="c10"><span class="c2">&nbsp; if [ &quot;$1&quot; -lt 0 ]; then</span></p><p class="c10"><span class="c2">&nbsp; &nbsp; let &quot;value = 0 - $1&quot; # Change sign if negative.</span></p><p class="c10"><span class="c2">&nbsp; else</span></p><p class="c10"><span class="c2">&nbsp; &nbsp; let &quot;value = $1&quot; # Leave it alone if positive.</span></p><p class="c10"><span class="c2">&nbsp; fi</span></p><p class="c10"><span class="c28 c83">}</span></p><p class="c10"><span class="c2"># Check if the number of command-line parameters is correct.</span></p><p class="c10"><span class="c2">if [ $# -ne &quot;$ARGS&quot; ]; then</span></p><p class="c10"><span class="c2">&nbsp; Param_Error # Call function to handle error.</span></p><p class="c10"><span class="c2">fi</span></p><p class="c10 c16"><span class="c2"></span></p><p class="c10"><span class="c2"># Parse the first date.</span></p><p class="c10"><span class="c2">Parse_Date $1</span></p><p class="c10"><span class="c2">check_date $day $month $year # Validate the date.</span></p><p class="c10"><span class="c2">strip_leading_zero $day # Remove leading zeros from day.</span></p><p class="c10"><span class="c2">day=$? # Update day variable.</span></p><p class="c10"><span class="c2">strip_leading_zero $month # Remove leading zeros from month.</span></p><p class="c10"><span class="c2">month=$? # Update month variable.</span></p><p class="c10"><span class="c2">let &quot;date1 = $(day_index $day $month $year)&quot; # Calculate day index for the first date.</span></p><p class="c10 c16"><span class="c2"></span></p><p class="c10"><span class="c2"># Parse the second date.</span></p><p class="c10"><span class="c2">Parse_Date $2</span></p><p class="c10"><span class="c2">check_date $day $month $year # Validate the date.</span></p><p class="c10"><span class="c2">strip_leading_zero $day # Remove leading zeros from day.</span></p><p class="c10"><span class="c2">day=$? # Update day variable.</span></p><p class="c10"><span class="c2">strip_leading_zero $month # Remove leading zeros from month.</span></p><p class="c10"><span class="c2">month=$? # Update month variable.</span></p><p class="c10"><span class="c2">date2=$(day_index $day $month $year) # Calculate day index for the second date.</span></p><p class="c10 c16"><span class="c2"></span></p><p class="c10"><span class="c2"># Calculate the difference between the two dates.</span></p><p class="c10"><span class="c2">calculate_difference $date1 $date2</span></p><p class="c10"><span class="c2">abs $diff # Get the absolute value of the difference.</span></p><p class="c10"><span class="c2">diff=$value # Update diff variable with the absolute value.</span></p><p class="c10 c16"><span class="c2"></span></p><p class="c10"><span class="c2"># Output the difference in days.</span></p><p class="c10"><span class="c2">echo $diff</span></p><p class="c10"><span class="c2">exit 0 # Exit script successfully.</span></p><p class="c10 c16"><span class="c1"></span></p><p class="c10 c16"><span class="c1"></span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c1"></span></p><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 269.33px;"><img alt="" src="images/image8.png" style="width: 630.14px; height: 269.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c0"></span></p><p class="c3"><span class="c27">Example A-8. Making a </span><span class="c59 c119 c28">dictionary</span></p><p class="c6 c16"><span class="c59 c119 c28"></span></p><p class="c3"><span class="c15 c28">This Bash script, </span><span class="c15 c28">makedict.sh</span><span class="c15 c28">, is a utility for generating a clean, sorted dictionary of unique words from one or more text files. It begins by checking if the first provided file is readable; if not, it exits with an error. The core of the script processes the file(s) using a pipeline of text transformation commands: </span><span class="c15 c28">cat</span><span class="c15 c28">&nbsp;reads all the contents, </span><span class="c15 c28">tr A-Z a-z</span><span class="c15 c28">&nbsp;converts all uppercase letters to lowercase, and another </span><span class="c15 c28">tr</span><span class="c15 c28">&nbsp;replaces spaces and non-alphabetic characters with newlines to isolate individual words. It then sorts the words alphabetically using </span><span class="c15 c28">sort</span><span class="c15 c28">, removes duplicates with </span><span class="c15 c28">uniq</span><span class="c15 c28">, and filters out comment lines (those starting with </span><span class="c15 c28">#</span><span class="c15 c28">) and blank lines using </span><span class="c15 c28">grep -v</span><span class="c29 c15 c28">. The result is a clean list of lowercase words&mdash;one per line&mdash;suitable for use in dictionary files, password cracking tools, or lexicographic analysis. The script exits with the return code of the last command, maintaining good scripting practices.</span></p><table class="c32"><tr class="c137"><td class="c115" colspan="1" rowspan="1"><p class="c81"><span class="c2">#!/bin/bash</span></p><p class="c81"><span class="c2"># makedict.sh [make dictionary]</span></p><p class="c81"><span class="c2"># Modification of /usr/sbin/mkdict (/usr/sbin/cracklib-forman) script.</span></p><p class="c81"><span class="c2"># Original script copyright 1993, by Alec Muffett.</span></p><p class="c81"><span class="c2">#</span></p><p class="c81"><span class="c2"># This modified script included in this document in a manner</span></p><p class="c81"><span class="c2">#+ consistent with the &quot;LICENSE&quot; document of the &quot;Crack&quot; package</span></p><p class="c81"><span class="c2">#+ that the original script is a part of.</span></p><p class="c81"><span class="c2"># This script processes text files to produce a sorted list</span></p><p class="c81"><span class="c2">#+ of words found in the files.</span></p><p class="c81"><span class="c2"># This may be useful for compiling dictionaries</span></p><p class="c81"><span class="c2">#+ and for other lexicographic purposes.</span></p><p class="c81 c16"><span class="c2"></span></p><p class="c81"><span class="c2">E_BADARGS=85 # Error code for bad arguments.</span></p><p class="c81 c16"><span class="c2"></span></p><p class="c81"><span class="c2"># Check if at least one valid file argument is provided and readable.</span></p><p class="c81"><span class="c2">if [ ! -r &quot;$1&quot; ]; then</span></p><p class="c81"><span class="c2">&nbsp; echo &quot;Usage: $0 files-to-process&quot;</span></p><p class="c81"><span class="c2">&nbsp; exit $E_BADARGS # Exit with error code if no valid file is provided.</span></p><p class="c81"><span class="c2">fi</span></p><p class="c81 c16"><span class="c2"></span></p><p class="c81"><span class="c2"># Process the specified files.</span></p><p class="c81"><span class="c2">cat $* | &nbsp; &nbsp; &nbsp; # Dump the contents of all specified files to stdout.</span></p><p class="c81"><span class="c2">tr A-Z a-z | &nbsp; # Convert all uppercase letters to lowercase.</span></p><p class="c81"><span class="c2">tr &#39; &#39; &#39;\012&#39; |# Convert spaces to newlines to ensure each word is on a new line.</span></p><p class="c81"><span class="c2"># tr -cd &#39;\012[a-z][0-9]&#39; | # Original script: Remove all non-alphanumeric characters.</span></p><p class="c81"><span class="c2">tr -c &#39;\012a-z&#39; &#39;\012&#39; | # Instead of deleting non-alpha characters, convert them to newlines.</span></p><p class="c81"><span class="c2">sort | &nbsp; &nbsp; &nbsp; &nbsp; # Sort the words alphabetically.</span></p><p class="c81"><span class="c2">uniq | &nbsp; &nbsp; &nbsp; &nbsp; # Remove duplicate words.</span></p><p class="c81"><span class="c2">grep -v &#39;^#&#39; | # Remove lines that start with a hash (#).</span></p><p class="c81"><span class="c2">grep -v &#39;^$&#39; &nbsp; # Remove blank lines.</span></p><p class="c81 c16"><span class="c2"></span></p><p class="c81"><span class="c83 c28">exit $? # Exit with the status of the last command.</span></p></td></tr></table><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 555.06px; height: 368.23px;"><img alt="" src="images/image18.png" style="width: 555.06px; height: 368.23px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c3"><span class="c27">Example A-9. Soundex conversion</span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3"><span class="c15 c28">This Bash script, soundex</span><span class="c15 c28">.sh</span><span class="c15 c28">, calculates the Soundex code for a given name &mdash; a phonetic encoding system that helps group similar-sounding names. It requires exactly one command-line argument (the name). The script begins by converting the name to lowercase, extracting and capitalizing the first letter (which becomes the prefix of the Soundex code), then mapping the remaining letters to digits based on their phonetic groupings (e.g., b/f/p/v = 1, c/g/j/k = 2, etc.). Vowels and the letters </span><span class="c15 c28">w</span><span class="c15 c28">&nbsp;and </span><span class="c15 c28">h</span><span class="c15 c28">&nbsp;are removed, and repeated digits are compressed using </span><span class="c15 c28">tr -s</span><span class="c15 c28">. A special &quot;Exception Patch&quot; section attempts to ensure that the numeric encoding properly handles cases where the first character is a silent or vowel-like sound. After processing, the script pads the numeric suffix with zeros and concatenates it with the prefix, truncating the final result to exactly four characters. This approach mimics how the Soundex algorithm is used by U.S. government agencies and genealogists to match names with similar pronunciation but different spellings (e.g., &quot;Smith&quot; and &quot;Smythe&quot; both become </span><span class="c15 c28">S530</span><span class="c15 c28">).</span></p><table class="c32"><tr class="c211"><td class="c115" colspan="1" rowspan="1"><p class="c36"><span class="c2">#!/bin/bash</span></p><p class="c36"><span class="c2"># soundex.sh: Calculate &quot;soundex&quot; code for names</span></p><p class="c36"><span class="c2"># =======================================================</span></p><p class="c36"><span class="c2"># Soundex script</span></p><p class="c36"><span class="c2"># by</span></p><p class="c36"><span class="c2"># Mendel Cooper</span></p><p class="c36"><span class="c2"># thegrendel.abs@gmail.com</span></p><p class="c36"><span class="c2"># reldate: 23 January, 2002</span></p><p class="c36"><span class="c2">#</span></p><p class="c36"><span class="c2"># Placed in the Public Domain.</span></p><p class="c36"><span class="c2">#</span></p><p class="c36"><span class="c2"># A slightly different version of this script appeared in</span></p><p class="c36"><span class="c2"># Ed Schaefer&#39;s July, 2002 &quot;Shell Corner&quot; column</span></p><p class="c36"><span class="c2"># in &quot;Unix Review&quot; on-line,</span></p><p class="c36"><span class="c2"># http://www.unixreview.com/documents/uni1026336632258/</span></p><p class="c36"><span class="c2"># =======================================================</span></p><p class="c36"><span class="c2">ARGCOUNT=1 &nbsp;# Expect exactly one argument.</span></p><p class="c36"><span class="c2">E_WRONGARGS=90 &nbsp;# Error code for incorrect number of arguments.</span></p><p class="c36 c16"><span class="c2"></span></p><p class="c36"><span class="c2"># Check if the number of arguments is correct.</span></p><p class="c36"><span class="c2">if [ $# -ne &quot;$ARGCOUNT&quot; ]; then</span></p><p class="c36"><span class="c2">&nbsp; echo &quot;Usage: $(basename $0) name&quot; &nbsp;# Print usage message.</span></p><p class="c36"><span class="c2">&nbsp; exit $E_WRONGARGS &nbsp;# Exit with error code.</span></p><p class="c36"><span class="c2">fi</span></p><p class="c36 c16"><span class="c1"></span></p><p class="c36"><span class="c83 c28"># Function to assign numerical values to letters of the name.</span></p><p class="c36"><span class="c2">assign_value () {</span></p><p class="c36"><span class="c2">&nbsp; val1=bfpv &nbsp;# &#39;b,f,p,v&#39; = 1</span></p><p class="c36"><span class="c2">&nbsp; val2=cgjkqsxz &nbsp;# &#39;c,g,j,k,q,s,x,z&#39; = 2</span></p><p class="c36"><span class="c2">&nbsp; val3=dt &nbsp;# &#39;d,t&#39; = 3</span></p><p class="c36"><span class="c2">&nbsp; val4=l &nbsp;# &#39;l&#39; = 4</span></p><p class="c36"><span class="c2">&nbsp; val5=mn &nbsp;# &#39;m,n&#39; = 5</span></p><p class="c36"><span class="c2">&nbsp; val6=r &nbsp;# &#39;r&#39; = 6</span></p><p class="c36 c16"><span class="c2"></span></p><p class="c36"><span class="c2">&nbsp; # Assign numerical values, remove duplicates, and strip vowels.</span></p><p class="c36"><span class="c2">&nbsp; value=$(echo &quot;$1&quot; | tr -d wh \</span></p><p class="c36"><span class="c2">&nbsp; &nbsp; | tr $val1 1 | tr $val2 2 | tr $val3 3 \</span></p><p class="c36"><span class="c2">&nbsp; &nbsp; | tr $val4 4 | tr $val5 5 | tr $val6 6 \</span></p><p class="c36"><span class="c2">&nbsp; &nbsp; | tr -s 123456 \</span></p><p class="c36"><span class="c2">&nbsp; &nbsp; | tr -d aeiouy)</span></p><p class="c36"><span class="c2">}</span></p><p class="c36 c16"><span class="c2"></span></p><p class="c36"><span class="c2">input_name=&quot;$1&quot; &nbsp;# Store input name.</span></p><p class="c36"><span class="c2">echo</span></p><p class="c36"><span class="c2">echo &quot;Name = $input_name&quot;</span></p><p class="c36 c16"><span class="c2"></span></p><p class="c36"><span class="c2"># Change all characters of name input to lowercase.</span></p><p class="c36"><span class="c2">name=$(echo $input_name | tr A-Z a-z)</span></p><p class="c36 c16"><span class="c2"></span></p><p class="c36"><span class="c2"># Prefix of soundex code: first letter of name.</span></p><p class="c36"><span class="c2">char_pos=0 &nbsp;# Initialize character position.</span></p><p class="c36"><span class="c2">prefix0=${name:$char_pos:1} &nbsp;# Get first letter.</span></p><p class="c36"><span class="c2">prefix=$(echo $prefix0 | tr a-z A-Z) &nbsp;# Convert to uppercase.</span></p><p class="c36 c16"><span class="c1"></span></p><p class="c36"><span class="c2">let &quot;char_pos += 1&quot; &nbsp;# Move to the second letter.</span></p><p class="c36"><span class="c2">name1=${name:$char_pos} &nbsp;# Get the rest of the name.</span></p><p class="c36 c16"><span class="c2"></span></p><p class="c36"><span class="c2"># Exception Patch to handle special cases.</span></p><p class="c36"><span class="c2">char1=$(echo $prefix | tr A-Z a-z) &nbsp;# First letter in lowercase.</span></p><p class="c36"><span class="c2">assign_value $name &nbsp;# Assign values to the name.</span></p><p class="c36"><span class="c2">s1=$value</span></p><p class="c36"><span class="c2">assign_value $name1 &nbsp;# Assign values to the name shifted one character.</span></p><p class="c36"><span class="c2">s2=$value</span></p><p class="c36 c16"><span class="c2"></span></p><p class="c36"><span class="c2">assign_value $char1 &nbsp;# Assign value to the first letter.</span></p><p class="c36"><span class="c2">s3=$value</span></p><p class="c36"><span class="c2">s3=9$s3 &nbsp;# If the first letter is a vowel, &#39;w&#39;, or &#39;h&#39;, set value to &#39;9&#39;.</span></p><p class="c36 c16"><span class="c2"></span></p><p class="c36"><span class="c2"># Determine the suffix based on special conditions.</span></p><p class="c36"><span class="c2">if [[ &quot;$s1&quot; -ne &quot;$s2&quot; || &quot;$s3&quot; -eq 9 ]]; then</span></p><p class="c36"><span class="c2">&nbsp; suffix=$s2</span></p><p class="c36"><span class="c2">else</span></p><p class="c36"><span class="c2">&nbsp; suffix=${s2:$char_pos}</span></p><p class="c36"><span class="c2">fi</span></p><p class="c36 c16"><span class="c2"></span></p><p class="c36"><span class="c2">padding=000 &nbsp;# Use at most 3 zeros to pad.</span></p><p class="c36"><span class="c2">soun=$prefix$suffix$padding &nbsp;# Combine prefix, suffix, and padding.</span></p><p class="c36"><span class="c2">MAXLEN=4 &nbsp;# Maximum length of soundex code.</span></p><p class="c36"><span class="c2">soundex=${soun:0:$MAXLEN} &nbsp;# Truncate to 4 characters.</span></p><p class="c36"><span class="c2">echo &quot;Soundex = $soundex&quot;</span></p><p class="c36"><span class="c2">echo</span></p><p class="c36 c16"><span class="c1"></span></p><p class="c36"><span class="c2"># The soundex code is a method of indexing and classifying names</span></p><p class="c36"><span class="c2"># by grouping together the ones that sound alike.</span></p><p class="c36"><span class="c2"># The soundex code for a given name is the first letter of the name,</span></p><p class="c36"><span class="c2"># followed by a calculated three-number code.</span></p><p class="c36"><span class="c2"># Similar sounding names should have almost the same soundex codes.</span></p><p class="c36"><span class="c2"># Examples:</span></p><p class="c36"><span class="c2"># Smith and Smythe both have a &quot;S-530&quot; soundex.</span></p><p class="c36"><span class="c2"># Harrison = H-625</span></p><p class="c36"><span class="c2"># Hargison = H-622</span></p><p class="c36"><span class="c2"># Harriman = H-655</span></p><p class="c36"><span class="c2"># This works out fairly well in practice, but there are numerous anomalies.</span></p><p class="c36"><span class="c2">#</span></p><p class="c36"><span class="c2"># The U.S. Census and certain other governmental agencies use soundex,</span></p><p class="c36"><span class="c2"># as do genealogical researchers.</span></p><p class="c36"><span class="c2"># For more information,</span></p><p class="c36"><span class="c2"># see the &quot;National Archives and Records Administration home page&quot;,</span></p><p class="c36"><span class="c2"># http://www.nara.gov/genealogy/soundex/soundex.html</span></p><p class="c36"><span class="c2"># Exercise:</span></p><p class="c36"><span class="c2"># --------</span></p><p class="c36"><span class="c2"># Simplify the &quot;Exception Patch&quot; section of this script.</span></p><p class="c36 c16"><span class="c2"></span></p><p class="c36"><span class="c83 c28">exit 0 &nbsp;# Exit the script.</span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c21"><span class="c0">Simplified Exeption Patch:</span></p><p class="c9"><span class="c0"></span></p><p class="c21"><span class="c0"># Assign soundex values (excluding first letter).</span></p><p class="c21"><span class="c0">assign_value &quot;$name1&quot;</span></p><p class="c21"><span class="c0">suffix=$value</span></p><p class="c9"><span class="c0"></span></p><p class="c21"><span class="c0"># Remove leading digit if it matches encoded first letter.</span></p><p class="c21"><span class="c0">assign_value &quot;$prefix0&quot;</span></p><p class="c21"><span class="c0">first_digit=$value</span></p><p class="c9"><span class="c0"></span></p><p class="c21"><span class="c0"># If the suffix starts with the same digit as the first letter&#39;s soundex value, drop it.</span></p><p class="c21"><span class="c0">[[ &quot;${suffix:0:1}&quot; == &quot;$first_digit&quot; ]] &amp;&amp; suffix=${suffix:1}</span></p><p class="c9"><span class="c0"></span></p><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 436.00px;"><img alt="" src="images/image30.png" style="width: 630.14px; height: 436.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c3"><span class="c27">Example A-10. </span><span class="c59 c119 c28">Game of Life</span></p><p class="c3 c16"><span class="c59 c119 c28"></span></p><p class="c3"><span class="c15 c28">This Bash script, </span><span class="c15 c28">life.sh</span><span class="c15 c28">, simulates Conway&rsquo;s Game of Life&mdash;a cellular automaton where each cell in a grid is either alive (</span><span class="c15 c28">.</span><span class="c15 c28">) or dead (</span><span class="c15 c28">_</span><span class="c15 c28">) and evolves over discrete generations based on simple rules: a living cell with 2 or 3 neighbors survives, a dead cell with exactly 3 neighbors becomes alive, and all others die or remain dead. The script reads an initial configuration from a file (</span><span class="c15 c28">gen0</span><span class="c29 c15 c28">), processes the grid as a 1D array, and applies neighbor-counting logic to determine each cell&#39;s state in the next generation, displaying the grid with a 2-second delay between steps. It handles edge boundaries by treating them as always dead and exits early if no cells remain alive. While functional for fixed-size grids, the script includes exercises to enhance it&mdash;such as enabling grid wrapping, detecting grid size from the input file, and optimizing redundant code&mdash;making it both a working demo and a learning tool for Bash scripting.</span></p><p class="c6 c16"><span class="c59 c119 c28"></span></p><p class="c6"><span class="c17">Exercise: Simplify the script, it has redundant code</span></p><table class="c32"><tr class="c117"><td class="c115" colspan="1" rowspan="1"><p class="c22"><span class="c2">#!/bin/bash</span></p><p class="c22"><span class="c2"># life.sh: &quot;Life in the Slow Lane&quot;</span></p><p class="c22"><span class="c2"># Author: Mendel Cooper</span></p><p class="c22"><span class="c2"># License: GPL3</span></p><p class="c22"><span class="c2"># Version 0.2: Patched by Daniel Albers to allow non-square grids as input.</span></p><p class="c22"><span class="c2"># Version 0.2.1: Added 2-second delay between generations.</span></p><p class="c22"><span class="c2"># This is the Bash script version of John Conway&#39;s &quot;Game of Life&quot;.</span></p><p class="c22"><span class="c2"># &quot;Life&quot; is a simple implementation of cellular automata.</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2"># On a rectangular grid, let each &quot;cell&quot; be either &quot;living&quot; or &quot;dead.&quot;</span></p><p class="c22"><span class="c2"># Designate a living cell with a dot, and a dead one with a blank space.</span></p><p class="c22"><span class="c2"># Begin with an arbitrarily drawn dot-and-blank grid, and let this be</span></p><p class="c22"><span class="c2"># the starting generation: generation 0.</span></p><p class="c22"><span class="c2"># Determine each successive generation by the following rules:</span></p><p class="c22"><span class="c2"># 1) Each cell has 8 neighbors: left, right, top, bottom, and the 4 diagonals.</span></p><p class="c22"><span class="c2"># 2) A living cell with either 2 or 3 living neighbors remains alive.</span></p><p class="c22"><span class="c2">SURVIVE=2</span></p><p class="c22"><span class="c2"># 3) A dead cell with 3 living neighbors comes alive, a &quot;birth.&quot;</span></p><p class="c22"><span class="c2">BIRTH=3</span></p><p class="c22"><span class="c2"># 4) All other cases result in a dead cell for the next generation.</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2"># Read the starting generation from the file &quot;gen0&quot; or specified file.</span></p><p class="c22"><span class="c2">startfile=gen0</span></p><p class="c22"><span class="c2">if [ -n &quot;$1&quot; ]; then</span></p><p class="c22"><span class="c2">&nbsp; startfile=&quot;$1&quot;</span></p><p class="c22"><span class="c2">fi</span></p><p class="c22 c16"><span class="c1"></span></p><p class="c22"><span class="c2"># Abort script if &quot;startfile&quot; not specified and default file &quot;gen0&quot; not present.</span></p><p class="c22"><span class="c2">E_NOSTARTFILE=86</span></p><p class="c22"><span class="c2">if [ ! -e &quot;$startfile&quot; ]; then</span></p><p class="c22"><span class="c2">&nbsp; echo &quot;Startfile \&quot;$startfile\&quot; missing!&quot;</span></p><p class="c22"><span class="c2">&nbsp; exit $E_NOSTARTFILE</span></p><p class="c22"><span class="c2">fi</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2">ALIVE1=.</span></p><p class="c22"><span class="c2">DEAD1=_</span></p><p class="c22"><span class="c2"># Represent living and dead cells in the start-up file.</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2"># Grid size (can be changed to match desired grid size).</span></p><p class="c22"><span class="c2">ROWS=10</span></p><p class="c22"><span class="c2">COLS=10</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2">GENERATIONS=10 # Number of generations to cycle through.</span></p><p class="c22"><span class="c2">NONE_ALIVE=85 # Exit status if no cells left alive.</span></p><p class="c22"><span class="c2">DELAY=2 # Pause between generations.</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2">TRUE=0</span></p><p class="c22"><span class="c2">FALSE=1</span></p><p class="c22"><span class="c2">ALIVE=0</span></p><p class="c22"><span class="c2">DEAD=1</span></p><p class="c22"><span class="c2">avar= # Global; holds current generation.</span></p><p class="c22"><span class="c2">generation=0 # Initialize generation count.</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2"># Calculate the number of cells.</span></p><p class="c22"><span class="c2">let &quot;cells = $ROWS * $COLS&quot;</span></p><p class="c22 c16"><span class="c1"></span></p><p class="c22"><span class="c2"># Arrays containing &quot;cells.&quot;</span></p><p class="c22"><span class="c2">declare -a initial</span></p><p class="c22"><span class="c2">declare -a current</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2"># Function to display the grid.</span></p><p class="c22"><span class="c2">display () {</span></p><p class="c22"><span class="c2">&nbsp; alive=0 # How many cells alive at any given time.</span></p><p class="c22"><span class="c2">&nbsp; declare -a arr</span></p><p class="c22"><span class="c2">&nbsp; arr=( `echo &quot;$1&quot;` ) # Convert passed arg to array.</span></p><p class="c22"><span class="c2">&nbsp; element_count=${#arr[*]}</span></p><p class="c22"><span class="c2">&nbsp; local i</span></p><p class="c22"><span class="c2">&nbsp; local rowcheck</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2">&nbsp; for ((i=0; i&lt;$element_count; i++)); do</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; # Insert newline at end of each row.</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; let &quot;rowcheck = $i % COLS&quot;</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; if [ &quot;$rowcheck&quot; -eq 0 ]; then</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; &nbsp; echo # Newline.</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; &nbsp; echo -n &quot; &quot; # Indent.</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; cell=${arr[i]}</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; if [ &quot;$cell&quot; = . ]; then</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; &nbsp; let &quot;alive += 1&quot;</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; echo -n &quot;$cell&quot; | sed -e &#39;s/_/ /g&#39; # Print out array, changing underscores to spaces.</span></p><p class="c22"><span class="c2">&nbsp; done</span></p><p class="c22"><span class="c2">&nbsp; return</span></p><p class="c22"><span class="c83 c28">}</span></p><p class="c22 c16"><span class="c1"></span></p><p class="c22"><span class="c2"># Function to test if cell coordinate is valid.</span></p><p class="c22"><span class="c2">IsValid () {</span></p><p class="c22"><span class="c2">&nbsp; if [ -z &quot;$1&quot; -o -z &quot;$2&quot; ]; then # Mandatory arguments missing?</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; return $FALSE</span></p><p class="c22"><span class="c2">&nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; local row</span></p><p class="c22"><span class="c2">&nbsp; local lower_limit=0 # Disallow negative coordinate.</span></p><p class="c22"><span class="c2">&nbsp; local upper_limit</span></p><p class="c22"><span class="c2">&nbsp; local left</span></p><p class="c22"><span class="c2">&nbsp; local right</span></p><p class="c22"><span class="c2">&nbsp; let &quot;upper_limit = $ROWS * $COLS - 1&quot; # Total number of cells.</span></p><p class="c22"><span class="c2">&nbsp; if [ &quot;$1&quot; -lt &quot;$lower_limit&quot; -o &quot;$1&quot; -gt &quot;$upper_limit&quot; ]; then</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; return $FALSE # Out of array bounds.</span></p><p class="c22"><span class="c2">&nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; row=$2</span></p><p class="c22"><span class="c2">&nbsp; let &quot;left = $row * $COLS&quot; # Left limit.</span></p><p class="c22"><span class="c2">&nbsp; let &quot;right = $left + $COLS - 1&quot; # Right limit.</span></p><p class="c22"><span class="c2">&nbsp; if [ &quot;$1&quot; -lt &quot;$left&quot; -o &quot;$1&quot; -gt &quot;$right&quot; ]; then</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; return $FALSE # Beyond row boundary.</span></p><p class="c22"><span class="c2">&nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; return $TRUE # Valid coordinate.</span></p><p class="c22"><span class="c2">}</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2"># Function to test whether cell is alive.</span></p><p class="c22"><span class="c2">IsAlive () {</span></p><p class="c22"><span class="c2">&nbsp; GetCount &quot;$1&quot; $2 # Get alive cell count in neighborhood.</span></p><p class="c22"><span class="c2">&nbsp; local nhbd=$?</span></p><p class="c22"><span class="c2">&nbsp; if [ &quot;$nhbd&quot; -eq &quot;$BIRTH&quot; ]; then # Alive in any case.</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; return $ALIVE</span></p><p class="c22"><span class="c2">&nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; if [ &quot;$3&quot; = &quot;.&quot; -a &quot;$nhbd&quot; -eq &quot;$SURVIVE&quot; ]; then # Alive only if previously alive.</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; return $ALIVE</span></p><p class="c22"><span class="c2">&nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; return $DEAD # Defaults to dead.</span></p><p class="c22"><span class="c2">}</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2"># Function to count live cells in passed cell&#39;s neighborhood.</span></p><p class="c22"><span class="c2">GetCount () {</span></p><p class="c22"><span class="c2">&nbsp; local cell_number=$2</span></p><p class="c22"><span class="c2">&nbsp; local array</span></p><p class="c22"><span class="c2">&nbsp; local top</span></p><p class="c22"><span class="c2">&nbsp; local center</span></p><p class="c22"><span class="c2">&nbsp; local bottom</span></p><p class="c22"><span class="c2">&nbsp; local r</span></p><p class="c22"><span class="c2">&nbsp; local row</span></p><p class="c22"><span class="c2">&nbsp; local i</span></p><p class="c22"><span class="c2">&nbsp; local t_top</span></p><p class="c22"><span class="c2">&nbsp; local t_cen</span></p><p class="c22"><span class="c2">&nbsp; local t_bot</span></p><p class="c22"><span class="c2">&nbsp; local count=0</span></p><p class="c22"><span class="c2">&nbsp; local ROW_NHBD=3</span></p><p class="c22"><span class="c2">&nbsp; array=( `echo &quot;$1&quot;` )</span></p><p class="c22"><span class="c2">&nbsp; let &quot;top = $cell_number - $COLS - 1&quot; # Set up cell neighborhood.</span></p><p class="c22"><span class="c2">&nbsp; let &quot;center = $cell_number - 1&quot;</span></p><p class="c22"><span class="c2">&nbsp; let &quot;bottom = $cell_number + $COLS - 1&quot;</span></p><p class="c22"><span class="c2">&nbsp; let &quot;r = $cell_number / $COLS&quot;</span></p><p class="c22"><span class="c2">&nbsp; for ((i=0; i&lt;$ROW_NHBD; i++)); do # Traverse from left to right.</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; let &quot;t_top = $top + $i&quot;</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; let &quot;t_cen = $center + $i&quot;</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; let &quot;t_bot = $bottom + $i&quot;</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; let &quot;row = $r&quot; # Count center row.</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; IsValid $t_cen $row # Valid cell position?</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; if [ $? -eq &quot;$TRUE&quot; ]; then</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; &nbsp; if [ ${array[$t_cen]} = &quot;$ALIVE1&quot; ]; then # Is it alive?</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; let &quot;count += 1&quot; # Increment count.</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; &nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; let &quot;row = $r - 1&quot; # Count top row.</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; IsValid $t_top $row</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; if [ $? -eq &quot;$TRUE&quot; ]; then</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; &nbsp; if [ ${array[$t_top]} = &quot;$ALIVE1&quot; ]; then # Redundancy here.</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; let &quot;count += 1&quot;</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; &nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; let &quot;row = $r + 1&quot; # Count bottom row.</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; IsValid $t_bot $row</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; if [ $? -eq &quot;$TRUE&quot; ]; then</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; &nbsp; if [ ${array[$t_bot]} = &quot;$ALIVE1&quot; ]; then</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; let &quot;count += 1&quot;</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; &nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; done</span></p><p class="c22"><span class="c2">&nbsp; if [ ${array[$cell_number]} = &quot;$ALIVE1&quot; ]; then</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; let &quot;count -= 1&quot; # Make sure value of tested cell itself is not counted.</span></p><p class="c22"><span class="c2">&nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; return $count</span></p><p class="c22"><span class="c2">}</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2"># Function to update generation array.</span></p><p class="c22"><span class="c2">next_gen () {</span></p><p class="c22"><span class="c2">&nbsp; local array</span></p><p class="c22"><span class="c2">&nbsp; local i=0</span></p><p class="c22"><span class="c2">&nbsp; array=( `echo &quot;$1&quot;` ) # Convert passed arg to array.</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2">&nbsp; while [ &quot;$i&quot; -lt &quot;$cells&quot; ]; do</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; IsAlive &quot;$1&quot; $i ${array[$i]} # Is the cell alive?</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; if [ $? -eq &quot;$ALIVE&quot; ]; then # If alive, then</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; &nbsp; array[$i]=. # represent the cell as a period.</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; else</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; &nbsp; array[$i]=&quot;_&quot; # Otherwise underscore (will later be converted to space).</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; fi</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; let &quot;i += 1&quot;</span></p><p class="c22"><span class="c2">&nbsp; done</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2">&nbsp; avar=`echo ${array[@]}` # Convert array back to string variable.</span></p><p class="c22"><span class="c2">&nbsp; display &quot;$avar&quot; # Display it.</span></p><p class="c22"><span class="c2">&nbsp; echo; echo</span></p><p class="c22"><span class="c2">&nbsp; echo &quot;Generation $generation - $alive alive&quot;</span></p><p class="c22"><span class="c2">&nbsp; if [ &quot;$alive&quot; -eq 0 ]; then</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; echo</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; echo &quot;Premature exit: no more cells alive!&quot;</span></p><p class="c22"><span class="c2">&nbsp; &nbsp; exit $NONE_ALIVE # No point in continuing if no live cells.</span></p><p class="c22"><span class="c2">&nbsp; fi</span></p><p class="c22"><span class="c2">}</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2"># Main</span></p><p class="c22"><span class="c2">initial=( `cat &quot;$startfile&quot; | sed -e &#39;/#/d&#39; | tr -d &#39;\n&#39; | sed -e &#39;s/\./\. /g&#39; -e &#39;s/_/_ /g&#39;` )</span></p><p class="c22"><span class="c2"># Load initial array with contents of startup file, removing comments and formatting.</span></p><p class="c22"><span class="c2">clear # Clear screen.</span></p><p class="c22"><span class="c2">echo # Title</span></p><p class="c22"><span class="c2">setterm -reverse on</span></p><p class="c22"><span class="c2">echo &quot;=======================&quot;</span></p><p class="c22"><span class="c2">setterm -reverse off</span></p><p class="c22"><span class="c2">echo &quot; $GENERATIONS generations&quot;</span></p><p class="c22"><span class="c2">echo &quot; of&quot;</span></p><p class="c22"><span class="c2">echo &quot;\&quot;Life in the Slow Lane\&quot;&quot;</span></p><p class="c22"><span class="c2">setterm -reverse on</span></p><p class="c22"><span class="c2">echo &quot;=======================&quot;</span></p><p class="c22"><span class="c2">setterm -reverse off</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2">sleep $DELAY # Display &quot;splash screen&quot; for 2 seconds.</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2"># Display first generation.</span></p><p class="c22"><span class="c2">Gen0=`echo ${initial[@]}`</span></p><p class="c22"><span class="c2">display &quot;$Gen0&quot; # Display only.</span></p><p class="c22"><span class="c2">echo; echo</span></p><p class="c22"><span class="c2">echo &quot;Generation $generation - $alive alive&quot;</span></p><p class="c22"><span class="c2">sleep $DELAY</span></p><p class="c22 c16"><span class="c1"></span></p><p class="c22"><span class="c2">let &quot;generation += 1&quot; # Bump generation count.</span></p><p class="c22"><span class="c2">echo</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2"># Display second generation.</span></p><p class="c22"><span class="c2">Cur=`echo ${initial[@]}`</span></p><p class="c22"><span class="c2">next_gen &quot;$Cur&quot; # Update &amp; display.</span></p><p class="c22"><span class="c2">sleep $DELAY</span></p><p class="c22"><span class="c2">let &quot;generation += 1&quot; # Increment generation count.</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2"># Main loop for displaying subsequent generations.</span></p><p class="c22"><span class="c2">while [ &quot;$generation&quot; -le &quot;$GENERATIONS&quot; ]; do</span></p><p class="c22"><span class="c2">&nbsp; Cur=&quot;$avar&quot;</span></p><p class="c22"><span class="c2">&nbsp; next_gen &quot;$Cur&quot;</span></p><p class="c22"><span class="c2">&nbsp; let &quot;generation += 1&quot;</span></p><p class="c22"><span class="c2">&nbsp; sleep $DELAY</span></p><p class="c22"><span class="c2">done</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2">exit 0 # End of script.</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2"># The grid in this script has a &quot;boundary problem.&quot;</span></p><p class="c22"><span class="c2"># The top, bottom, and sides border on a void of dead cells.</span></p><p class="c22"><span class="c2"># Exercise: Change the script to have the grid wrap around,</span></p><p class="c22"><span class="c2"># so that the left and right sides will &quot;touch,&quot; as will the top and bottom.</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c2"># Exercise: Create a new &quot;gen0&quot; file to seed this script.</span></p><p class="c22"><span class="c2"># Use a 12 x 16 grid, instead of the original 10 x 10 one.</span></p><p class="c22"><span class="c2"># Make the necessary changes to the script so it will run with the altered file.</span></p><p class="c22 c16"><span class="c1"></span></p><p class="c22"><span class="c2"># Exercise: Modify this script so that it can determine the grid size</span></p><p class="c22"><span class="c2"># from the &quot;gen0&quot; file, and set any variables necessary for the script to run.</span></p><p class="c22"><span class="c2"># This would make unnecessary any changes to variables in the script for an altered grid size.</span></p><p class="c22 c16"><span class="c2"></span></p><p class="c22"><span class="c83 c28"># Exercise: Optimize this script. It has redundant code.</span></p></td></tr></table><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 350.47px; height: 711.03px;"><img alt="" src="images/image54.png" style="width: 350.47px; height: 711.03px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c1"></span></p><p class="c9"><span class="c0"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c3 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 358.00px; height: 740.37px;"><img alt="" src="images/image53.png" style="width: 358.00px; height: 740.37px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 358.00px; height: 741.34px;"><img alt="" src="images/image29.png" style="width: 358.00px; height: 741.34px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6 c16"><span class="c27"></span></p><p class="c6"><span class="c27">Example A-11. Data file for </span><span class="c59 c119 c28">Game of Life</span><span class="c59 c119">&nbsp;</span></p><table class="c32"><tr class="c131"><td class="c115" colspan="1" rowspan="1"><p class="c6 c7"><span class="c2"># gen0 </span></p><p class="c6 c7"><span class="c2"># </span></p><p class="c7 c23"><span class="c2"># This is an example &quot;generation 0&quot; start-up file for &quot;life.sh&quot;. # -------------------------------------------------------------- # The &quot;gen0&quot; file is a 10 x 10 grid using a period (.) for live cells, #+ and an underscore (_) for dead ones. We cannot simply use spaces #+ for dead cells in this file because of a peculiarity in Bash arrays. # [Exercise for the reader: explain this.] </span></p><p class="c7 c89"><span class="c2"># </span></p><p class="c94 c158"><span class="c2"># Lines beginning with a &#39;#&#39; are comments, and the script ignores them. __.__..___ </span></p><p class="c94 c178"><span class="c2">__.._.____ </span></p><p class="c6 c94"><span class="c2">____.___.. </span></p><p class="c6 c94"><span class="c2">_._______. </span></p><p class="c6 c94"><span class="c2">____._____ </span></p><p class="c6 c125"><span class="c2">..__...___ </span></p><p class="c6 c94"><span class="c2">____._____ </span></p><p class="c6 c94"><span class="c2">___...____ </span></p><p class="c6 c94"><span class="c2">__.._..___ </span></p><p class="c6 c94"><span class="c83 c28">_..___..__</span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c6 c16"><span class="c29 c52"></span></p><p class="c77 c139"><span class="c17">The following script is by Mark Moraes of the University of Toronto. See the </span><span class="c29 c52">&nbsp;</span><span class="c17">file </span><span class="c29 c167">Moraes-COPYRIGHT </span><span class="c17">for permissions and restrictions. This file is included in the </span><span class="c29 c52">&nbsp;combined </span><span class="c52 c187">HTML/source tarball </span><span class="c29 c52">of the </span><span class="c59 c52">ABS Guide</span><span class="c29 c52">. </span></p><p class="c4 c77"><span class="c29 c52"></span></p><p class="c4 c77"><span class="c29 c52"></span></p><p class="c4 c77"><span class="c29 c52"></span></p><p class="c4 c77"><span class="c29 c52"></span></p><p class="c4 c77"><span class="c29 c52"></span></p><p class="c4 c77"><span class="c29 c52"></span></p><p class="c4 c77"><span class="c29 c52"></span></p><p class="c4 c77"><span class="c29 c52"></span></p><p class="c4 c77"><span class="c29 c52"></span></p><p class="c4"><span class="c29 c52"></span></p><p class="c42"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 499.91px; height: 834.77px;"><img alt="" src="images/image23.png" style="width: 499.91px; height: 834.77px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c42"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 468.47px; height: 782.27px;"><img alt="" src="images/image37.png" style="width: 468.47px; height: 782.27px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c42 c16"><span class="c27"></span></p><p class="c42"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 513.36px; height: 857.23px;"><img alt="" src="images/image11.png" style="width: 513.36px; height: 857.23px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c42"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 510.11px; height: 871.23px;"><img alt="" src="images/image34.png" style="width: 510.11px; height: 871.23px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c86"><span class="c27">Example A-12. </span><span class="c59 c119 c28">behead</span><span class="c27">: Removing mail and news message headers</span></p><p class="c86 c16"><span class="c27"></span></p><p class="c86"><span class="c15 c28">This shell script is designed to strip the header from email or Usenet message files, which typically ends at the first empty line. If no arguments are provided, the script assumes the input comes from standard input (e.g., piped or redirected file) and uses </span><span class="c15 c28">sed</span><span class="c15 c28">&nbsp;to remove all lines from the start of the file up to and including the first empty line (</span><span class="c15 c28">1,/^$/d</span><span class="c15 c28">), as well as any lines that are completely blank or only contain spaces (</span><span class="c15 c28">/^[ ]*$/d</span><span class="c15 c28">). If filenames are provided as arguments, the script loops through each file and applies the same </span><span class="c15 c28">sed</span><span class="c15 c28">&nbsp;logic to clean each one. It ends with a note suggesting enhancements such as adding error checking (e.g., for missing files) and possibly embedding the repeated </span><span class="c15 c28">sed</span><span class="c29 c15 c28">&nbsp;command in a function, which could improve maintainability&mdash;though in a small script like this, a function might not be strictly necessary. The script is open source, released under a permissive license by the University of Toronto, with attribution and disclaimer clauses.</span></p><p class="c9"><span class="c0"></span></p><table class="c32"><tr class="c151"><td class="c115" colspan="1" rowspan="1"><p class="c6 c11"><span class="c2">#!/bin/sh</span></p><p class="c6 c11"><span class="c2"># Strips off the header from a mail/News message i.e. till the first empty line.</span></p><p class="c6 c11"><span class="c2"># Author: Mark Moraes, University of Toronto</span></p><p class="c6 c11"><span class="c2"># ==&gt; These comments added by author of this document.</span></p><p class="c6 c11 c16"><span class="c2"></span></p><p class="c6 c11"><span class="c2"># Check if no command-line arguments are present.</span></p><p class="c6 c11"><span class="c2">if [ $# -eq 0 ]; then</span></p><p class="c6 c11"><span class="c2">&nbsp; # ==&gt; If no command-line args present, then work on file redirected to stdin.</span></p><p class="c6 c11"><span class="c2">&nbsp; sed -e &#39;1,/^$/d&#39; -e &#39;/^[ ]*$/d&#39;</span></p><p class="c6 c11"><span class="c2">&nbsp; # --&gt; Delete all lines until the first empty line (header) and then delete empty lines.</span></p><p class="c6 c11"><span class="c2">else</span></p><p class="c6 c11"><span class="c2">&nbsp; # ==&gt; If command-line args present, then work on files named.</span></p><p class="c6 c11"><span class="c2">&nbsp; for i; do</span></p><p class="c6 c11"><span class="c2">&nbsp; &nbsp; sed -e &#39;1,/^$/d&#39; -e &#39;/^[ ]*$/d&#39; $i</span></p><p class="c6 c11"><span class="c2">&nbsp; &nbsp; # --&gt; For each file, delete all lines until the first empty line and then delete empty lines.</span></p><p class="c6 c11"><span class="c2">&nbsp; done</span></p><p class="c6 c11"><span class="c2">fi</span></p><p class="c6 c11 c16"><span class="c2"></span></p><p class="c6 c11"><span class="c2">exit</span></p><p class="c6 c11 c16"><span class="c2"></span></p><p class="c6 c11"><span class="c2"># ==&gt; Exercise: Add error checking and other options.</span></p><p class="c6 c11"><span class="c2"># ==&gt; Note that the small sed script repeats, except for the arg passed.</span></p><p class="c6 c11"><span class="c2"># ==&gt; Does it make sense to embed it in a function? Why or why not?</span></p><p class="c6 c11 c16"><span class="c2"></span></p><p class="c6 c11"><span class="c2">/*</span></p><p class="c6 c11"><span class="c2">* Copyright University of Toronto 1988, 1989.</span></p><p class="c6 c11"><span class="c2">* Written by Mark Moraes</span></p><p class="c6 c11"><span class="c2">*</span></p><p class="c6 c11"><span class="c2">* Permission is granted to anyone to use this software for any purpose on</span></p><p class="c6 c11"><span class="c2">* any computer system, and to alter it and redistribute it freely, subject</span></p><p class="c6 c11"><span class="c2">* to the following restrictions:</span></p><p class="c6 c11"><span class="c2">*</span></p><p class="c6 c11"><span class="c2">* 1. The author and the University of Toronto are not responsible</span></p><p class="c6 c11"><span class="c2">* &nbsp; &nbsp;for the consequences of use of this software, no matter how awful,</span></p><p class="c6 c11"><span class="c2">* &nbsp; &nbsp;even if they arise from flaws in it.</span></p><p class="c6 c11"><span class="c2">*</span></p><p class="c6 c11"><span class="c2">* 2. The origin of this software must not be misrepresented, either by</span></p><p class="c6 c11"><span class="c2">* &nbsp; &nbsp;explicit claim or by omission. Since few users ever read sources,</span></p><p class="c6 c11"><span class="c2">* &nbsp; &nbsp;credits must appear in the documentation.</span></p><p class="c6 c11"><span class="c2">*</span></p><p class="c6 c11"><span class="c2">* 3. Altered versions must be plainly marked as such, and must not be</span></p><p class="c6 c11"><span class="c2">* &nbsp; &nbsp;misrepresented as being the original software. Since few users</span></p><p class="c6 c11"><span class="c2">* &nbsp; &nbsp;ever read sources, credits must appear in the documentation.</span></p><p class="c6 c11"><span class="c2">*</span></p><p class="c6 c11"><span class="c2">* 4. This notice may not be removed or altered.</span></p><p class="c6 c11"><span class="c83 c28">*/</span></p><p class="c6 c11 c16"><span class="c1"></span></p><p class="c6 c11 c16"><span class="c1"></span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c6 c55"><span class="c29 c52">+</span><span class="c17">Antek Sawicki contributed the following script, which makes very clever use of the </span><span class="c29 c52">&nbsp;parameter substitution operators discussed in </span><span class="c187 c52">Section 10.2</span><span class="c29 c52">. </span></p><p class="c6 c16"><span class="c29 c52"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 369.22px; height: 556.23px;"><img alt="" src="images/image46.png" style="width: 369.22px; height: 556.23px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><table class="c32"><tr class="c96"><td class="c193" colspan="1" rowspan="1"><p class="c6"><span class="c126">Yes, embedding the repeated </span><span class="c126">sed</span><span class="c126">&nbsp;command in a function makes sense because it improves the script&rsquo;s clarity, avoids code duplication, and makes future maintenance easier. By placing the </span><span class="c126">sed</span><span class="c126">&nbsp;logic into a function (e.g., </span><span class="c126">strip_header</span><span class="c126">), the script becomes more readable and changes to the stripping logic only need to be made in one place. While functions may seem unnecessary in very short scripts, using one here is justified since the </span><span class="c126">sed</span><span class="c126">&nbsp;command is repeated</span><span class="c126">&nbsp;</span><span class="c29 c72">and may be extended with error handling or logging later. It also aligns with good scripting practices for modularity and scalability.</span></p></td></tr></table><p class="c86"><span class="c27">Example A-13. </span><span class="c59 c119 c28">password</span><span class="c27">: Generating random 8-character passwords</span></p><p class="c16 c86"><span class="c27"></span></p><p class="c86"><span class="c15">This Bash script generates a random alphanumeric password by selecting characters from a predefined set (</span><span class="c15">MATRIX</span><span class="c15">) consisting of digits, uppercase, and lowercase letters. The desired password length is set by the </span><span class="c15">LENGTH</span><span class="c15">&nbsp;variable (default is 8 characters). The script uses a </span><span class="c15">while</span><span class="c15">&nbsp;loop that initializes a counter </span><span class="c15">n</span><span class="c15">&nbsp;(defaulting to 1 if unset) and runs until the counter exceeds </span><span class="c15">LENGTH</span><span class="c15">. In each iteration, it appends a randomly selected character from </span><span class="c15">MATRIX</span><span class="c15">&nbsp;to the </span><span class="c15">PASS</span><span class="c15">&nbsp;variable using </span><span class="c15">${MATRIX:$(($RANDOM%${#MATRIX})):1}</span><span class="c15">&mdash;a syntax that selects a single character at a random index within the character set. The password is built one character at a time and optionally displayed during construction (the </span><span class="c15">echo &quot;$PASS&quot;</span><span class="c15">&nbsp;line). After the loop, the final password is printed, and the script exits normally with </span><span class="c15">exit 0</span><span class="c15">. This script demonstrates simple but effective password generation using core Bash features without external dependencies.</span></p><table class="c32"><tr class="c201"><td class="c115" colspan="1" rowspan="1"><p class="c19"><span class="c2">#!/bin/bash</span></p><p class="c19"><span class="c2">#</span></p><p class="c19"><span class="c2"># This script generates a random password consisting of alphanumeric characters.</span></p><p class="c19"><span class="c2"># Author: Antek Sawicki &lt;tenox@tenox.tc&gt;</span></p><p class="c19"><span class="c2"># Usage permission granted to the ABS Guide author.</span></p><p class="c19"><span class="c2">#</span></p><p class="c19 c16"><span class="c2"></span></p><p class="c19"><span class="c2"># Define the character set from which the password will be generated.</span></p><p class="c19"><span class="c2">MATRIX=&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;</span></p><p class="c19 c16"><span class="c2"></span></p><p class="c19"><span class="c2"># Define the length of the password.</span></p><p class="c19"><span class="c2">LENGTH=&quot;8&quot; # Change this value to generate passwords of different lengths.</span></p><p class="c19 c16"><span class="c2"></span></p><p class="c19"><span class="c2"># Start a loop to generate the password.</span></p><p class="c19"><span class="c2">while [ &quot;${n:=1}&quot; -le &quot;$LENGTH&quot; ]</span></p><p class="c19"><span class="c2"># If &#39;n&#39; is not initialized, set it to 1.</span></p><p class="c19"><span class="c2">do</span></p><p class="c19"><span class="c2">&nbsp; &nbsp; # Generate a random character from the MATRIX and append it to the password.</span></p><p class="c19"><span class="c2">&nbsp; &nbsp; PASS=&quot;$PASS${MATRIX:$(($RANDOM%${#MATRIX})):1}&quot; #Each iteration appends a character of the matrix until n==LENGTH</span></p><p class="c19"><span class="c2">&nbsp; &nbsp; # The ${#MATRIX} gets the length of the MATRIX.</span></p><p class="c19"><span class="c2">&nbsp; &nbsp; # $RANDOM generates a random number, and %${#MATRIX} ensures it&#39;s within the range of the MATRIX length.</span></p><p class="c19"><span class="c2">&nbsp; &nbsp; # ${MATRIX:$(($RANDOM%${#MATRIX})):1} gets a character from the MATRIX at a random position.</span></p><p class="c19 c16"><span class="c2"></span></p><p class="c19"><span class="c2">&nbsp; &nbsp; # Uncomment the line below to see the password being built character by character.</span></p><p class="c19"><span class="c2">&nbsp; &nbsp; &nbsp;echo &quot;$PASS&quot;</span></p><p class="c19 c16"><span class="c2"></span></p><p class="c19"><span class="c2">&nbsp; &nbsp; # Increment &#39;n&#39; for the next iteration.</span></p><p class="c19"><span class="c2">&nbsp; &nbsp; let n+=1</span></p><p class="c19"><span class="c2">done</span></p><p class="c19 c16"><span class="c1"></span></p><p class="c19"><span class="c2"># Output the generated password.</span></p><p class="c19"><span class="c2">echo &quot;$PASS&quot;</span></p><p class="c19 c16"><span class="c2"></span></p><p class="c19"><span class="c2"># Exit the script with status 0.</span></p><p class="c19"><span class="c2">exit 0</span></p><p class="c19 c16"><span class="c1"></span></p><p class="c19 c16"><span class="c1"></span></p></td></tr></table><p class="c6"><span class="c29 c52">&nbsp;</span></p><p class="c206"><span class="c17">James R. Van Zandt contributed this script which uses named pipes and, in his </span><span class="c29 c52">&nbsp;</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 378.00px; height: 365.10px;"><img alt="" src="images/image47.png" style="width: 378.00px; height: 365.10px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c29 c52">words, &quot;really exercises quoting and escaping.&quot; </span></p><p class="c67"><span class="c27">Example A-14. </span><span class="c59 c119 c28">fifo</span><span class="c27">: Making daily backups, using named pipes</span></p><p class="c67 c16"><span class="c27"></span></p><p class="c67"><span class="c15">This script performs a secure, compressed remote backup of essential system directories using a named pipe (</span><span class="c15">/pipe</span><span class="c15">). It begins by defining the local host&#39;s name (</span><span class="c15">HERE</span><span class="c15">) and the remote host (</span><span class="c15">THERE</span><span class="c15">), then prints a timestamped message. It ensures that </span><span class="c15">/pipe</span><span class="c15">&nbsp;is a valid named pipe by deleting any existing file with that name and recreating it using </span><span class="c15">mkfifo</span><span class="c15">. A background process (</span><span class="c15">su xyz -c ...</span><span class="c15">) switches to user </span><span class="c15">xyz</span><span class="c15">&nbsp;and uses </span><span class="c15">ssh</span><span class="c15">&nbsp;to connect to the remote host </span><span class="c15">bilbo</span><span class="c15">, where it saves the incoming data to a compressed archive file. Meanwhile, on the local machine, </span><span class="c15">tar</span><span class="c15">&nbsp;compresses system directories and writes the output to </span><span class="c15">/pipe</span><span class="c15">, which is read in real-time by the remote </span><span class="c15">ssh</span><span class="c15">&nbsp;command. The use of a named pipe allows two independent processes (tar and ssh) to communicate asynchronously through the filesystem. This wouldn&#39;t work with a standard anonymous pipe (</span><span class="c15">|</span><span class="c15">) because the writer and reader would need to be in the same shell pipeline; in this case, they are launched as separate processes. Finally, while the script does not delete the named pipe after use, doing so is recommended (e.g., </span><span class="c15">rm -f /pipe</span><span class="c15">) to avoid leaving unused filesystem entries.</span></p><table class="c32"><tr class="c168"><td class="c115" colspan="1" rowspan="1"><p class="c26"><span class="c2">#!/bin/bash</span></p><p class="c26"><span class="c2"># ==&gt; Script by James R. Van Zandt, and used here with his permission.</span></p><p class="c26"><span class="c2"># ==&gt; Comments added by author of this document.</span></p><p class="c26 c16"><span class="c2"></span></p><p class="c26"><span class="c2">HERE=`uname -n` # ==&gt; hostname</span></p><p class="c26"><span class="c2">THERE=bilbo</span></p><p class="c26"><span class="c2">echo &quot;starting remote backup to $THERE at `date +%r`&quot;</span></p><p class="c26"><span class="c2"># ==&gt; `date +%r` returns time in 12-hour format, i.e. &quot;08:08:34 PM&quot;.</span></p><p class="c26"><span class="c2"># make sure /pipe really is a pipe and not a plain file</span></p><p class="c26"><span class="c2">rm -rf /pipe</span></p><p class="c26"><span class="c2">mkfifo /pipe # ==&gt; Create a &quot;named pipe&quot;, named &quot;/pipe&quot; ...</span></p><p class="c26"><span class="c2"># ==&gt; &#39;su xyz&#39; runs commands as user &quot;xyz&quot;.</span></p><p class="c26"><span class="c2"># ==&gt; &#39;ssh&#39; invokes secure shell (remote login client).</span></p><p class="c26"><span class="c2">su xyz -c &quot;ssh $THERE \&quot;cat &gt; /home/xyz/backup/${HERE}-daily.tar.gz\&quot; &lt;</span></p><p class="c26"><span class="c2">/pipe&quot;&amp;</span></p><p class="c26"><span class="c2">cd /</span></p><p class="c26"><span class="c2">tar -czf - bin boot dev etc home info lib man root sbin share usr var &gt;</span></p><p class="c26"><span class="c2">/pipe</span></p><p class="c26"><span class="c2"># ==&gt; Uses named pipe, /pipe, to communicate between processes:</span></p><p class="c26"><span class="c2"># ==&gt; &#39;tar/gzip&#39; writes to /pipe and &#39;ssh&#39; reads from /pipe.</span></p><p class="c26"><span class="c2"># ==&gt; The end result is this backs up the main directories, from / on down.</span></p><p class="c26"><span class="c2"># ==&gt; What are the advantages of a &quot;named pipe&quot; in this situation,</span></p><p class="c26"><span class="c2"># ==&gt;+ as opposed to an &quot;anonymous pipe&quot;, with |?</span></p><p class="c26"><span class="c2"># ==&gt; Will an anonymous pipe even work here?</span></p><p class="c26"><span class="c2"># ==&gt; Is it necessary to delete the pipe before exiting the script?</span></p><p class="c26"><span class="c2"># ==&gt; How could that be done?</span></p><p class="c26"><span class="c83 c28">exit 0</span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c6 c55"><span class="c29 c52">+ </span></p><p class="c54"><span class="c17">St&eacute;phane Chazelas used the following script to demonstrate generating prime numbers </span><span class="c29 c52">&nbsp;without arrays. </span></p><p class="c42"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 205.33px;"><img alt="" src="images/image27.png" style="width: 630.14px; height: 205.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c42 c16"><span class="c27"></span></p><p class="c42 c16"><span class="c27"></span></p><p class="c42 c16"><span class="c27"></span></p><p class="c16 c42"><span class="c27"></span></p><p class="c42 c16"><span class="c27"></span></p><p class="c42 c16"><span class="c27"></span></p><p class="c42 c16"><span class="c27"></span></p><p class="c42 c16"><span class="c27"></span></p><p class="c42 c16"><span class="c27"></span></p><p class="c42 c16"><span class="c27"></span></p><p class="c42 c16"><span class="c27"></span></p><p class="c42 c16"><span class="c27"></span></p><p class="c42 c16"><span class="c27"></span></p><p class="c42 c16"><span class="c27"></span></p><p class="c86 c16"><span class="c27"></span></p><p class="c42"><span class="c27">Example A-15. Generating prime numbers using the modulo operator</span></p><p class="c42"><span class="c52 c28">This Bash script (primes</span><span class="c52 c28">.sh</span><span class="c52 c28">) generates prime numbers from 2 up to a defined limit (1000) using a recursive function rather than traditional loops or arrays. It starts with an initial call </span><span class="c52 c28">Primes 1</span><span class="c52 c28">, which then recursively increments the number and checks whether it is divisible by any previously found primes passed as parameters. If a number has no divisors (i.e., it is prime), it is added to the argument list and passed to the next recursive call. The check </span><span class="c52 c28">(( i * i &gt; n ))</span><span class="c52 c28">&nbsp;is an optimization that stops the inner loop early once all relevant divisors are tested. The use of </span><span class="c52 c28">&quot;$@&quot;</span><span class="c52 c28">&nbsp;allows the function to accumulate and pass along all found primes without using arrays. When the counter reaches the </span><span class="c52 c28">LIMIT</span><span class="c17">, the function prints the list of prime numbers and exits. This intuitive method mimics manual prime checking and cleverly uses positional parameters and recursion to track state, making it a compact and elegant demonstration of functional-style logic in Bash.</span></p><p class="c42 c16"><span class="c27"></span></p><table class="c32"><tr class="c188"><td class="c115" colspan="1" rowspan="1"><p class="c6 c7"><span class="c1">#!/bin/bash </span></p><p class="c6 c7"><span class="c1"># primes.sh: Generate prime numbers, without using arrays. </span></p><p class="c6 c7"><span class="c1"># Script contributed by Stephane Chazelas. </span></p><p class="c7 c148"><span class="c1"># This does *not* use the classic &quot;Sieve of Eratosthenes&quot; algorithm, #+ but instead the more intuitive method of testing each candidate number #+ for factors (divisors), using the &quot;%&quot; modulo operator. </span></p><p class="c124 c198"><span class="c1">LIMIT=1000 # Primes, 2 ... 1000. </span></p><p class="c159"><span class="c1">Primes() </span></p><p class="c6 c130"><span class="c1">{ </span></p><p class="c6 c142"><span class="c1">(( n = $1 + 1 )) # Bump to next integer. </span></p><p class="c6 c127"><span class="c1">shift # Next parameter in list.</span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><table class="c32"><tr class="c153"><td class="c115" colspan="1" rowspan="1"><p class="c6 c7"><span class="c1"># echo &quot;_n=$n i=$i_&quot; </span></p><p class="c163 c174"><span class="c1">if (( n == LIMIT )) </span></p><p class="c6 c192"><span class="c1">then echo $* </span></p><p class="c6 c170"><span class="c1">return </span></p><p class="c6 c127"><span class="c1">fi </span></p><p class="c7 c214"><span class="c1">for i; do # &quot;i&quot; set to &quot;@&quot;, previous values of $n. # echo &quot;-n=$n i=$i-&quot; </span></p><p class="c66"><span class="c1">&nbsp;(( i * i &gt; n )) &amp;&amp; break # Optimization. </span></p><p class="c94 c179"><span class="c1">&nbsp;(( n % i )) &amp;&amp; continue # Sift out non-primes using modulo operator. &nbsp;Primes $n $@ # Recursion inside loop. </span></p><p class="c89 c94"><span class="c1">&nbsp;return </span></p><p class="c6 c94"><span class="c1">&nbsp;done </span></p><p class="c94 c163"><span class="c1">&nbsp;Primes $n $@ $n # Recursion outside loop. </span></p><p class="c6 c94"><span class="c1">&nbsp;# Successively accumulate </span></p><p class="c152"><span class="c1">&nbsp;#+ positional parameters. </span></p><p class="c150"><span class="c1">&nbsp;# &quot;$@&quot; is the accumulating list of primes. } </span></p><p class="c207"><span class="c1">Primes 1 </span></p><p class="c36"><span class="c1">exit $? </span></p><p class="c7 c102"><span class="c1"># Pipe output of the script to &#39;fmt&#39; for prettier printing. # Uncomment lines 16 and 24 to help figure out what is going on. </span></p><p class="c7 c171"><span class="c1"># Compare the speed of this algorithm for generating primes #+ with the Sieve of Eratosthenes (ex68.sh). </span></p><p class="c7 c124"><span class="c1"># Exercise: Rewrite this script without recursion.</span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c21"><span class="c0">Solution: </span></p><p class="c9"><span class="c0"></span></p><table class="c32"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c0">#!/bin/bash</span></p><p class="c6"><span class="c0"># primes.sh: Generate prime numbers, without using arrays.</span></p><p class="c6"><span class="c0"># Script contributed by Stephane Chazelas.</span></p><p class="c6"><span class="c0"># This does *not* use the classic &quot;Sieve of Eratosthenes&quot; algorithm,</span></p><p class="c6"><span class="c0"># but instead the more intuitive method of testing each candidate number</span></p><p class="c6"><span class="c0"># for factors (divisors), using the &quot;%&quot; modulo operator.</span></p><p class="c6 c16"><span class="c0"></span></p><p class="c6"><span class="c0">LIMIT=1000 # Primes, 2 ... 1000.</span></p><p class="c6"><span class="c0"># Set the limit up to which we want to find prime numbers.</span></p><p class="c6 c16"><span class="c0"></span></p><p class="c6"><span class="c0">Primes()</span></p><p class="c6"><span class="c0">{</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; (( n = $1 + 1 )) # Bump to next integer.</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; # Increment the input number by 1.</span></p><p class="c6 c16"><span class="c0"></span></p><p class="c6"><span class="c0">&nbsp; &nbsp; shift # Next parameter in list.</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; # Shift the positional parameters to the left, discarding the first one.</span></p><p class="c6 c16"><span class="c0"></span></p><p class="c6"><span class="c0">&nbsp; &nbsp; # echo &quot;_n=$n i=$i_&quot;</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; # Uncomment for debugging: shows current value of n and i.</span></p><p class="c6 c16"><span class="c0"></span></p><p class="c6"><span class="c0">&nbsp; &nbsp; if (( n == LIMIT ))</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; then </span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; echo $*</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; # If the current number equals the limit, print all the primes found so far.</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; return</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; fi</span></p><p class="c6 c16"><span class="c0"></span></p><p class="c6"><span class="c0">&nbsp; &nbsp; for i; do # &quot;i&quot; set to &quot;@&quot;, previous values of $n.</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; # Iterate over all passed parameters, which are potential primes.</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; # echo &quot;-n=$n i=$i-&quot;</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; # Uncomment for debugging: shows current value of n and i.</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; (( i * i &gt; n )) &amp;&amp; break # Optimization.</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; # If the square of i is greater than n, exit the loop.</span></p><p class="c6 c16"><span class="c0"></span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; (( n % i )) &amp;&amp; continue # Sift out non-primes using modulo operator.</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; # If n is not divisible by i, continue to the next iteration.</span></p><p class="c6 c16"><span class="c0"></span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; Primes $n $@ # Recursion inside loop.</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; # Recursively call Primes with the current number and all primes found so far.</span></p><p class="c6 c16"><span class="c0"></span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; return</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; done</span></p><p class="c6 c16"><span class="c0"></span></p><p class="c6"><span class="c0">&nbsp; &nbsp; Primes $n $@ $n # Recursion outside loop.</span></p><p class="c6"><span class="c0">&nbsp; &nbsp; # Recursively call Primes with the current number, all primes found so far, and the current number itself.</span></p><p class="c6 c16"><span class="c0"></span></p><p class="c6"><span class="c0">&nbsp; &nbsp; # &quot;$@&quot; is the accumulating list of primes.</span></p><p class="c6"><span class="c0">}</span></p><p class="c6 c16"><span class="c0"></span></p><p class="c6"><span class="c0">Primes 1</span></p><p class="c6"><span class="c0"># Initial call to the Primes function with 1.</span></p><p class="c6 c16"><span class="c0"></span></p><p class="c6"><span class="c0">exit $?</span></p><p class="c6"><span class="c0"># Exit the script with the status of the last command.</span></p><p class="c6 c16"><span class="c0"></span></p><p class="c6 c16"><span class="c0"></span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 597.47px; height: 567.09px;"><img alt="" src="images/image7.png" style="width: 597.47px; height: 567.09px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c6 c55"><span class="c29 c52">+ </span></p><p class="c116 c93"><span class="c29 c52">Rick Boivie&#39;s revision of Jordi Sanfeliu&#39;s </span><span class="c59 c52">tree </span><span class="c29 c52">script. </span></p><p class="c116 c93"><span class="c27">Example A-16. </span><span class="c59 c119 c28">tree</span><span class="c27">: Displaying a directory tree</span></p><p class="c116 c93 c16"><span class="c27"></span></p><p class="c21"><span class="c29 c65">This is a bash script that creates a visual directory tree, similar to the Unix tree command.</span></p><p class="c21"><span>It recursively traverses directories starting from a given path (or current directory). It displays the directory structure. Counts and reports the total number of directories found. Handles symbolic links by showing their target information.</span></p><p class="c116 c93 c16"><span class="c2"></span></p><table class="c110 c93"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c18">#!/bin/bash</span></p><p class="c6"><span class="c18"># tree.sh</span></p><p class="c6"><span class="c18"># Written by Rick Boivie.</span></p><p class="c6"><span class="c18"># Used with permission.</span></p><p class="c6"><span class="c18"># This is a revised and simplified version of a script</span></p><p class="c6"><span class="c18">#+ by Jordi Sanfeliu (the original author), and patched by Ian Kjos.</span></p><p class="c6"><span class="c18"># This script replaces the earlier version used in</span></p><p class="c6"><span class="c18">#+ previous releases of the Advanced Bash Scripting Guide.</span></p><p class="c6"><span class="c18"># Copyright (c) 2002, by Jordi Sanfeliu, Rick Boivie, and Ian Kjos.</span></p><p class="c6"><span class="c18"># ==&gt; Comments added by the author of this document.</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># This function performs the directory traversal</span></p><p class="c6"><span class="c18">search() {</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; for dir in `echo *`; do</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; # ==&gt; `echo *` lists all the files in current working directory,</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; #+ ==&gt; without line breaks.</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; # ==&gt; Similar effect to for dir in *</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; # ==&gt; but &quot;dir in `echo *`&quot; will not handle filenames with blanks.</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; if [ -d &quot;$dir&quot; ]; then # ==&gt; If it is a directory (-d)...</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; zz=0 # ==&gt; Temp variable, keeping track of directory level.</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while [ $zz != $1 ]; do # Keep track of inner nested loop.</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo -n &quot;| &quot; # ==&gt; Display vertical connector symbol,</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# ==&gt; with 2 spaces &amp; no line feed</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# in order to indent.</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; zz=`expr $zz + 1` # ==&gt; Increment zz.</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; done</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if [ -L &quot;$dir&quot; ]; then # ==&gt; If directory is a symbolic link...</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo &quot;+---$dir&quot; `ls -l $dir | sed &#39;s/^.*&#39;$dir&#39; //&#39;`</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # ==&gt; Display horiz. connector and list directory name, but...</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # ==&gt; delete date/time part of long listing.</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo &quot;+---$dir&quot; # ==&gt; Display horizontal connector symbol...</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # ==&gt; and print directory name.</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; numdirs=`expr $numdirs + 1` # ==&gt; Increment directory count.</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if cd &quot;$dir&quot;; then # ==&gt; If can move to subdirectory...</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; search `expr $1 + 1` # with recursion ;-)</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # ==&gt; Function calls itself.</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cd ..</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fi</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fi</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; fi</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; done</span></p><p class="c6"><span class="c18">}</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">if [ $# != 0 ]; then</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; cd $1 # Move to indicated directory.</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; #else # stay in current directory</span></p><p class="c6"><span class="c18">fi</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">echo &quot;Initial directory = `pwd`&quot;</span></p><p class="c6"><span class="c18">numdirs=0</span></p><p class="c6"><span class="c18">search 0</span></p><p class="c6"><span class="c18">echo &quot;Total directories = $numdirs&quot;</span></p><p class="c6"><span class="c18">exit 0</span></p></td></tr></table><p class="c116 c93 c16"><span class="c2"></span></p><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 416.00px;"><img alt="" src="images/image42.png" style="width: 630.14px; height: 416.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c29 c65"></span></p><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c3"><span class="c29 c52">Patsie&#39;s version of a directory </span><span class="c52 c59">tree </span><span class="c29 c52">script. </span></p><p class="c116 c93"><span class="c27">Example A-17. </span><span class="c59 c119 c28">tree2</span><span class="c27">: Alternate directory tree script</span></p><p class="c116 c93"><span class="c17">This code is a disk usage analyzer that creates a visual tree showing the largest files and directories with their sizes.</span></p><p class="c116 c93"><span class="c27">Core Functions:</span></p><ul class="c38 lst-kix_9f70qg6dgf9-0 start"><li class="c116 c92 li-bullet-0"><span class="c119 c28">dot()</span><span class="c17">: Formats numbers with commas (e.g., 1234 &rarr; 1,234) for readability</span></li><li class="c116 c92 li-bullet-0"><span class="c119 c28">tree()</span><span class="c17">: Recursive function that builds the visual tree structure</span></li></ul><p class="c116"><span class="c27">Main Logic:</span></p><ol class="c38 lst-kix_jnx53cv5d6p3-0 start" start="1"><li class="c116 c92 li-bullet-0"><span class="c119 c28">Input validation</span><span class="c17">: Checks if a directory argument is provided</span></li><li class="c92 c116 li-bullet-0"><span class="c119 c28">Disk analysis</span><span class="c17">: Uses du -akx to get sizes of all files/directories</span></li><li class="c116 c92 li-bullet-0"><span class="c119 c28">Tree generation</span><span class="c17">: Recursively displays the TOP 5 largest items at each level</span></li><li class="c116 c92 li-bullet-0"><span class="c119 c28">Visual formatting</span><span class="c17">: Creates tree with +- connectors and proper indentation</span></li></ol><p class="c9"><span class="c1"></span></p><table class="c32"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c1">#!/bin/bash</span></p><p class="c6"><span class="c1"># tree2.sh</span></p><p class="c6"><span class="c1"># Lightly modified/reformatted by ABS Guide author.</span></p><p class="c6"><span class="c1"># Included in ABS Guide with permission of script author (thanks!).</span></p><p class="c6"><span class="c1">## Recursive file/dirsize checking script, by Patsie</span></p><p class="c6"><span class="c1">##</span></p><p class="c6"><span class="c1">## This script builds a list of files/directories and their size (du -akx)</span></p><p class="c6"><span class="c1">## and processes this list to a human readable tree shape</span></p><p class="c6"><span class="c1">## The &#39;du -akx&#39; is only as good as the permissions the owner has.</span></p><p class="c6"><span class="c1">## So preferably run as root* to get the best results, or use only on</span></p><p class="c6"><span class="c1">## directories for which you have read permissions. Anything you can&#39;t</span></p><p class="c6"><span class="c1">## read is not in the list.</span></p><p class="c6"><span class="c1">#* ABS Guide author advises caution when running scripts as root!</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">########## THIS IS CONFIGURABLE ##########</span></p><p class="c6"><span class="c1">TOP=5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Top 5 biggest (sub)directories.</span></p><p class="c6"><span class="c1">MAXRECURS=5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Max 5 subdirectories/recursions deep.</span></p><p class="c6"><span class="c1">E_BL=80 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Blank line already returned.</span></p><p class="c6"><span class="c1">E_DIR=81 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Directory not specified.</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">########## DON&#39;T CHANGE ANYTHING BELOW THIS LINE ##########</span></p><p class="c6"><span class="c1">PID=$$ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Our own process ID.</span></p><p class="c6"><span class="c1">SELF=`basename $0` &nbsp; &nbsp; # Our own program name.</span></p><p class="c6"><span class="c1">TMP=&quot;/tmp/${SELF}.${PID}.tmp&quot; &nbsp;# Temporary &#39;du&#39; result.</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Convert number to dotted thousand.</span></p><p class="c6"><span class="c1">function dot {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; echo &quot; $*&quot; | \</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; sed -e :a -e &#39;s/\(.*[0-9]\)\([0-9]\{3\}\)/\1,\2/;ta&#39; | \</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; tail -c 12</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Usage: tree &lt;recursion&gt; &lt;indent prefix&gt; &lt;min size&gt; &lt;directory&gt;</span></p><p class="c6"><span class="c1">function tree {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; recurs=&quot;$1&quot; &nbsp; &nbsp; &nbsp; &nbsp;# How deep nested are we?</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; prefix=&quot;$2&quot; &nbsp; &nbsp; &nbsp; &nbsp;# What do we display before file/dirname?</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; minsize=&quot;$3&quot; &nbsp; &nbsp; &nbsp; # What is the minimum file/dirsize?</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; dirname=&quot;$4&quot; &nbsp; &nbsp; &nbsp; # Which directory are we checking?</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Get ($TOP) biggest subdirs/subfiles from TMP file.</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; LIST=`egrep &quot;[[:space:]]${dirname}/[^/]*$&quot; &quot;$TMP&quot; | \</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; awk &#39;{if($1&gt;&#39;$minsize&#39;) print;}&#39; | \</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sort -nr | \</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; head -$TOP`</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; [ -z &quot;$LIST&quot; ] &amp;&amp; return &nbsp;# Empty list, then go back.</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; cnt=0</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; num=`echo &quot;$LIST&quot; | wc -l` &nbsp;# How many entries in the list.</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; ## Main loop</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; echo &quot;$LIST&quot; | while read size name; do</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; ((cnt+=1)) &nbsp;# Count entry number.</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; bname=`basename &quot;$name&quot;` &nbsp;# We only need a basename of the entry.</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; [ -d &quot;$name&quot; ] &amp;&amp; bname=&quot;$bname/&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; # If it&#39;s a directory, append a slash.</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; echo &quot;`dot $size`$prefix +-$bname&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; # Display the result.</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; # Call ourself recursively if it&#39;s a directory</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; #+ and we&#39;re not nested too deep ($MAXRECURS).</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; # The recursion goes up: $((recurs+1))</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; # The prefix gets a space if it&#39;s the last entry,</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; #+ or a pipe if there are more entries.</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; # The minimum file/dirsize becomes</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; #+ a tenth of his parent: $((size/10)).</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; # Last argument is the full directory name to check.</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; if [ -d &quot;$name&quot; -a $recurs -lt $MAXRECURS ]; then</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [ $cnt -lt $num ] \</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; || (tree $((recurs+1)) &quot;$prefix &quot; $((size/10)) &quot;$name&quot;) \</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; (tree $((recurs+1)) &quot;$prefix |&quot; $((size/10)) &quot;$name&quot;)</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; fi</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; done</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; [ $? -eq 0 ] &amp;&amp; echo &quot; $prefix&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Every time we jump back add a &#39;blank&#39; line.</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; return $E_BL</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # We return 80 to tell we added a blank line already.</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">### ###</span></p><p class="c6"><span class="c1">### main program ###</span></p><p class="c6"><span class="c1">### ###</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">rootdir=&quot;$@&quot;</span></p><p class="c6"><span class="c1">[ -d &quot;$rootdir&quot; ] || {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; echo &quot;$SELF: Usage: $SELF &lt;directory&gt;&quot; &gt;&amp;2</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; exit $E_DIR</span></p><p class="c6"><span class="c1">}</span></p><p class="c6"><span class="c1"># We should be called with a directory name.</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">echo &quot;Building inventory list, please wait ...&quot;</span></p><p class="c6"><span class="c1"># Show &quot;please wait&quot; message.</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">du -akx &quot;$rootdir&quot; 1&gt;&quot;$TMP&quot; 2&gt;/dev/null</span></p><p class="c6"><span class="c1"># Build a temporary list of all files/dirs and their size.</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">size=`tail -1 &quot;$TMP&quot; | awk &#39;{print $1}&#39;`</span></p><p class="c6"><span class="c1"># What is our rootdirectory&#39;s size?</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">echo &quot;`dot $size` $rootdir&quot;</span></p><p class="c6"><span class="c1"># Display rootdirectory&#39;s entry.</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">tree 0 &quot;&quot; 0 &quot;$rootdir&quot;</span></p><p class="c6"><span class="c1"># Display the tree below our rootdirectory.</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">rm &quot;$TMP&quot; 2&gt;/dev/null</span></p><p class="c6"><span class="c1"># Clean up TMP file.</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">exit $?</span></p></td></tr></table><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 100.00px;"><img alt="" src="images/image24.png" style="width: 630.14px; height: 100.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c0"></span></p><p class="c204"><span class="c17">Noah Friedman permitted use of his </span><span class="c59 c52 c28">string function </span><span class="c17">script. It essentially reproduces </span><span class="c29 c52">&nbsp;some of the </span><span class="c59 c52">C</span><span class="c29 c52">-library string manipulation functions. </span></p><p class="c67 c93"><span class="c27">Example A-18. </span><span class="c59 c119 c28">string functions</span><span class="c27">: C-style string functions</span></p><p class="c67 c93"><span class="c17">This is a bash string manipulation library that replicates C&#39;s string.h functions in pure bash.</span></p><p class="c67 c93"><span class="c17">What it does:</span></p><ul class="c38 lst-kix_cij5eybiimv2-0 start"><li class="c40 li-bullet-0"><span class="c119 c28">String operations:</span><span class="c17">&nbsp;Concatenation (strcat, strncat), comparison (strcmp, strncmp), length (strlen)</span></li><li class="c40 li-bullet-0"><span class="c119 c28">Pattern matching:</span><span class="c17">&nbsp;Find characters (strspn, strcspn), substrings (strstr), truncation (strtrunc)</span></li><li class="c40 li-bullet-0"><span class="c119 c28">Advanced techniques:</span><span class="c17">&nbsp;Uses indirect variable expansion, parameter substitution, and pattern matching</span></li></ul><p class="c67"><span class="c17">Its core technique uses indirect variable expansion (${!var}) to manipulate variables by name, making it work like C functions that modify variables through pointers.</span></p><p class="c9"><span class="c1"></span></p><table class="c32"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c1">#!/bin/bash</span></p><p class="c6"><span class="c1"># string.bash --- bash emulation of string(3) library routines</span></p><p class="c6"><span class="c1"># Author: Noah Friedman &lt;friedman@prep.ai.mit.edu&gt;</span></p><p class="c6"><span class="c1"># ==&gt; Used with his kind permission in this document.</span></p><p class="c6"><span class="c1"># Created: 1992-07-01</span></p><p class="c6"><span class="c1"># Last modified: 1993-09-29</span></p><p class="c6"><span class="c1"># Public domain</span></p><p class="c6"><span class="c1"># Conversion to bash v2 syntax done by Chet Ramey</span></p><p class="c6"><span class="c1"># Commentary:</span></p><p class="c6"><span class="c1"># Code:</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">#:docstring strcat:</span></p><p class="c6"><span class="c1"># Usage: strcat s1 s2</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># Strcat appends the value of variable s2 to variable s1.</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># Example:</span></p><p class="c6"><span class="c1"># a=&quot;foo&quot;</span></p><p class="c6"><span class="c1"># b=&quot;bar&quot;</span></p><p class="c6"><span class="c1"># strcat a b</span></p><p class="c6"><span class="c1"># echo $a</span></p><p class="c6"><span class="c1"># =&gt; foobar</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1">#:end docstring:</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">###;;;autoload ==&gt; Autoloading of function commented out.</span></p><p class="c6"><span class="c1">function strcat() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local s1_val s2_val</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; s1_val=${!1} &nbsp;# indirect variable expansion</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; s2_val=${!2}</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; eval &quot;$1&quot;=\&#39;&quot;${s1_val}${s2_val}&quot;\&#39;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # ==&gt; eval $1=&#39;${s1_val}${s2_val}&#39; avoids problems,</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # ==&gt; if one of the variables contains a single quote.</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">#:docstring strncat:</span></p><p class="c6"><span class="c1"># Usage: strncat s1 s2 $n</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># Line strcat, but strncat appends a maximum of n characters from the value</span></p><p class="c6"><span class="c1"># of variable s2. It copies fewer if the value of variabl s2 is shorter</span></p><p class="c6"><span class="c1"># than n characters. Echoes result on stdout.</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># Example:</span></p><p class="c6"><span class="c1"># a=foo</span></p><p class="c6"><span class="c1"># b=barbaz</span></p><p class="c6"><span class="c1"># strncat a b 3</span></p><p class="c6"><span class="c1"># echo $a</span></p><p class="c6"><span class="c1"># =&gt; foobar</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1">#:end docstring:</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">###;;;autoload</span></p><p class="c6"><span class="c1">function strncat() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local s1=&quot;$1&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local s2=&quot;$2&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local -i n=&quot;$3&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local s1_val s2_val</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; s1_val=${!s1} &nbsp;# ==&gt; indirect variable expansion</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; s2_val=${!s2}</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; if [ ${#s2_val} -gt ${n} ]; then</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; s2_val=${s2_val:0:$n} &nbsp;# ==&gt; substring extraction</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; fi</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; eval &quot;$s1&quot;=\&#39;&quot;${s1_val}${s2_val}&quot;\&#39;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # ==&gt; eval $1=&#39;${s1_val}${s2_val}&#39; avoids problems,</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # ==&gt; if one of the variables contains a single quote.</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">#:docstring strcmp:</span></p><p class="c6"><span class="c1"># Usage: strcmp $s1 $s2</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># Strcmp compares its arguments and returns an integer less than, equal to,</span></p><p class="c6"><span class="c1"># or greater than zero, depending on whether string s1 is lexicographically</span></p><p class="c6"><span class="c1"># less than, equal to, or greater than string s2.</span></p><p class="c6"><span class="c1">#:end docstring:</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">###;;;autoload</span></p><p class="c6"><span class="c1">function strcmp() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; [ &quot;$1&quot; = &quot;$2&quot; ] &amp;&amp; return 0</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; [ &quot;${1}&quot; &#39;&lt;&#39; &quot;${2}&quot; ] &gt; /dev/null &amp;&amp; return -1</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; return 1</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">#:docstring strncmp:</span></p><p class="c6"><span class="c1"># Usage: strncmp $s1 $s2 $n</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># Like strcmp, but makes the comparison by examining a maximum of n</span></p><p class="c6"><span class="c1"># characters (n less than or equal to zero yields equality).</span></p><p class="c6"><span class="c1">#:end docstring:</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">###;;;autoload</span></p><p class="c6"><span class="c1">function strncmp() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; if [ -z &quot;${3}&quot; -o &quot;${3}&quot; -le &quot;0&quot; ]; then</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; return 0</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; fi</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; if [ ${3} -ge ${#1} -a ${3} -ge ${#2} ]; then</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; strcmp &quot;$1&quot; &quot;$2&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; return $?</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; else</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; s1=${1:0:$3}</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; s2=${2:0:$3}</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; strcmp $s1 $s2</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; return $?</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; fi</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">#:docstring strlen:</span></p><p class="c6"><span class="c1"># Usage: strlen s</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># Strlen returns the number of characters in string literal s.</span></p><p class="c6"><span class="c1">#:end docstring:</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">###;;;autoload</span></p><p class="c6"><span class="c1">function strlen() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; eval echo &quot;\${#${1}}&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # ==&gt; Returns the length of the value of the variable</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # ==&gt; whose name is passed as an argument.</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">#:docstring strspn:</span></p><p class="c6"><span class="c1"># Usage: strspn $s1 $s2</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># Strspn returns the length of the maximum initial segment of string s1,</span></p><p class="c6"><span class="c1"># which consists entirely of characters from string s2.</span></p><p class="c6"><span class="c1">#:end docstring:</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">###;;;autoload</span></p><p class="c6"><span class="c1">function strspn() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Unsetting IFS allows whitespace to be handled as normal chars.</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local IFS=</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local result=&quot;${1%%[!${2}]*}&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; echo ${#result}</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">#:docstring strcspn:</span></p><p class="c6"><span class="c1"># Usage: strcspn $s1 $s2</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># Strcspn returns the length of the maximum initial segment of string s1,</span></p><p class="c6"><span class="c1"># which consists entirely of characters not from string s2.</span></p><p class="c6"><span class="c1">#:end docstring:</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">###;;;autoload</span></p><p class="c6"><span class="c1">function strcspn() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Unsetting IFS allows whitspace to be handled as normal chars.</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local IFS=</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local result=&quot;${1%%[${2}]*}&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; echo ${#result}</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">#:docstring strstr:</span></p><p class="c6"><span class="c1"># Usage: strstr s1 s2</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># Strstr echoes a substring starting at the first occurrence of string s2 in</span></p><p class="c6"><span class="c1"># string s1, or nothing if s2 does not occur in the string. If s2 points to</span></p><p class="c6"><span class="c1"># a string of zero length, strstr echoes s1.</span></p><p class="c6"><span class="c1">#:end docstring:</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">###;;;autoload</span></p><p class="c6"><span class="c1">function strstr() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # if s2 points to a string of zero length, strstr echoes s1</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; [ ${#2} -eq 0 ] &amp;&amp; { echo &quot;$1&quot;; return 0; }</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # strstr echoes nothing if s2 does not occur in s1</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; case &quot;$1&quot; in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; *$2*) ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; *) return 1;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # use the pattern matching code to strip off the match and everything</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # following it</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; first=${1/$2*/}</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # then strip off the first unmatched portion of the string</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; echo &quot;${1##$first}&quot;</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">#:docstring strtok:</span></p><p class="c6"><span class="c1"># Usage: strtok s1 s2</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># Strtok considers the string s1 to consist of a sequence of zero or more</span></p><p class="c6"><span class="c1"># text tokens separated by spans of one or more characters from the</span></p><p class="c6"><span class="c1"># separator string s2. The first call (with a non-empty string s1</span></p><p class="c6"><span class="c1"># specified) echoes a string consisting of the first token on stdout. The</span></p><p class="c6"><span class="c1"># function keeps track of its position in the string s1 between separate</span></p><p class="c6"><span class="c1"># calls, so that subsequent calls made with the first argument an empty</span></p><p class="c6"><span class="c1"># string will work through the string immediately following that token. In</span></p><p class="c6"><span class="c1"># this way subsequent calls will work through the string s1 until no tokens</span></p><p class="c6"><span class="c1"># remain. The separator string s2 may be different from call to call.</span></p><p class="c6"><span class="c1"># When no token remains in s1, an empty value is echoed on stdout.</span></p><p class="c6"><span class="c1">#:end docstring:</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">###;;;autoload</span></p><p class="c6"><span class="c1">function strtok() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; :</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">#:docstring strtrunc:</span></p><p class="c6"><span class="c1"># Usage: strtrunc $n $s1 {$s2} {$...}</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># Used by many functions like strncmp to truncate arguments for comparison.</span></p><p class="c6"><span class="c1"># Echoes the first n characters of each string s1 s2 ... on stdout.</span></p><p class="c6"><span class="c1">#:end docstring:</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">###;;;autoload</span></p><p class="c6"><span class="c1">function strtrunc() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; n=$1; shift</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; for z; do</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; echo &quot;${z:0:$n}&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; done</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># provide string</span></p><p class="c6"><span class="c1"># string.bash ends here</span></p><p class="c6"><span class="c1"># ==========================================================================</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># ==&gt; Everything below here added by the document author.</span></p><p class="c6"><span class="c1"># ==&gt; Suggested use of this script is to delete everything below here,</span></p><p class="c6"><span class="c1"># ==&gt; and &quot;source&quot; this file into your own scripts.</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># strcat</span></p><p class="c6"><span class="c1">string0=one</span></p><p class="c6"><span class="c1">string1=two</span></p><p class="c6"><span class="c1">echo</span></p><p class="c6"><span class="c1">echo &quot;Testing \&quot;strcat\&quot; function:&quot;</span></p><p class="c6"><span class="c1">echo &quot;Original \&quot;string0\&quot; = $string0&quot;</span></p><p class="c6"><span class="c1">echo &quot;\&quot;string1\&quot; = $string1&quot;</span></p><p class="c6"><span class="c1">strcat string0 string1</span></p><p class="c6"><span class="c1">echo &quot;New \&quot;string0\&quot; = $string0&quot;</span></p><p class="c6"><span class="c1">echo</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># strlen</span></p><p class="c6"><span class="c1">echo</span></p><p class="c6"><span class="c1">echo &quot;Testing \&quot;strlen\&quot; function:&quot;</span></p><p class="c6"><span class="c1">str=123456789</span></p><p class="c6"><span class="c1">echo &quot;\&quot;str\&quot; = $str&quot;</span></p><p class="c6"><span class="c1">echo -n &quot;Length of \&quot;str\&quot; = &quot;</span></p><p class="c6"><span class="c1">strlen str</span></p><p class="c6"><span class="c1">echo</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Exercise:</span></p><p class="c6"><span class="c1"># --------</span></p><p class="c6"><span class="c1"># Add code to test all the other string functions above.</span></p><p class="c6"><span class="c1">exit 0</span></p></td></tr></table><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 196.00px;"><img alt="" src="images/image52.png" style="width: 630.14px; height: 196.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c0"></span></p><p class="c175"><span class="c17">Michael Zick&#39;s complex array example uses the </span><span class="c187 c52 c28">md5sum </span><span class="c17">check sum command to </span><span class="c29 c52">&nbsp;encode directory information. </span></p><p class="c67 c93"><span class="c27">Example A-19. Directory information</span></p><p class="c67"><span class="c29 c58 c28">This is a comprehensive directory analysis and file system information script that implements a content-based file identification system.</span></p><p class="c67"><span class="c29 c34 c28">Functions:</span></p><ul class="c38 lst-kix_bu6svid14rcv-0 start"><li class="c40 li-bullet-0"><span class="c34 c28">ListDirectory():</span><span class="c29 c58 c28">&nbsp;Gets detailed file listings using ls with inode, permissions, timestamps, etc.</span></li><li class="c40 li-bullet-0"><span class="c34 c28">IndexList():</span><span class="c29 c28 c58">&nbsp;Parses the directory listing and creates an index mapping for efficient access</span></li><li class="c40 li-bullet-0"><span class="c34 c28">DigestFile():</span><span class="c29 c58 c28">&nbsp;Generates MD5 checksums to identify files by content rather than name</span></li><li class="c40 li-bullet-0"><span class="c34 c28">LocateFile():</span><span class="c29 c58 c28">&nbsp;Extracts file location metadata using stat command</span></li><li class="c40 li-bullet-0"><span class="c34 c28">ListArray():</span><span class="c29 c58 c28">&nbsp;Utility function to display array contents in formatted output</span></li></ul><p class="c67"><span class="c29 c34 c28">Main Execution Flow:</span></p><ol class="c38 lst-kix_bqcb8qaq4vwy-0 start" start="1"><li class="c40 li-bullet-0"><span class="c29 c58 c28">Analyze current directory</span></li><li class="c40 li-bullet-0"><span class="c29 c58 c28">Generate directory checksum</span></li><li class="c40 li-bullet-0"><span class="c29 c58 c28">List directory contents</span></li><li class="c40 li-bullet-0"><span class="c29 c58 c28">Index the contents</span></li><li class="c40 li-bullet-0"><span class="c29 c58 c28">Generate content checksum</span></li><li class="c40 li-bullet-0"><span class="c29 c58 c28">Analyze file location</span></li></ol><p class="c67"><span class="c29 c58 c28">This script is designed for: removing duplicate files based on the content, directory structure analysis, file system forensics and file management.</span></p><p class="c9"><span class="c1"></span></p><table class="c32"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c1">#! /bin/bash</span></p><p class="c6"><span class="c1"># directory-info.sh</span></p><p class="c6"><span class="c1"># Parses and lists directory information.</span></p><p class="c6"><span class="c1"># NOTE: Change lines 273 and 353 per &quot;README&quot; file.</span></p><p class="c6"><span class="c1"># Michael Zick is the author of this script.</span></p><p class="c6"><span class="c1"># Used here with his permission.</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Controls</span></p><p class="c6"><span class="c1"># If overridden by command arguments, they must be in the order:</span></p><p class="c6"><span class="c1"># Arg1: &quot;Descriptor Directory&quot;</span></p><p class="c6"><span class="c1"># Arg2: &quot;Exclude Paths&quot;</span></p><p class="c6"><span class="c1"># Arg3: &quot;Exclude Directories&quot;</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># Environment Settings override Defaults.</span></p><p class="c6"><span class="c1"># Command arguments override Environment Settings.</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Default location for content addressed file descriptors.</span></p><p class="c6"><span class="c1">MD5UCFS=${1:-${MD5UCFS:-&#39;/tmpfs/ucfs&#39;}}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Directory paths never to list or enter</span></p><p class="c6"><span class="c1">declare -a \</span></p><p class="c6"><span class="c1">EXCLUDE_PATHS=${2:-${EXCLUDE_PATHS:-&#39;(/proc /dev /devfs /tmpfs)&#39;}}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Directories never to list or enter</span></p><p class="c6"><span class="c1">declare -a \</span></p><p class="c6"><span class="c1">EXCLUDE_DIRS=${3:-${EXCLUDE_DIRS:-&#39;(ucfs lost+found tmp wtmp)&#39;}}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Files never to list or enter</span></p><p class="c6"><span class="c1">declare -a \</span></p><p class="c6"><span class="c1">EXCLUDE_FILES=${3:-${EXCLUDE_FILES:-&#39;(core &quot;Name with Spaces&quot;)&#39;}}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Here document used as a comment block.</span></p><p class="c6"><span class="c1">: &lt;&lt;LSfieldsDoc</span></p><p class="c6"><span class="c1"># # # # # List Filesystem Directory Information # # # # #</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># ListDirectory &quot;FileGlob&quot; &quot;Field-Array-Name&quot;</span></p><p class="c6"><span class="c1"># or</span></p><p class="c6"><span class="c1"># ListDirectory -of &quot;FileGlob&quot; &quot;Field-Array-Filename&quot;</span></p><p class="c6"><span class="c1"># &#39;-of&#39; meaning &#39;output to filename&#39;</span></p><p class="c6"><span class="c1"># # # # #</span></p><p class="c6"><span class="c1">String format description based on: ls (GNU fileutils) version 4.0.36</span></p><p class="c6"><span class="c1">Produces a line (or more) formatted:</span></p><p class="c6"><span class="c1">inode permissions hard-links owner group ...</span></p><p class="c6"><span class="c1">32736 -rw------- 1 mszick mszick</span></p><p class="c6"><span class="c1">size day month date hh:mm:ss year path</span></p><p class="c6"><span class="c1">2756608 Sun Apr 20 08:53:06 2003 /home/mszick/core</span></p><p class="c6"><span class="c1">Unless it is formatted:</span></p><p class="c6"><span class="c1">inode permissions hard-links owner group ...</span></p><p class="c6"><span class="c1">266705 crw-rw---- 1 root uucp</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">major minor day month date hh:mm:ss year path</span></p><p class="c6"><span class="c1">4, 68 Sun Apr 20 09:27:33 2003 /dev/ttyS4</span></p><p class="c6"><span class="c1">NOTE: that pesky comma after the major number</span></p><p class="c6"><span class="c1">NOTE: the &#39;path&#39; may be multiple fields:</span></p><p class="c6"><span class="c1">/home/mszick/core</span></p><p class="c6"><span class="c1">/proc/982/fd/0 -&gt; /dev/null</span></p><p class="c6"><span class="c1">/proc/982/fd/1 -&gt; /home/mszick/.xsession-errors</span></p><p class="c6"><span class="c1">/proc/982/fd/13 -&gt; /tmp/tmpfZVVOCs (deleted)</span></p><p class="c6"><span class="c1">/proc/982/fd/7 -&gt; /tmp/kde-mszick/ksycoca</span></p><p class="c6"><span class="c1">/proc/982/fd/8 -&gt; socket:[11586]</span></p><p class="c6"><span class="c1">/proc/982/fd/9 -&gt; pipe:[11588]</span></p><p class="c6"><span class="c1">If that isn&#39;t enough to keep your parser guessing,</span></p><p class="c6"><span class="c1">either or both of the path components may be relative:</span></p><p class="c6"><span class="c1">../Built-Shared -&gt; Built-Static</span></p><p class="c6"><span class="c1">../linux-2.4.20.tar.bz2 -&gt; ../../../SRCS/linux-2.4.20.tar.bz2</span></p><p class="c6"><span class="c1">The first character of the 11 (10?) character permissions field:</span></p><p class="c6"><span class="c1">&#39;s&#39; Socket</span></p><p class="c6"><span class="c1">&#39;d&#39; Directory</span></p><p class="c6"><span class="c1">&#39;b&#39; Block device</span></p><p class="c6"><span class="c1">&#39;c&#39; Character device</span></p><p class="c6"><span class="c1">&#39;l&#39; Symbolic link</span></p><p class="c6"><span class="c1">NOTE: Hard links not marked - test for identical inode numbers</span></p><p class="c6"><span class="c1">on identical filesystems.</span></p><p class="c6"><span class="c1">All information about hard linked files are shared, except</span></p><p class="c6"><span class="c1">for the names and the name&#39;s location in the directory system.</span></p><p class="c6"><span class="c1">NOTE: A &quot;Hard link&quot; is known as a &quot;File Alias&quot; on some systems.</span></p><p class="c6"><span class="c1">&#39;-&#39; An undistingushed file</span></p><p class="c6"><span class="c1">Followed by three groups of letters for: User, Group, Others</span></p><p class="c6"><span class="c1">Character 1: &#39;-&#39; Not readable; &#39;r&#39; Readable</span></p><p class="c6"><span class="c1">Character 2: &#39;-&#39; Not writable; &#39;w&#39; Writable</span></p><p class="c6"><span class="c1">Character 3, User and Group: Combined execute and special</span></p><p class="c6"><span class="c1">&#39;-&#39; Not Executable, Not Special</span></p><p class="c6"><span class="c1">&#39;x&#39; Executable, Not Special</span></p><p class="c6"><span class="c1">&#39;s&#39; Executable, Special</span></p><p class="c6"><span class="c1">&#39;S&#39; Not Executable, Special</span></p><p class="c6"><span class="c1">Character 3, Others: Combined execute and sticky (tacky?)</span></p><p class="c6"><span class="c1">&#39;-&#39; Not Executable, Not Tacky</span></p><p class="c6"><span class="c1">&#39;x&#39; Executable, Not Tacky</span></p><p class="c6"><span class="c1">&#39;t&#39; Executable, Tacky</span></p><p class="c6"><span class="c1">&#39;T&#39; Not Executable, Tacky</span></p><p class="c6"><span class="c1">Followed by an access indicator</span></p><p class="c6"><span class="c1">Haven&#39;t tested this one, it may be the eleventh character</span></p><p class="c6"><span class="c1">or it may generate another field</span></p><p class="c6"><span class="c1">&#39; &#39; No alternate access</span></p><p class="c6"><span class="c1">&#39;+&#39; Alternate access</span></p><p class="c6"><span class="c1">LSfieldsDoc</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># This function lists the directory contents</span></p><p class="c6"><span class="c1">ListDirectory() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local -a T</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local -i of=0 # Default return in variable</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # OLD_IFS=$IFS # Using BASH default &#39; \t\n&#39;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; case &quot;$#&quot; in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 3) case &quot;$1&quot; in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -of) of=1 ; shift ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * ) return 1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; esac ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 2) : ;; # Poor man&#39;s &quot;continue&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; *) return 1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # NOTE: the (ls) command is NOT quoted (&quot;)</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; T=( $(ls --inode --ignore-backups --almost-all --directory \</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --full-time --color=none --time=status --sort=none \</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --format=long $1) )</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; case $of in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; # Assign T back to the array whose name was passed as $2</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 0) eval $2=\( \&quot;\$\{T\[@\]\}\&quot; \) ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; # Write T into filename passed as $2</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 1) echo &quot;${T[@]}&quot; &gt; &quot;$2&quot; ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; return 0</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># # # # # Is that string a legal number? # # # # #</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># IsNumber &quot;Var&quot;</span></p><p class="c6"><span class="c1"># # # # # There has to be a better way, sigh...</span></p><p class="c6"><span class="c1">#Fucntion to check if a string is a number</span></p><p class="c6"><span class="c1">IsNumber() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local -i int</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; if [ $# -eq 0 ]; then</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; return 1</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; else</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; (let int=$1) 2&gt;/dev/null</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; return $? # Exit status of the let thread</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; fi</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># # # # # Index Filesystem Directory Information # # # # #</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># IndexList &quot;Field-Array-Name&quot; &quot;Index-Array-Name&quot;</span></p><p class="c6"><span class="c1"># or</span></p><p class="c6"><span class="c1"># IndexList -if Field-Array-Filename Index-Array-Name</span></p><p class="c6"><span class="c1"># IndexList -of Field-Array-Name Index-Array-Filename</span></p><p class="c6"><span class="c1"># IndexList -if -of Field-Array-Filename Index-Array-Filename</span></p><p class="c6"><span class="c1"># # # # #</span></p><p class="c6"><span class="c1">: &lt;&lt;IndexListDoc</span></p><p class="c6"><span class="c1">Walk an array of directory fields produced by ListDirectory</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">Having suppressed the line breaks in an otherwise line oriented</span></p><p class="c6"><span class="c1">report, build an index to the array element which starts each line.</span></p><p class="c6"><span class="c1">Each line gets two index entries, the first element of each line</span></p><p class="c6"><span class="c1">(inode) and the element that holds the pathname of the file.</span></p><p class="c6"><span class="c1">The first index entry pair (Line-Number==0) are informational:</span></p><p class="c6"><span class="c1">Index-Array-Name[0] : Number of &quot;Lines&quot; indexed</span></p><p class="c6"><span class="c1">Index-Array-Name[1] : &quot;Current Line&quot; pointer into Index-Array-Name</span></p><p class="c6"><span class="c1">The following index pairs (if any) hold element indexes into</span></p><p class="c6"><span class="c1">the Field-Array-Name per:</span></p><p class="c6"><span class="c1">Index-Array-Name[Line-Number * 2] : The &quot;inode&quot; field element.</span></p><p class="c6"><span class="c1">NOTE: This distance may be either +11 or +12 elements.</span></p><p class="c6"><span class="c1">Index-Array-Name[(Line-Number * 2) + 1] : The &quot;pathname&quot; element.</span></p><p class="c6"><span class="c1">NOTE: This distance may be a variable number of elements.</span></p><p class="c6"><span class="c1">Next line index pair for Line-Number+1.</span></p><p class="c6"><span class="c1">IndexListDoc</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Function to index the directory information</span></p><p class="c6"><span class="c1">IndexList() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local -a LIST # Local of listname passed</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local -a -i INDEX=( 0 0 ) # Local of index to return</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local -i Lidx Lcnt</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local -i if=0 of=0 # Default to variable names</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; case &quot;$#&quot; in # Simplistic option testing</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 0) return 1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 1) return 1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 2) : ;; # Poor man&#39;s continue</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 3) case &quot;$1&quot; in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -if) if=1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -of) of=1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * ) return 1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; esac ; shift ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 4) if=1 ; of=1 ; shift ; shift ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; *) return 1</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Make local copy of list</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; case &quot;$if&quot; in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 0) eval LIST=\( \&quot;\$\{$1\[@\]\}\&quot; \) ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 1) LIST=( $(cat $1) ) ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Grok (grope?) the array</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; Lcnt=${#LIST[@]}</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; Lidx=0</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; until (( Lidx &gt;= Lcnt )); do</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; if IsNumber ${LIST[$Lidx]}; then</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; local -i inode name</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; local ft</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inode=Lidx</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; local m=${LIST[$Lidx+2]} # Hard Links field</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ft=${LIST[$Lidx+1]:0:1} # Fast-Stat</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case $ft in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b) ((Lidx+=12)) ;; # Block device</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c) ((Lidx+=12)) ;; # Character device</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *) ((Lidx+=11)) ;; # Anything else</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; name=Lidx</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case $ft in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -) ((Lidx+=1)) ;; # The easy one</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b) ((Lidx+=1)) ;; # Block device</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c) ((Lidx+=1)) ;; # Character device</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; d) ((Lidx+=1)) ;; # The other easy one</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; l) ((Lidx+=3)) ;; # At LEAST two more fields</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # A little more elegance here would handle pipes,</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #+ sockets, deleted files - later.</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *) until IsNumber ${LIST[$Lidx]} || ((Lidx &gt;= Lcnt)); do</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((Lidx+=1))</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; done</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;; # Not required</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INDEX[${#INDEX[*]}]=$inode</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INDEX[${#INDEX[*]}]=$name</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INDEX[0]=${INDEX[0]}+1 # One more &quot;line&quot; found</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # echo &quot;Line: ${INDEX[0]} Type: $ft Links: $m Inode: \</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # ${LIST[$inode]} Name: ${LIST[$name]}&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; else</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((Lidx+=1))</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; fi</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; done</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; case &quot;$of&quot; in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 0) eval $2=\( \&quot;\$\{INDEX\[@\]\}\&quot; \) ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 1) echo &quot;${INDEX[@]}&quot; &gt; &quot;$2&quot; ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; return 0 # What could go wrong?</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># # # # # Content Identify File # # # # #</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># DigestFile Input-Array-Name Digest-Array-Name</span></p><p class="c6"><span class="c1"># or</span></p><p class="c6"><span class="c1"># DigestFile -if Input-FileName Digest-Array-Name</span></p><p class="c6"><span class="c1"># # # # #</span></p><p class="c6"><span class="c1"># Here document used as a comment block.</span></p><p class="c6"><span class="c1">: &lt;&lt;DigestFilesDoc</span></p><p class="c6"><span class="c1">The key (no pun intended) to a Unified Content File System (UCFS)</span></p><p class="c6"><span class="c1">is to distinguish the files in the system based on their content.</span></p><p class="c6"><span class="c1">Distinguishing files by their name is just so 20th Century.</span></p><p class="c6"><span class="c1">The content is distinguished by computing a checksum of that content.</span></p><p class="c6"><span class="c1">This version uses the md5sum program to generate a 128 bit checksum</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">representative of the file&#39;s contents.</span></p><p class="c6"><span class="c1">There is a chance that two files having different content might</span></p><p class="c6"><span class="c1">generate the same checksum using md5sum (or any checksum). Should</span></p><p class="c6"><span class="c1">that become a problem, then the use of md5sum can be replace by a</span></p><p class="c6"><span class="c1">cyrptographic signature. But until then...</span></p><p class="c6"><span class="c1">The md5sum program is documented as outputting three fields (and it</span></p><p class="c6"><span class="c1">does), but when read it appears as two fields (array elements). This</span></p><p class="c6"><span class="c1">is caused by the lack of whitespace between the second and third field.</span></p><p class="c6"><span class="c1">So this function gropes the md5sum output and returns:</span></p><p class="c6"><span class="c1">[0] 32 character checksum in hexidecimal (UCFS filename)</span></p><p class="c6"><span class="c1">[1] Single character: &#39; &#39; text file, &#39;*&#39; binary file</span></p><p class="c6"><span class="c1">[2] Filesystem (20th Century Style) name</span></p><p class="c6"><span class="c1">Note: That name may be the character &#39;-&#39; indicating STDIN read.</span></p><p class="c6"><span class="c1">DigestFilesDoc</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Function that generates a cheksum for a file</span></p><p class="c6"><span class="c1">DigestFile() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local if=0 # Default, variable name</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local -a T1 T2</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; case &quot;$#&quot; in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 3) case &quot;$1&quot; in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -if) if=1 ; shift ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * ) return 1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; esac ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 2) : ;; # Poor man&#39;s &quot;continue&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; *) return 1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; case $if in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 0) eval T1=\( \&quot;\$\{$1\[@\]\}\&quot; \)</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;T2=( $(echo ${T1[@]} | md5sum -) )</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 1) T2=( $(md5sum $1) )</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; case ${#T2[@]} in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 0) return 1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 1) return 1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 2) case ${T2[1]:0:1} in # SanScrit-2.0.5</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \*) T2[${#T2[@]}]=${T2[1]:1}</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; T2[1]=\*</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *) T2[${#T2[@]}]=${T2[1]}</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;T2[1]=&quot; &quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 3) : ;; # Assume it worked</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; *) return 1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local -i len=${#T2[0]}</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; if [ $len -ne 32 ]; then return 1; fi</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; eval $2=\( \&quot;\$\{T2\[@\]\}\&quot; \)</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># # # # # Locate File # # # # #</span></p><p class="c6"><span class="c1">#</span></p><p class="c6"><span class="c1"># LocateFile [-l] FileName Location-Array-Name</span></p><p class="c6"><span class="c1"># or</span></p><p class="c6"><span class="c1"># LocateFile [-l] -of FileName Location-Array-FileName</span></p><p class="c6"><span class="c1"># # # # #</span></p><p class="c6"><span class="c1"># A file location is Filesystem-id and inode-number</span></p><p class="c6"><span class="c1"># Here document used as a comment block.</span></p><p class="c6"><span class="c1">: &lt;&lt;StatFieldsDoc</span></p><p class="c6"><span class="c1">Based on stat, version 2.2</span></p><p class="c6"><span class="c1">stat -t and stat -lt fields</span></p><p class="c6"><span class="c1">[0] name</span></p><p class="c6"><span class="c1">[1] Total size</span></p><p class="c6"><span class="c1">File - number of bytes</span></p><p class="c6"><span class="c1">Symbolic link - string length of pathname</span></p><p class="c6"><span class="c1">[2] Number of (512 byte) blocks allocated</span></p><p class="c6"><span class="c1">[3] File type and Access rights (hex)</span></p><p class="c6"><span class="c1">[4] User ID of owner</span></p><p class="c6"><span class="c1">[5] Group ID of owner</span></p><p class="c6"><span class="c1">[6] Device number</span></p><p class="c6"><span class="c1">[7] Inode number</span></p><p class="c6"><span class="c1">[8] Number of hard links</span></p><p class="c6"><span class="c1">[9] Device type (if inode device) Major</span></p><p class="c6"><span class="c1">[10] Device type (if inode device) Minor</span></p><p class="c6"><span class="c1">[11] Time of last access</span></p><p class="c6"><span class="c1">May be disabled in &#39;mount&#39; with noatime</span></p><p class="c6"><span class="c1">atime of files changed by exec, read, pipe, utime, mknod</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">(mmap?)</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">atime of directories changed by addition/deletion of files</span></p><p class="c6"><span class="c1">[12] Time of last modification</span></p><p class="c6"><span class="c1">mtime of files changed by write, truncate, utime, mknod</span></p><p class="c6"><span class="c1">mtime of directories changed by addtition/deletion of files</span></p><p class="c6"><span class="c1">[13] Time of last change</span></p><p class="c6"><span class="c1">ctime reflects time of changed inode information (owner,</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">group</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">permissions, link count</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">-*-*- Per:</span></p><p class="c6"><span class="c1">Return code: 0</span></p><p class="c6"><span class="c1">Size of array: 14</span></p><p class="c6"><span class="c1">Contents of array</span></p><p class="c6"><span class="c1">Element 0: /home/mszick</span></p><p class="c6"><span class="c1">Element 1: 4096</span></p><p class="c6"><span class="c1">Element 2: 8</span></p><p class="c6"><span class="c1">Element 3: 41e8</span></p><p class="c6"><span class="c1">Element 4: 500</span></p><p class="c6"><span class="c1">Element 5: 500</span></p><p class="c6"><span class="c1">Element 6: 303</span></p><p class="c6"><span class="c1">Element 7: 32385</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">Element 8: 22</span></p><p class="c6"><span class="c1">Element 9: 0</span></p><p class="c6"><span class="c1">Element 10: 0</span></p><p class="c6"><span class="c1">Element 11: 1051221030</span></p><p class="c6"><span class="c1">Element 12: 1051214068</span></p><p class="c6"><span class="c1">Element 13: 1051214068</span></p><p class="c6"><span class="c1">For a link in the form of linkname -&gt; realname</span></p><p class="c6"><span class="c1">stat -t linkname returns the linkname (link) information</span></p><p class="c6"><span class="c1">stat -lt linkname returns the realname information</span></p><p class="c6"><span class="c1">stat -tf and stat -ltf fields</span></p><p class="c6"><span class="c1">[0] name</span></p><p class="c6"><span class="c1">[1] ID-0? # Maybe someday, but Linux stat structure</span></p><p class="c6"><span class="c1">[2] ID-0? # does not have either LABEL nor UUID</span></p><p class="c6"><span class="c1"># fields, currently information must come</span></p><p class="c6"><span class="c1"># from file-system specific utilities</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">These will be munged into:</span></p><p class="c6"><span class="c1">[1] UUID if possible</span></p><p class="c6"><span class="c1">[2] Volume Label if possible</span></p><p class="c6"><span class="c1">Note: &#39;mount -l&#39; does return the label and could return the UUID</span></p><p class="c6"><span class="c1">[3] Maximum length of filenames</span></p><p class="c6"><span class="c1">[4] Filesystem type</span></p><p class="c6"><span class="c1">[5] Total blocks in the filesystem</span></p><p class="c6"><span class="c1">[6] Free blocks</span></p><p class="c6"><span class="c1">[7] Free blocks for non-root user(s)</span></p><p class="c6"><span class="c1">[8] Block size of the filesystem</span></p><p class="c6"><span class="c1">[9] Total inodes</span></p><p class="c6"><span class="c1">[10] Free inodes</span></p><p class="c6"><span class="c1">-*-*- Per:</span></p><p class="c6"><span class="c1">Return code: 0</span></p><p class="c6"><span class="c1">Size of array: 11</span></p><p class="c6"><span class="c1">Contents of array</span></p><p class="c6"><span class="c1">Element 0: /home/mszick</span></p><p class="c6"><span class="c1">Element 1: 0</span></p><p class="c6"><span class="c1">Element 2: 0</span></p><p class="c6"><span class="c1">Element 3: 255</span></p><p class="c6"><span class="c1">Element 4: ef53</span></p><p class="c6"><span class="c1">Element 5: 2581445</span></p><p class="c6"><span class="c1">Element 6: 2277180</span></p><p class="c6"><span class="c1">Element 7: 2146050</span></p><p class="c6"><span class="c1">Element 8: 4096</span></p><p class="c6"><span class="c1">Element 9: 1311552</span></p><p class="c6"><span class="c1">Element 10: 1276425</span></p><p class="c6"><span class="c1">StatFieldsDoc</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># LocateFile [-l] FileName Location-Array-Name</span></p><p class="c6"><span class="c1"># LocateFile [-l] -of FileName Location-Array-FileName</span></p><p class="c6"><span class="c1"># Function that locaets a file</span></p><p class="c6"><span class="c1">LocateFile() {</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local -a LOC LOC1 LOC2</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local lk=&quot;&quot; of=0</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; case &quot;$#&quot; in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 0) return 1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 1) return 1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 2) : ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; *) while (( &quot;$#&quot; &gt; 2 )); do</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case &quot;$1&quot; in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -l) lk=-1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -of) of=1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *) return 1 ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shift</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; done ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # More Sanscrit-2.0.5</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # LOC1=( $(stat -t $lk $1) )</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # LOC2=( $(stat -tf $lk $1) )</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Uncomment above two lines if system has &quot;stat&quot; command installed.</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; LOC=( ${LOC1[@]:0:1} ${LOC1[@]:3:11}</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ${LOC2[@]:1:2} ${LOC2[@]:4:1} )</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c1">&nbsp; &nbsp; case &quot;$of&quot; in</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 0) eval $2=\( \&quot;\$\{LOC\[@\]\}\&quot; \) ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; 1) echo &quot;${LOC[@]}&quot; &gt; &quot;$2&quot; ;;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; esac</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; return 0</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Which yields (if you are lucky, and have &quot;stat&quot; installed)</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # -*-*- Location Discriptor -*-*-</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Return code: 0</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Size of array: 15</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Contents of array</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 0: /home/mszick 20th Century name</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 1: 41e8 Type and Permissions</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 2: 500 User</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 3: 500 Group</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 4: 303 Device</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 5: 32385 inode</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 6: 22 Link count</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 7: 0 Device Major</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 8: 0 Device Minor</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 9: 1051224608 Last Access</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 10: 1051214068 Last Modify</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 11: 1051214068 Last Status</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 12: 0 UUID (to be)</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 13: 0 Volume Label (to be)</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; # Element 14: ef53 Filesystem type</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># And then there was some test code</span></p><p class="c6"><span class="c1"># This function lists the contents of an array</span></p><p class="c6"><span class="c1">ListArray() { # ListArray Name</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; local -a Ta</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; eval Ta=\( \&quot;\$\{$1\[@\]\}\&quot; \)</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; echo</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; echo &quot;-*-*- List of Array -*-*-&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; echo &quot;Size of array $1: ${#Ta[*]}&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; echo &quot;Contents of array $1:&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; for (( i=0 ; i&lt;${#Ta[*]} ; i++ )); do</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; echo -e &quot;\tElement $i: ${Ta[$i]}&quot;</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; done</span></p><p class="c6"><span class="c1">&nbsp; &nbsp; return 0</span></p><p class="c6"><span class="c1">}</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Declare and list the directory</span></p><p class="c6"><span class="c1">declare -a CUR_DIR</span></p><p class="c6"><span class="c1"># For small arrays</span></p><p class="c6"><span class="c1">ListDirectory &quot;${PWD}&quot; CUR_DIR</span></p><p class="c6"><span class="c1">ListArray CUR_DIR</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Generate the checksum of the directory</span></p><p class="c6"><span class="c1">declare -a DIR_DIG</span></p><p class="c6"><span class="c1">DigestFile CUR_DIR DIR_DIG</span></p><p class="c6"><span class="c1">echo &quot;The new \&quot;name\&quot; (checksum) for ${CUR_DIR[9]} is ${DIR_DIG[0]}&quot;</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># List the contents of the directory</span></p><p class="c6"><span class="c1">declare -a DIR_ENT</span></p><p class="c6"><span class="c1"># BIG_DIR # For really big arrays - use a temporary file in ramdisk</span></p><p class="c6"><span class="c1"># BIG-DIR # ListDirectory -of &quot;${CUR_DIR[11]}/*&quot; &quot;/tmpfs/junk2&quot;</span></p><p class="c6"><span class="c1">ListDirectory &quot;${CUR_DIR[11]}/*&quot; DIR_ENT</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Index the directory contents</span></p><p class="c6"><span class="c1">declare -a DIR_IDX</span></p><p class="c6"><span class="c1"># BIG-DIR # IndexList -if &quot;/tmpfs/junk2&quot; DIR_IDX</span></p><p class="c6"><span class="c1">IndexList DIR_ENT DIR_IDX</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Generate the checksum of the directory contents</span></p><p class="c6"><span class="c1">declare -a IDX_DIG</span></p><p class="c6"><span class="c1"># BIG-DIR # DIR_ENT=( $(cat /tmpfs/junk2) )</span></p><p class="c6"><span class="c1"># BIG-DIR # DigestFile -if /tmpfs/junk2 IDX_DIG</span></p><p class="c6"><span class="c1">DigestFile DIR_ENT IDX_DIG</span></p><p class="c6"><span class="c1"># Small (should) be able to parallize IndexList &amp; DigestFile</span></p><p class="c6"><span class="c1"># Large (should) be able to parallize IndexList &amp; DigestFile &amp; the assignment</span></p><p class="c6"><span class="c1">echo &quot;The \&quot;name\&quot; (checksum) for the contents of ${PWD} is ${IDX_DIG[0]}&quot;</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1"># Locate the file and list the details of the file</span></p><p class="c6"><span class="c1">declare -a FILE_LOC</span></p><p class="c6"><span class="c1">LocateFile ${PWD} FILE_LOC</span></p><p class="c6"><span class="c1">ListArray FILE_LOC</span></p><p class="c6 c16"><span class="c1"></span></p><p class="c6"><span class="c1">exit 0</span></p></td></tr></table><p class="c9"><span class="c1"></span></p><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 273.33px;"><img alt="" src="images/image38.png" style="width: 630.14px; height: 273.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c80"><span class="c29 c52">St&eacute;phane Chazelas demonstrates object-oriented programming in a Bash script. Mariusz Gniazdowski contributed a </span><span class="c187 c52">hash </span><span class="c29 c52">library for use in scripts. </span><span class="c27">Example A-20. Library of hash functions</span></p><p class="c80"><span class="c29 c58 c28">This is a bash hash table (associative array) library that emulates hash/dictionary functionality in bash using global variables. It creates hash tables by generating global variables with naming pattern: __hash__hashname_keyname. It also provides hash-like operations similar to other programming languages.</span></p><p class="c80"><span class="c29 c34 c28">Main Functions:</span></p><ul class="c38 lst-kix_ewh8jws4d7aj-0 start"><li class="c101 c92 li-bullet-0"><span class="c34 c28">hash_set:</span><span class="c29 c58 c28">&nbsp;Sets a key-value pair (hash[key] = value)</span></li><li class="c101 c92 li-bullet-0"><span class="c34 c28">hash_get_into:</span><span class="c29 c58 c28">&nbsp;Gets a value and stores it in a variable</span></li><li class="c101 c92 li-bullet-0"><span class="c34 c28">hash_echo:</span><span class="c29 c58 c28">&nbsp;Prints a hash value directly</span></li><li class="c101 c92 li-bullet-0"><span class="c34 c28">hash_copy:</span><span class="c29 c58 c28">&nbsp;Copies value from one hash key to another</span></li><li class="c101 c92 li-bullet-0"><span class="c28 c34">hash_dup:</span><span class="c29 c58 c28">&nbsp;Duplicates a value to multiple keys</span></li><li class="c101 c92 li-bullet-0"><span class="c34 c28">hash_unset:</span><span class="c29 c58 c28">&nbsp;Deletes a hash key</span></li><li class="c101 c92 li-bullet-0"><span class="c34 c28">hash_get_ref_into:</span><span class="c29 c58 c28">&nbsp;Gets the variable name that holds the value</span></li><li class="c101 c92 li-bullet-0"><span class="c34 c28">hash_echo_ref:</span><span class="c29 c58 c28">&nbsp;Prints the variable name</span></li><li class="c92 c101 li-bullet-0"><span class="c34 c28">hash_call:</span><span class="c29 c58 c28">&nbsp;Executes a function stored in a hash value</span></li><li class="c101 c92 li-bullet-0"><span class="c34 c28">hash_is_set:</span><span class="c29 c58 c28">&nbsp;Checks if a key exists</span></li><li class="c101 c92 li-bullet-0"><span class="c34 c28">hash_foreach:</span><span class="c29 c58 c28">&nbsp;Iterates over all keys and calls a function for each</span></li></ul><p class="c101 c16"><span class="c29 c58 c28"></span></p><p class="c80"><span class="c29 c34 c28">Hash function code:</span></p><table class="c93 c110"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c18">#!/bin/bash</span></p><p class="c6"><span class="c18"># Hash:</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># Hash function library</span></p><p class="c6"><span class="c18"># Author: Mariusz Gniazdowski &lt;mariusz.gn-at-gmail.com&gt;</span></p><p class="c6"><span class="c18"># Date: 2005-04-07</span></p><p class="c6"><span class="c18"># Functions making emulating hashes in Bash a little less painful.</span></p><p class="c6"><span class="c18"># Limitations:</span></p><p class="c6"><span class="c18"># * Only global variables are supported.</span></p><p class="c6"><span class="c18"># * Each hash instance generates one global variable per value.</span></p><p class="c6"><span class="c18"># * Variable names collisions are possible</span></p><p class="c6"><span class="c18">#+ if you define variable like __hash__hashname_key</span></p><p class="c6"><span class="c18"># * Keys must use chars that can be part of a Bash variable name</span></p><p class="c6"><span class="c18">#+ (no dashes, periods, etc.).</span></p><p class="c6"><span class="c18"># * The hash is created as a variable:</span></p><p class="c6"><span class="c18"># ... hashname_keyname</span></p><p class="c6"><span class="c18"># So if somone will create hashes like:</span></p><p class="c6"><span class="c18"># myhash_ + mykey = myhash__mykey</span></p><p class="c6"><span class="c18"># myhash + _mykey = myhash__mykey</span></p><p class="c6"><span class="c18"># Then there will be a collision.</span></p><p class="c6"><span class="c18"># (This should not pose a major problem.)</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">Hash_config_varname_prefix=__hash__</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># Emulates: hash[key]=value</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># Params:</span></p><p class="c6"><span class="c18"># 1 - hash</span></p><p class="c6"><span class="c18"># 2 - key</span></p><p class="c6"><span class="c18"># 3 - value</span></p><p class="c6"><span class="c18"># Sets a global variable with name: __hash__hashname_keyname</span></p><p class="c6"><span class="c18">function hash_set {</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; eval &quot;${Hash_config_varname_prefix}${1}_${2}=\&quot;${3}\&quot;&quot;</span></p><p class="c6"><span class="c18">}</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># Emulates: value=hash[key]</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># Params:</span></p><p class="c6"><span class="c18"># 1 - hash</span></p><p class="c6"><span class="c18"># 2 - key</span></p><p class="c6"><span class="c18"># 3 - value (name of global variable to set)</span></p><p class="c6"><span class="c18"># The function gets the value of the variable and assigns it </span></p><p class="c6"><span class="c18"># to the provided variable name.</span></p><p class="c6"><span class="c18">function hash_get_into {</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; eval &quot;$3=\&quot;\$${Hash_config_varname_prefix}${1}_${2}\&quot;&quot;</span></p><p class="c6"><span class="c18">}</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># Emulates: echo hash[key]</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># Params:</span></p><p class="c6"><span class="c18"># 1 - hash</span></p><p class="c6"><span class="c18"># 2 - key</span></p><p class="c6"><span class="c18"># 3 - echo params (like -n, for example)</span></p><p class="c6"><span class="c18"># This functuon simply prints the value</span></p><p class="c6"><span class="c18">function hash_echo {</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; eval &quot;echo $3 \&quot;\$${Hash_config_varname_prefix}${1}_${2}\&quot;&quot;</span></p><p class="c6"><span class="c18">}</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># Emulates: hash1[key1]=hash2[key2]</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># Params:</span></p><p class="c6"><span class="c18"># 1 - hash1</span></p><p class="c6"><span class="c18"># 2 - key1</span></p><p class="c6"><span class="c18"># 3 - hash2</span></p><p class="c6"><span class="c18"># 4 - key2</span></p><p class="c6"><span class="c18"># This function copies the value from one hash to another.</span></p><p class="c6"><span class="c18">function hash_copy {</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; eval &quot;${Hash_config_varname_prefix}${1}_${2}\</span></p><p class="c6"><span class="c18">=\&quot;\$${Hash_config_varname_prefix}${3}_${4}\&quot;&quot;</span></p><p class="c6"><span class="c18">}</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># Emulates: hash[keyN-1]=hash[key2]=...hash[key1]</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># Copies first key to rest of keys.</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># Params:</span></p><p class="c6"><span class="c18"># 1 - hash1</span></p><p class="c6"><span class="c18"># 2 - key1</span></p><p class="c6"><span class="c18"># 3 - key2</span></p><p class="c6"><span class="c18"># . . .</span></p><p class="c6"><span class="c18"># N - keyN</span></p><p class="c6"><span class="c18"># This function copies the value from first key to all other keys.</span></p><p class="c6"><span class="c18">function hash_dup {</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; local hashName=&quot;$1&quot; keyName=&quot;$2&quot;</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; shift 2</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; until [ ${#} -le 0 ]; do</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; eval &quot;${Hash_config_varname_prefix}${hashName}_${1}\</span></p><p class="c6"><span class="c18">=\&quot;\$${Hash_config_varname_prefix}${hashName}_${keyName}\&quot;&quot;</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; shift;</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; done;</span></p><p class="c6"><span class="c18">}</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># Emulates: unset hash[key]</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># Params:</span></p><p class="c6"><span class="c18"># 1 - hash</span></p><p class="c6"><span class="c18"># 2 - key</span></p><p class="c6"><span class="c18"># This function deletes the variable that holds the hash key.</span></p><p class="c6"><span class="c18">function hash_unset {</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; eval &quot;unset ${Hash_config_varname_prefix}${1}_${2}&quot;</span></p><p class="c6"><span class="c18">}</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># Emulates something similar to: ref=&amp;hash[key]</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># The reference is name of the variable in which value is held.</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># Params:</span></p><p class="c6"><span class="c18"># 1 - hash</span></p><p class="c6"><span class="c18"># 2 - key</span></p><p class="c6"><span class="c18"># 3 - ref - Name of global variable to set.</span></p><p class="c6"><span class="c18"># THis function sets the name of the variable that holds the hash key</span></p><p class="c6"><span class="c18">function hash_get_ref_into {</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; eval &quot;$3=\&quot;${Hash_config_varname_prefix}${1}_${2}\&quot;&quot;</span></p><p class="c6"><span class="c18">}</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># Emulates something similar to: echo &amp;hash[key]</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># That reference is name of variable in which value is held.</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># Params:</span></p><p class="c6"><span class="c18"># 1 - hash</span></p><p class="c6"><span class="c18"># 2 - key</span></p><p class="c6"><span class="c18"># 3 - echo params (like -n for example)</span></p><p class="c6"><span class="c18"># This function prints the name of the variable that holds the hash key.</span></p><p class="c6"><span class="c18">function hash_echo_ref {</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; eval &quot;echo $3 \&quot;${Hash_config_varname_prefix}${1}_${2}\&quot;&quot;</span></p><p class="c6"><span class="c18">}</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># Emulates something similar to: $$hash[key](param1, param2, ...)</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># Params:</span></p><p class="c6"><span class="c18"># 1 - hash</span></p><p class="c6"><span class="c18"># 2 - key</span></p><p class="c6"><span class="c18"># 3,4, ... - Function parameters</span></p><p class="c6"><span class="c18"># It calls the function that is stored in the hash key and</span></p><p class="c6"><span class="c18"># passes the parameters to it.</span></p><p class="c6"><span class="c18">function hash_call {</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; local hash key</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; hash=$1</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; key=$2</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; shift 2</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; eval &quot;eval \&quot;\$${Hash_config_varname_prefix}${hash}_${key} \\\&quot;\\\$@\\\&quot;\&quot;&quot;</span></p><p class="c6"><span class="c18">}</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># Emulates something similar to: isset(hash[key]) or hash[key]==NULL</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># Params:</span></p><p class="c6"><span class="c18"># 1 - hash</span></p><p class="c6"><span class="c18"># 2 - key</span></p><p class="c6"><span class="c18"># Returns:</span></p><p class="c6"><span class="c18"># 0 - there is such key</span></p><p class="c6"><span class="c18"># 1 - there is no such key</span></p><p class="c6"><span class="c18"># Checks if the hash key is set.</span></p><p class="c6"><span class="c18">function hash_is_set {</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; eval &quot;if [[ \&quot;\${${Hash_config_varname_prefix}${1}_${2}-a}\&quot; = \&quot;a\&quot; &amp;&amp;</span></p><p class="c6"><span class="c18">\&quot;\${${Hash_config_varname_prefix}${1}_${2}-b}\&quot; = \&quot;b\&quot; ]]</span></p><p class="c6"><span class="c18">then return 1; else return 0; fi&quot;</span></p><p class="c6"><span class="c18">}</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># Emulates something similar to:</span></p><p class="c6"><span class="c18"># foreach($hash as $key =&gt; $value) { fun($key,$value); }</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># It is possible to write different variations of this function.</span></p><p class="c6"><span class="c18"># Here we use a function call to make it as &quot;generic&quot; as possible.</span></p><p class="c6"><span class="c18">#</span></p><p class="c6"><span class="c18"># Params:</span></p><p class="c6"><span class="c18"># 1 - hash</span></p><p class="c6"><span class="c18"># 2 - function name</span></p><p class="c6"><span class="c18"># This function iterates over all keys in the hash and calls</span></p><p class="c6"><span class="c18"># the provided function with two parameters: key and value.</span></p><p class="c6"><span class="c18">function hash_foreach {</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; local keyname oldIFS=&quot;$IFS&quot;</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; IFS=&#39; &#39;</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; for i in $(eval &quot;echo \${!${Hash_config_varname_prefix}${1}_*}&quot;); do</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; keyname=$(eval &quot;echo \${i##${Hash_config_varname_prefix}${1}_}&quot;)</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; &nbsp; &nbsp; eval &quot;$2 $keyname \&quot;\$$i\&quot;&quot;</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; done</span></p><p class="c6"><span class="c18">&nbsp; &nbsp; IFS=&quot;$oldIFS&quot;</span></p><p class="c6"><span class="c18">}</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># NOTE: In lines 103 and 116, ampersand changed.</span></p><p class="c6"><span class="c18"># But, it doesn&#39;t matter, because these are comment lines anyhow</span></p></td></tr></table><p class="c80"><span class="c27">Test hash function script:</span></p><table class="c110 c93"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c18">#!/bin/bash</span></p><p class="c6"><span class="c18"># Source the hash library</span></p><p class="c6"><span class="c18">source /home/enkel/final-project/Part1/RunningAndAnalyzingScripts/A20/A20.sh</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18"># Your test commands</span></p><p class="c6"><span class="c18">hash_set myhash mykey &quot;myvalue&quot;</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">hash_get_into myhash mykey result</span></p><p class="c6"><span class="c18">echo $result</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">hash_echo myhash mykey</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">hash_set myhash mykey1 &quot;myvalue1&quot;</span></p><p class="c6"><span class="c18">hash_set otherhash otherkey1 &quot;othervalue1&quot;</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">hash_copy myhash mykey1 otherhash otherkey1</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">hash_set myhash mykey2 &quot;myvalue2&quot;</span></p><p class="c6"><span class="c18">hash_set myhash mykey3 &quot;myvalue3&quot;</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">hash_dup myhash mykey1 mykey2 mykey3</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">hash_unset myhash mykey</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">hash_get_ref_into myhash mykey1 ref</span></p><p class="c6"><span class="c18">echo $ref</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">hash_echo_ref myhash mykey1</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">hash_set myhash myfunc &quot;echo Testing hash&quot;</span></p><p class="c6"><span class="c18">hash_call myhash myfunc</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">hash_is_set myhash mykey1 &amp;&amp; echo &quot;Key is set&quot; || echo &quot;Key is not set&quot;</span></p><p class="c6 c16"><span class="c18"></span></p><p class="c6"><span class="c18">myfunction() { echo &quot;$1 = $2&quot;; }</span></p><p class="c6"><span class="c18">hash_foreach myhash myfunction</span></p></td></tr></table><p class="c80 c16"><span class="c17"></span></p><p class="c101 c93"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 177.33px;"><img alt="" src="images/image1.png" style="width: 630.14px; height: 177.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c0"></span></p><p class="c6 c196"><span class="c29 c76">2) Analyzing Scripts </span></p><p class="c135"><span class="c29 c57 c28">Provide, in the same way as above a complete analysis examining the following scripts. </span></p><p class="c154"><span class="c29 c57 c28">a) Run the following script, then explain what it does. Annotate the script and rewrite it in a more </span><span class="c29 c57">&nbsp;</span><span class="c29 c57 c28">compact and elegant manner.</span></p><table class="c32"><tr class="c202"><td class="c115" colspan="1" rowspan="1"><p class="c6 c132"><span class="c41 c29">#!/bin/bash </span></p><p class="c146 c7"><span class="c41 c29">MAX=10000 </span></p><p class="c94 c176"><span class="c41 c29">&nbsp;for((nr=1; nr&lt;$MAX; nr++)) </span></p><p class="c97 c94"><span class="c41 c29">&nbsp;do </span></p><p class="c35"><span class="c41 c29">&nbsp;let &quot;t1 = nr % 5&quot; </span></p><p class="c94 c97"><span class="c41 c29">&nbsp;if [ &quot;$t1&quot; -ne 3 ] </span></p><p class="c97 c94"><span class="c41 c29">&nbsp;then </span></p><p class="c97 c94"><span class="c41 c29">&nbsp;continue </span></p><p class="c157 c94"><span class="c41 c29">&nbsp;fi </span></p><p class="c35"><span class="c41 c29">&nbsp;let &quot;t2 = nr % 7&quot; </span></p><p class="c97 c94"><span class="c41 c29">&nbsp;if [ &quot;$t2&quot; -ne 4 ] </span></p><p class="c97 c94"><span class="c41 c29">&nbsp;then </span></p><p class="c97 c94"><span class="c41 c29">&nbsp;continue </span></p><p class="c97 c94"><span class="c41 c29">&nbsp;fi </span></p><p class="c35"><span class="c41 c29">&nbsp;let &quot;t3 = nr % 9&quot; </span></p><p class="c97 c94"><span class="c41 c29">&nbsp;if [ &quot;$t3&quot; -ne 5 ] </span></p><p class="c157 c94"><span class="c41 c29">&nbsp;then </span></p><p class="c97 c94"><span class="c41 c29">&nbsp;continue </span></p><p class="c97 c94"><span class="c41 c29">&nbsp;fi </span></p><p class="c35"><span class="c41 c29">&nbsp;break # What happens when you comment out this line? Why?</span></p><p class="c35 c16"><span class="c41 c29"></span></p><p class="c6 c94"><span class="c41 c29">&nbsp;done </span></p><p class="c94 c146"><span class="c41 c29">&nbsp;echo &quot;Number = $nr&quot; </span></p><p class="c149"><span class="c41 c29">exit 0</span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c21"><span class="c29 c65">This script searches for the first number meeting specific mathematical conditions:</span></p><ul class="c38 lst-kix_7ye12kprvif2-0 start"><li class="c21 c92 li-bullet-0"><span class="c29 c65">nr % 5 = 3 (remainder 3 when divided by 5)</span></li><li class="c21 c92 li-bullet-0"><span class="c29 c65">nr % 7 = 4 (remainder 4 when divided by 7)</span></li><li class="c21 c92 li-bullet-0"><span class="c29 c65">nr % 9 = 5 (remainder 5 when divided by 9)</span></li></ul><p class="c21"><span class="c29 c65">If we remove the break line, the code will not stop when it finds the first number that meets the conditions, but will continue to iterate until the end, and will print the last number that meets the conditions(10&rsquo;000).</span></p><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 78.67px;"><img alt="" src="images/image3.png" style="width: 630.14px; height: 78.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c29 c65"></span></p><p class="c21"><span class="c29 c33">The improved version of the code:</span></p><p class="c9"><span class="c29 c33"></span></p><table class="c32"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c5">#!/bin/bash</span></p><p class="c6"><span class="c5"># Find the first number from 1 to 10&#39;000 that satisfies the conditions:</span></p><p class="c6"><span class="c5"># - When divided by 5, the remainder is 3</span></p><p class="c6"><span class="c5"># - When divided by 7, the remainder is 4</span></p><p class="c6"><span class="c5"># - When divided by 9, the remainder is 5</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">for nr in {1..10000}; do &nbsp;# Loop thought numbers from 1 to 10,000</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; # Check if the number satisfies the conditions</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; if (( nr%5==3 &amp;&amp; nr%7==4 &amp;&amp; nr%9==5 )); then</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; echo &quot;Number = $nr&quot; #if the conditions are met, print the number</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; exit 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# and exit the script successfully</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; fi</span></p><p class="c6"><span class="c5">done</span></p></td></tr></table><p class="c9"><span class="c29 c33"></span></p><p class="c6 c55"><span class="c29 c57 c28">--- </span></p><p class="c99"><span class="c29 c57 c28">b) Explain what the following script does. It is really just a parameterized command-line pipe. </span></p><table class="c32"><tr class="c210"><td class="c115" colspan="1" rowspan="1"><p class="c53"><span class="c5 c61">#!/bin/bash </span></p><p class="c53"><span class="c5 c61">DIRNAME=/usr/bin </span></p><p class="c53"><span class="c5 c61">FILETYPE=&quot;shell script&quot; </span></p><p class="c53"><span class="c5 c61">LOGFILE=logfile </span></p><p class="c53"><span class="c5 c61"># Uses the file command to find the type of every file in the bin</span></p><p class="c53"><span class="c5 c61"># fgrep filters the results to show only shell scripts</span></p><p class="c53"><span class="c5 c61"># Then it uses tee to write the result to logfile</span></p><p class="c53"><span class="c5 c61"># It uses wc -l to count the number of lines in the output and</span></p><p class="c53"><span class="c5 c61"># prints it to the terminal</span></p><p class="c53"><span class="c5 c61">file &quot;$DIRNAME&quot;/* | fgrep &quot;$FILETYPE&quot; | tee $LOGFILE | wc -l </span></p><p class="c53"><span class="c5 c61">exit 0</span></p><p class="c53 c16"><span class="c29 c41"></span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c21"><span class="c29 c65">This code is a shell script analyzer that scans bin directory to find and count shell scripts. It goes through every file in the bin directory and filters out the files that aren&rsquo;t shell scripts. It then prints all of the shell scripts to a new file named logfile and prints to the terminal the number of files.</span></p><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 413.55px; height: 389.23px;"><img alt="" src="images/image9.png" style="width: 413.55px; height: 389.23px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 c55"><span class="c29 c57 c28">--- </span></p><p class="c165"><span class="c29 c57 c28">c) Examine and explain the following script. For hints, you might refer to the listings &nbsp;for </span><span class="c14 c28">find</span><span class="c133 c57 c28">&nbsp;</span><span class="c29 c57 c28">and </span><span class="c14 c28">stat</span><span class="c29 c57 c28">. </span></p><table class="c32"><tr class="c172"><td class="c115" colspan="1" rowspan="1"><p class="c24"><span class="c41 c29">#!/bin/bash </span></p><p class="c24"><span class="c41 c29"># Author: Nathan Coulter </span></p><p class="c24"><span class="c41 c29"># This code is released to the public domain. </span></p><p class="c24"><span class="c41 c29"># The author gave permission to use this code snippet in the ABS Guide. </span></p><p class="c24"><span class="c41 c29"># Finds all the files in the current directory and prints their names</span></p><p class="c24"><span class="c41 c29">find -maxdepth 1 -type f -printf &#39;%f\000&#39; | {</span></p><p class="c24"><span class="c41 c29">&nbsp; &nbsp; # Reads the names of the files, one by one</span></p><p class="c24"><span class="c41 c29">&nbsp; &nbsp; while read -d $&#39;\000&#39;; do</span></p><p class="c24"><span class="c41 c29">&nbsp; &nbsp; &nbsp; &nbsp; # Renames each file and adds the date and time of last modification</span></p><p class="c24"><span class="c41 c29">&nbsp; &nbsp; &nbsp; &nbsp; mv &quot;$REPLY&quot; &quot;$(date -d &quot;$(stat -c &#39;%y&#39; &quot;$REPLY&quot;)&quot; &#39;+%Y%m%d%H%M%S&#39;)-$REPLY&quot;</span></p><p class="c24"><span class="c41 c29">&nbsp; &nbsp; done</span></p><p class="c24"><span class="c41 c29">}</span></p><p class="c24 c16"><span class="c41 c29"></span></p><p class="c24"><span class="c41 c29">exit 0</span></p><p class="c24"><span class="c41 c29"># Warning: Test-drive this script in a &quot;scratch&quot; directory. </span></p><p class="c24"><span class="c41 c29"># It will somehow affect all the files there.</span></p><p class="c24 c16"><span class="c41 c29"></span></p></td></tr></table><p class="c21"><span class="c29 c65">This code renames every file in the directory and adds timestamps for the last time the files in that directory were modified.</span></p><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 222.67px;"><img alt="" src="images/image21.png" style="width: 630.14px; height: 222.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 c55"><span class="c29 c57 c28">--- </span></p><p class="c217"><span class="c29 c57 c28">d) A reader sent in the following code snippet.</span></p><table class="c32"><tr class="c156"><td class="c115" colspan="1" rowspan="1"><p class="c6 c181"><span class="c41 c29">while read LINE </span></p><p class="c95"><span class="c41 c29">do </span></p><p class="c94 c157"><span class="c41 c29">&nbsp;echo $LINE </span></p><p class="c95"><span class="c41 c29">done &lt; `tail -f /var/log/messages`</span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c70"><span class="c29 c57 c28">He wished to write a script tracking changes to the system log file, /var/log/messages. Unfortunately, the </span><span class="c29 c57">&nbsp;</span><span class="c29 c57 c28">above code block hangs and does nothing useful. Why? Fix this so it does work. (Hint: rather </span><span class="c29 c57">&nbsp;than </span><span class="c14">redirecting the stdin of the loop</span><span class="c29 c57">, try a </span><span class="c14">pipe</span><span class="c29 c57">.) </span></p><p class="c70 c16"><span class="c29 c57"></span></p><p class="c70"><span class="c29 c33">The response to the terminal from the original code:</span></p><p class="c70"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 57.33px;"><img alt="" src="images/image48.png" style="width: 630.14px; height: 57.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c70 c16"><span class="c29 c33"></span></p><p class="c70"><span class="c29 c33">The fixed code:</span></p><p class="c70 c16"><span class="c29 c33"></span></p><table class="c110 c93"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c5">#!/bin/bash</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5"># The script reads the file provided and pipe output to while</span></p><p class="c6"><span class="c5"># tail -f follows the file and shows new line as tehy are added</span></p><p class="c6"><span class="c5"># The pipe sends each new line to the while loop</span></p><p class="c6"><span class="c5">tail -f home/enkel/final-project/Part1/AnalyzingScripts/d` | while read LINE; do</span></p><p class="c6"><span class="c5">&nbsp; echo $LINE #Echo the current tail</span></p><p class="c6"><span class="c5">done #End LOOP</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">exit 0</span></p></td></tr></table><p class="c70"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 310.67px;"><img alt="" src="images/image22.png" style="width: 630.14px; height: 310.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c86 c55"><span class="c29 c57 c28">--- </span></p><p class="c161"><span class="c29 c57 c28">e) Analyze the following &quot;one-liner&quot; (here split into two lines for clarity) contributed by Rory &nbsp;Winston: </span></p><table class="c32"><tr class="c147"><td class="c115" colspan="1" rowspan="1"><p class="c95"><span class="c5 c61"># The original script</span></p><p class="c95"><span class="c5 c61"># export SUM=0; for f in $(find src -name &quot;*.java&quot;); </span></p><p class="c95"><span class="c5 c61"># do export SUM=$(($SUM + $(wc -l $f | awk &#39;{ print $1 }&#39;))); done; echo $SUM</span></p><p class="c95 c16"><span class="c5 c61"></span></p><p class="c95"><span class="c5 c61"># The modified script</span></p><p class="c95"><span class="c5 c61"># Initialize counter</span></p><p class="c95"><span class="c5 c61">export SUM=0</span></p><p class="c95 c16"><span class="c5 c61"></span></p><p class="c95"><span class="c5 c61"># Find all Java files</span></p><p class="c95"><span class="c5 c61">find src -name &quot;*.java&quot;</span></p><p class="c95 c16"><span class="c5 c61"></span></p><p class="c95"><span class="c5 c61"># Loop through files and count lines</span></p><p class="c95"><span class="c5 c61">for f in $(find src -name &quot;*.java&quot;); do</span></p><p class="c95"><span class="c5 c61">&nbsp; &nbsp; export SUM=$(($SUM + $(wc -l $f | awk &#39;{ print $1 }&#39;)))</span></p><p class="c95"><span class="c5 c61">done</span></p><p class="c95 c16"><span class="c5 c61"></span></p><p class="c95"><span class="c5 c61"># Display total</span></p><p class="c95"><span class="c5 c61">echo $SUM</span></p></td></tr></table><p class="c9"><span class="c0"></span></p><p class="c9"><span class="c0"></span></p><p class="c105 c120"><span class="c29 c57 c28">Hint: First, break the script up into bite-sized sections. Then, carefully examine its use of </span><span class="c14 c28">double </span><span class="c14">parentheses</span><span class="c133 c57">&nbsp;</span><span class="c29 c57">arithmetic, the </span><span class="c14">export </span><span class="c29 c57">command, the </span><span class="c14">find</span><span class="c133 c57">&nbsp;</span><span class="c29 c57">command, the </span><span class="c14">wc </span><span class="c29 c57">command, and </span><span class="c14">awk</span><span class="c29 c57">. </span></p><p class="c105 c120 c16"><span class="c29 c57"></span></p><p class="c105"><span class="c29 c65">This code counts all the lines of every &nbsp;.java file in the src directory and its subdirectories.</span></p><p class="c105"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 122.67px;"><img alt="" src="images/image35.png" style="width: 630.14px; height: 122.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c87 c169"><span class="c17">---</span><span class="c29 c52">&nbsp;</span></p><p class="c55 c200"><span class="c29 c76 c28">3) Designing Scripts</span><span class="c29 c76">&nbsp;</span></p><p class="c63"><span class="c20">1. Suppose in a directory that you wanted to change all the filenames ending in .f77 so that they &nbsp;instead ended in .f90. How would you go about it? </span></p><p class="c85"><span class="c20">If you&#39;re new to Unix you may need to find out how to change filenames. Typing apropos filename will list the programs and routines whose summaries mention filename. Alas, the most &nbsp;useful command isn&#39;t mentioned there. Typing apropos rename lists mv which is what you need. Maybe next you might try &quot;mv *.f77 *.f90&quot;. Alas, this won&#39;t work - the shell will replace *.f77 by &nbsp;a list of filenames and the resulting command will fail. You need to use a loop of some sort. You &nbsp;also need a way to remove a suffix (look up basename) and how to add a new suffix. It&#39;s worth &nbsp;experimenting with a single name first. Do filename=test.f77 and see if you can produce &nbsp;a test.f90 string from $filename . One solution is </span></p><p class="c6 c87 c16"><span class="c79 c57"></span></p><table class="c110 c87"><tr class="c96"><td class="c98 c112" colspan="1" rowspan="1"><p class="c93 c185"><span class="c79 c57">for filename in *.f77 </span></p><p class="c47 c87"><span class="c79 c57">do </span></p><p class="c47"><span class="c79 c57">&nbsp;b=$(basename $filename .f77) </span></p><p class="c47"><span class="c79 c57">&nbsp;mv $filename $b.f90</span></p><p class="c6 c87"><span class="c79 c57">done </span></p></td></tr></table><p class="c6 c87 c16"><span class="c79 c57"></span></p><p class="c6 c87"><span class="c79 c33">The script:</span></p><p class="c6 c87 c16"><span class="c33 c79"></span></p><table class="c110 c87"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c37">#!/bin/bash</span></p><p class="c6 c16"><span class="c37"></span></p><p class="c6"><span class="c37"># Rename all files in the directory that end with .f77, so that they end with .f90</span></p><p class="c6"><span class="c37">for file in *.f77; do</span></p><p class="c6"><span class="c37">&nbsp; &nbsp; b=$(basename &quot;$file&quot; .f77)</span></p><p class="c6"><span class="c37">&nbsp; &nbsp; mv &quot;$file&quot; &quot;$b.90&quot;</span></p><p class="c6"><span class="c37">done</span></p></td></tr></table><p class="c6 c87 c16"><span class="c79 c33"></span></p><p class="c6 c87"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 101.33px;"><img alt="" src="images/image4.png" style="width: 630.14px; height: 101.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c118"><span class="c20">2. Change the args script supplied earlier so that if no argument is provided, &quot;They are&#39;&#39; isn&#39;t printed, </span><span class="c79 c57">&nbsp;</span><span class="c20">and if exactly 1 argument is provided, &quot;... 1 argument&#39;&#39; rather than &quot;... 1 arguments&#39;&#39; is printed </span><span class="c79 c57">&nbsp;</span><span class="c20">(use if) </span></p><table class="c110 c203"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c37 c28">#!/bin/bash</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28"># Change the args script supplied earlier so that if no argument is provided, </span></p><p class="c6"><span class="c37 c28"># &quot;They are&#39;&#39; isn&#39;t printed, &nbsp;and if exactly 1 argument is provided, </span></p><p class="c6"><span class="c37 c28"># &quot;... 1 argument&#39;&#39; rather than &quot;... 1 arguments&#39;&#39; is printed &nbsp;(use if)</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">if [ $# -eq 0 ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; echo &quot;There are no arguments&quot;</span></p><p class="c6"><span class="c37 c28">elif [ $# -eq 1 ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; echo &quot;There is 1 argument&quot;</span></p><p class="c6"><span class="c37 c28">else</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; echo &quot;There are $# arguments&quot;</span></p><p class="c6"><span class="c37 c28">fi</span></p></td></tr></table><p class="c118"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 118.67px;"><img alt="" src="images/image55.png" style="width: 630.14px; height: 118.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c75"><span class="c20">3. Write a shell script that given a person&#39;s uid, tells you how many times that person is logged on. </span><span class="c79 c57">&nbsp;</span><span class="c20">(who, grep, wc) </span></p><p class="c75 c16"><span class="c20"></span></p><table class="c110 c173"><tr class="c114"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c37 c28">#!/bin/bash</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28"># &nbsp;Write a shell script that given a person&#39;s uid, </span></p><p class="c6"><span class="c37 c28"># tells you how many times that person is logged on. &nbsp;(who, grep, wc) </span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">if [ $# -eq 0 ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; echo &quot;Usage: $0 &lt;uid&gt;&quot;</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; exit 1</span></p><p class="c6"><span class="c37 c28">fi</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">uid=$1</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">username=$(getent passwd &quot;$uid&quot; | cut -d: -f1)</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">if [ -z &quot;$username&quot; ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; echo &quot;No user found with uid $uid&quot;</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; exit 1</span></p><p class="c6"><span class="c37 c28">fi</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">login_count=$(who | grep -c &quot;^$username &quot;| wc -l)</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">echo &quot;User $username (uid: $uid) is logged on $login_count time(s).&quot;</span></p></td></tr></table><p class="c75 c16"><span class="c20"></span></p><p class="c75"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 74.67px;"><img alt="" src="images/image59.png" style="width: 630.14px; height: 74.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c75 c16"><span class="c20"></span></p><p class="c43"><span class="c20">4. Write a shell script called lsdirs which lists </span><span class="c57 c28 c60">just </span><span class="c20">the directories in the current directory (test).</span></p><p class="c43 c16"><span class="c20"></span></p><table class="c110 c177"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c37 c28">#!/bin/bash</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">#Write a shell script called lsdirs which lists </span></p><p class="c6"><span class="c37 c28"># just the directories in the current directory (test).</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">ls -d */ </span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28"># ls =&gt; list files and directories</span></p><p class="c6"><span class="c37 c28"># -d =&gt; tells ls to list directories only</span></p><p class="c6"><span class="c37 c28"># */ =&gt; matches all directories</span></p></td></tr></table><p class="c43"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 96.00px;"><img alt="" src="images/image5.png" style="width: 630.14px; height: 96.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c43"><span class="c20">&nbsp;5. Write a shell script called see taking a filename name as argument which uses ls if the file&#39;s a </span><span class="c79 c57">&nbsp;</span><span class="c20">directory and more if the file&#39;s otherwise (test) </span></p><p class="c43 c16"><span class="c20"></span></p><table class="c110 c177"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c37 c28">#!/bin/bash</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28"># Write a shell script called see taking a filename name as argument </span></p><p class="c6"><span class="c37 c28"># which uses ls if the file&#39;s a &nbsp;directory and more if the file&#39;s otherwise (test)</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28"># Check if teh argument is provided</span></p><p class="c6"><span class="c37 c28">if [ $# -eq 0 ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; echo &quot;Usage: $0 filename&quot;</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; exit 1</span></p><p class="c6"><span class="c37 c28">fi</span></p><p class="c6"><span class="c37 c28"># check if the file/directory provided really exists</span></p><p class="c6"><span class="c37 c28">if [ ! -e &quot;$1&quot; ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; echo &quot;File or directory does not exist.&quot;</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; exit 1</span></p><p class="c6"><span class="c37 c28">fi</span></p><p class="c6"><span class="c37 c28"># Check if the argument is a directory or a file</span></p><p class="c6"><span class="c37 c28">if [ -d &quot;$1&quot; ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; ls &quot;$1&quot; # directory</span></p><p class="c6"><span class="c37 c28">else</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; more &quot;$1&quot; # file</span></p><p class="c6"><span class="c37 c28">fi</span></p></td></tr></table><p class="c43"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 132.00px;"><img alt="" src="images/image20.png" style="width: 630.14px; height: 132.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c100"><span class="c20">6. Write a shell script that asks the user to type a word in, then tells the user how long that word is. </span><span class="c79 c57">&nbsp;</span><span class="c20">(read, wc) </span></p><p class="c100 c16"><span class="c20"></span></p><table class="c110 c173"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c37 c28">#!/bin/bash</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28"># Write a shell script that asks the user to type a word in, </span></p><p class="c6"><span class="c37 c28"># then tells the user how long that word is. &nbsp;(read, wc) </span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">echo &quot;Please type a word:&quot;</span></p><p class="c6"><span class="c37 c28">read word</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">length=$(echo -n &quot;$word&quot; | wc -c)</span></p><p class="c6"><span class="c37 c28">echo &quot;The length of the word &#39;$word&#39; is $length characters.&quot;</span></p></td></tr></table><p class="c100"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 242.67px;"><img alt="" src="images/image17.png" style="width: 630.14px; height: 242.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c31"><span class="c20">7. In many versions of unix there is a </span><span class="c44 c28">-i </span><span class="c20">argument for </span><span class="c44 c28">cp </span><span class="c20">so that you will be prompted for confirmation </span><span class="c79 c57">&nbsp;</span><span class="c20">if you are about to overwrite a file. Write a script called cpi which will prompt if necessary without </span><span class="c79 c57">&nbsp;</span><span class="c20">using the </span><span class="c28 c44">-i</span><span class="c20">argument. (test)</span></p><p class="c31"><span class="c20">&nbsp; &nbsp; &nbsp; &nbsp;</span></p><table class="c110 c173"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c37 c28">#!/bin/bash</span></p><p class="c6"><span class="c37 c28">#Part1C -&gt; Exercise 7</span></p><p class="c6"><span class="c37 c28"># Copy file and prompt before overwriting</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">if [ $# -ne 2 ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; echo &quot;Usage: $0 &lt;source&gt; &lt;destination&gt;&quot;</span></p><p class="c6"><span class="c37 c28">&nbsp; exit 1</span></p><p class="c6"><span class="c37 c28">fi</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">if [ -f &quot;$2&quot; ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; echo &quot;File $2 exists. Overwrite? (y/n)&quot;</span></p><p class="c6"><span class="c37 c28">&nbsp; read answer</span></p><p class="c6"><span class="c37 c28">&nbsp; if [ &quot;$answer&quot; != &quot;y&quot; ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; echo &quot;Copy cancelled.&quot;</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; exit 0</span></p><p class="c6"><span class="c37 c28">&nbsp; fi</span></p><p class="c6"><span class="c37 c28">fi</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">cp &quot;$1&quot; &quot;$2&quot;</span></p><p class="c6 c16"><span class="c20"></span></p><p class="c6 c16"><span class="c20"></span></p></td></tr></table><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 282.67px;"><img alt="" src="images/image25.png" style="width: 630.14px; height: 282.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c20">&nbsp; &nbsp; &nbsp; </span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c16 c31"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c31 c16"><span class="c20"></span></p><p class="c64"><span class="c20">8. Write a shell script that takes a uid as an argument and prints out that person&#39;s name, home </span><span class="c79 c57">&nbsp;</span><span class="c20">directory, shell and group number. Print out the name of the group corresponding to the group </span><span class="c79 c57">&nbsp;</span><span class="c20">number, and other groups that person may belong to. (groups, awk, cut. Also look </span><span class="c79 c57">&nbsp;</span><span class="c20">at /etc/passwd and /etc/groups). </span></p><table class="c110 c180"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c37 c28">#!/bin/bash</span></p><p class="c6"><span class="c37 c28"># Cross-platform user info script for both Linux and macOS</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">if [ -z &quot;$1&quot; ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; echo &quot;Usage: $0 &lt;uid&gt;&quot;</span></p><p class="c6"><span class="c37 c28">&nbsp; exit 1</span></p><p class="c6"><span class="c37 c28">fi</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">uid=&quot;$1&quot;</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">OS_TYPE=$(uname)</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">if [[ &quot;$OS_TYPE&quot; == &quot;Darwin&quot; ]]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; username=$(dscl . -search /Users UniqueID &quot;$uid&quot; | awk &#39;{print $1}&#39;)</span></p><p class="c6"><span class="c37 c28">&nbsp; if [ -z &quot;$username&quot; ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; echo &quot;No such user&quot;</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; exit 1</span></p><p class="c6"><span class="c37 c28">&nbsp; fi</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">&nbsp; homedir=$(dscl . -read /Users/&quot;$username&quot; NFSHomeDirectory | cut -d &#39; &#39; -f2-)</span></p><p class="c6"><span class="c37 c28">&nbsp; shell=$(dscl . -read /Users/&quot;$username&quot; UserShell | cut -d &#39; &#39; -f2-)</span></p><p class="c6"><span class="c37 c28">&nbsp; gid=$(dscl . -read /Users/&quot;$username&quot; PrimaryGroupID | cut -d &#39; &#39; -f2-)</span></p><p class="c6"><span class="c37 c28">&nbsp; group_name=$(dscl . -search /Groups PrimaryGroupID &quot;$gid&quot; | awk &#39;{print $1}&#39;)</span></p><p class="c6"><span class="c37 c28">&nbsp; groups=$(id -Gn &quot;$username&quot;)</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">else</span></p><p class="c6"><span class="c37 c28">&nbsp; user_info=$(getent passwd &quot;$uid&quot;)</span></p><p class="c6"><span class="c37 c28">&nbsp; if [ -z &quot;$user_info&quot; ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; echo &quot;No such user&quot;</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; exit 1</span></p><p class="c6"><span class="c37 c28">&nbsp; fi</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">&nbsp; username=$(echo &quot;$user_info&quot; | cut -d: -f1)</span></p><p class="c6"><span class="c37 c28">&nbsp; homedir=$(echo &quot;$user_info&quot; | cut -d: -f6)</span></p><p class="c6"><span class="c37 c28">&nbsp; shell=$(echo &quot;$user_info&quot; | cut -d: -f7)</span></p><p class="c6"><span class="c37 c28">&nbsp; gid=$(echo &quot;$user_info&quot; | cut -d: -f4)</span></p><p class="c6"><span class="c37 c28">&nbsp; group_name=$(getent group &quot;$gid&quot; | cut -d: -f1)</span></p><p class="c6"><span class="c37 c28">&nbsp; groups=$(id -nG &quot;$username&quot;)</span></p><p class="c6"><span class="c37 c28">fi</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28"># Output</span></p><p class="c6"><span class="c37 c28">echo &quot;Name: $username&quot;</span></p><p class="c6"><span class="c37 c28">echo &quot;Home Directory: $homedir&quot;</span></p><p class="c6"><span class="c37 c28">echo &quot;Shell: $shell&quot;</span></p><p class="c6"><span class="c37 c28">echo &quot;Group Number: $gid&quot;</span></p><p class="c6"><span class="c37 c28">echo &quot;Group Name: $group_name&quot;</span></p><p class="c6"><span class="c73 c28 c111">echo &quot;Other Groups: $groups&quot;</span></p><p class="c6 c16"><span class="c20"></span></p></td></tr></table><p class="c16 c138"><span class="c20"></span></p><p class="c64"><span class="c57 c111 c28">&nbsp; &nbsp; &nbsp; </span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 483.32px; height: 793.71px;"><img alt="" src="images/image33.png" style="width: 483.32px; height: 793.71px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c16 c64"><span class="c20"></span></p><p class="c64 c16"><span class="c20"></span></p><p class="c64 c16"><span class="c20"></span></p><p class="c64 c16"><span class="c20"></span></p><p class="c64"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 497.14px; height: 818.71px;"><img alt="" src="images/image36.png" style="width: 497.14px; height: 818.71px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c64 c16"><span class="c20"></span></p><p class="c64 c16"><span class="c20"></span></p><p class="c64 c16"><span class="c20"></span></p><p class="c30"><span class="c20">9. Sort /etc/passwd using the uid (first field) as the key. (sort) </span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><table class="c108"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c37 c28">#!/bin/bash</span></p><p class="c6"><span class="c37 c28">#Part 1C -&gt; Exercise 9</span></p><p class="c6"><span class="c37 c28"># Sort /etc/passwd by UID</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">sort -n -t: -k3 /etc/passwd</span></p><p class="c6 c16"><span class="c37 c28"></span></p></td></tr></table><p class="c13"><span class="c20"></span></p><p class="c30"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 455.91px; height: 750.23px;"><img alt="" src="images/image49.png" style="width: 455.91px; height: 750.23px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c13"><span class="c20"></span></p><p class="c30"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 521.54px; height: 744.23px;"><img alt="" src="images/image12.png" style="width: 521.54px; height: 744.23px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c68 c16"><span class="c20"></span></p><p class="c68 c16"><span class="c20"></span></p><p class="c68 c16"><span class="c20"></span></p><p class="c68 c16"><span class="c20"></span></p><p class="c68 c16"><span class="c20"></span></p><p class="c68 c16"><span class="c20"></span></p><p class="c68 c16"><span class="c20"></span></p><p class="c68"><span class="c20">10. Suppose that you want to write the same letter to many people except that you want each letter </span><span class="c79 c57">&nbsp;</span><span class="c20">addressed to the senders personally. This </span><span class="c60 c57 c28">mailmerge </span><span class="c20">facility can be created using a shell script. Put </span><span class="c79 c57">&nbsp;</span><span class="c20">the names of the recipients (one per line) in a file called names, create a texfile </span><span class="c79 c57">&nbsp;</span><span class="c20">called template which has NAME wherever you want the person&#39;s name to appear and write a </span><span class="c79 c57">&nbsp;</span><span class="c20">script (using sed) to produce a temporary file called letter from the template file. </span></p><p class="c68 c16"><span class="c20"></span></p><p class="c68 c16"><span class="c20"></span></p><table class="c110 c215"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c37 c28">#!/bin/bash</span></p><p class="c6"><span class="c37 c28">#PArt 1C -&gt; Exercise 10</span></p><p class="c6"><span class="c37 c28"># Mail merge script to personalize letters</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">if [ ! -f names ] || [ ! -f template ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; echo &quot;Required files: names and template&quot;</span></p><p class="c6"><span class="c37 c28">&nbsp; exit 1</span></p><p class="c6"><span class="c37 c28">fi</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">while IFS= read -r name; do</span></p><p class="c6"><span class="c37 c28">&nbsp; sed &quot;s/NAME/$name/g&quot; template &gt; letter</span></p><p class="c6"><span class="c37 c28">&nbsp; # Here you would send the letter, e.g., using mail or another method</span></p><p class="c6"><span class="c37 c28">&nbsp; echo &quot;Sending letter to $name...&quot;</span></p><p class="c6"><span class="c73 c111 c28">done &lt; names</span></p></td></tr></table><p class="c68 c16"><span class="c20"></span></p><p class="c68 c16"><span class="c20"></span></p><p class="c68"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 333.33px;"><img alt="" src="images/image39.png" style="width: 630.14px; height: 333.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c68 c16"><span class="c20"></span></p><p class="c68 c16"><span class="c20"></span></p><p class="c16 c68"><span class="c20"></span></p><p class="c68 c16"><span class="c20"></span></p><p class="c68 c16"><span class="c20"></span></p><p class="c68 c16"><span class="c20"></span></p><p class="c16 c164"><span class="c20"></span></p><p class="c68 c16"><span class="c20"></span></p><p class="c78"><span class="c20">11. Write a shell script that implements the Rubik Cube based encryption. See the details in </span><span class="c79 c57">&nbsp;</span><span class="c57 c28 c182"><a class="c141" href="https://www.google.com/url?q=https://duksctf.github.io/2017/06/23/GoogleCTF2017-Rubik.html&amp;sa=D&amp;source=editors&amp;ust=1749992363176072&amp;usg=AOvVaw00PBxGaGVW7dMyNS-p8JUl">https://duksctf.github.io/2017/06/23/GoogleCTF2017-Rubik.html</a></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><table class="c110 c191"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c37 c28">#!/bin/bash</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">rotate_u() {</span></p><p class="c6"><span class="c37 c28">&nbsp; tmp=(&quot;${block[@]}&quot;)</span></p><p class="c6"><span class="c37 c28">&nbsp; block[0]=${tmp[6]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[1]=${tmp[3]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[2]=${tmp[0]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[3]=${tmp[7]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[4]=${tmp[4]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[5]=${tmp[1]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[6]=${tmp[8]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[7]=${tmp[5]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[8]=${tmp[2]}</span></p><p class="c6"><span class="c37 c28">}</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">rotate_u_prime() {</span></p><p class="c6"><span class="c37 c28">&nbsp; tmp=(&quot;${block[@]}&quot;)</span></p><p class="c6"><span class="c37 c28">&nbsp; block[0]=${tmp[2]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[1]=${tmp[5]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[2]=${tmp[8]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[3]=${tmp[1]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[4]=${tmp[4]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[5]=${tmp[7]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[6]=${tmp[0]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[7]=${tmp[3]}</span></p><p class="c6"><span class="c37 c28">&nbsp; block[8]=${tmp[6]}</span></p><p class="c6"><span class="c37 c28">}</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">encrypt_block() {</span></p><p class="c6"><span class="c37 c28">&nbsp; key=$1</span></p><p class="c6"><span class="c37 c28">&nbsp; input=$2</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">&nbsp; for ((i=0; i&lt;27; i++)); do</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; block[i]=$(printf &quot;%d&quot; &quot;&#39;${input:$i:1}&quot;)</span></p><p class="c6"><span class="c37 c28">&nbsp; done</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">&nbsp; for k in $key; do</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; case $k in</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; &nbsp; U) rotate_u ;;</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; &nbsp; U\&#39;) rotate_u_prime ;;</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; esac</span></p><p class="c6"><span class="c37 c28">&nbsp; done</span></p><p class="c6 c16"><span class="c14 c28"></span></p><p class="c6"><span class="c37 c28">&nbsp; for ((i=0; i&lt;27; i++)); do</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; printf \\$(printf &#39;%03o&#39; ${block[i]})</span></p><p class="c6"><span class="c37 c28">&nbsp; done</span></p><p class="c6"><span class="c37 c28">}</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">if [ $# -lt 2 ]; then</span></p><p class="c6"><span class="c37 c28">&nbsp; echo &quot;Usage: $0 &lt;key: e.g. \&quot;U U&#39; U\&quot;&gt; &lt;input_file&gt;&quot;</span></p><p class="c6"><span class="c37 c28">&nbsp; exit 1</span></p><p class="c6"><span class="c37 c28">fi</span></p><p class="c6 c16"><span class="c14 c28"></span></p><p class="c6"><span class="c37 c28">key=&quot;$1&quot;</span></p><p class="c6"><span class="c37 c28">infile=&quot;$2&quot;</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">while IFS= read -r -n27 -d &#39;&#39; chunk || [ -n &quot;$chunk&quot; ]; do</span></p><p class="c6"><span class="c28 c37">&nbsp; while [ ${#chunk} -lt 27 ]; do</span></p><p class="c6"><span class="c37 c28">&nbsp; &nbsp; chunk+=$&#39;\x00&#39;</span></p><p class="c6"><span class="c37 c28">&nbsp; done</span></p><p class="c6"><span class="c37 c28">&nbsp; encrypt_block &quot;$key&quot; &quot;$chunk&quot;</span></p><p class="c6"><span class="c37 c28">done &lt; &quot;$infile&quot;</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6"><span class="c37 c28">echo</span></p><p class="c6 c16"><span class="c37 c28"></span></p><p class="c6 c16"><span class="c14 c28"></span></p></td></tr></table><p class="c16 c78"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 305.33px;"><img alt="" src="images/image43.png" style="width: 630.14px; height: 305.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c78 c16"><span class="c14 c28"></span></p><p class="c152"><span class="c183 c76 c28">Part II</span><span class="c29 c76">&nbsp;</span></p><p class="c144"><span class="c29 c57">1) Implement &nbsp;</span></p><p class="c212"><span class="c29 c57">A) </span><span class="c29 c62">Multithreaded &ndash; synchronized solution </span><span class="c29 c57">of the producer-consumer WITH BOUNDED BUFFER &nbsp;problem in POSIX PTHREADS and JAVA (or PYTHON). You could start from source codes at &nbsp;</span><span class="c14">https://macboypro.wordpress.com/2009/05/25/producer-consumer-problem-using cpthreadsbounded-buffer/</span><span class="c133 c57">&nbsp;</span><span class="c29 c57">, </span><span class="c14">https://medium.com/@basecs101/producer-consumer problem-in-java-multi-threading-latest-2a306f003973</span><span class="c57 c133">&nbsp;</span><span class="c29 c57">. </span></p><p class="c12"><span class="c29 c57">Make an extensive comparison between the two solutions in terms of performance. Start with &nbsp;two threads, that is one producer and one consumer and generalize to M producers, K &nbsp;consumers and a buffer of N positions. Provide all graphs for the performance of these two &nbsp;solutions concerning execution of the multi threads involved regarding all resources needed &nbsp;(memory , CPU usage etc.) and time needed to execute the relevant multithreaded systems as functions of N, M, K. &nbsp;</span></p><p class="c12"><span class="c29 c33">Java Code:</span></p><p class="c12 c16"><span class="c29 c33"></span></p><table class="c46"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c5">import java.util.LinkedList;</span></p><p class="c6"><span class="c5">import java.util.concurrent.*;</span></p><p class="c6"><span class="c5">import java.util.concurrent.locks.*;</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">public class ProducerConsumer {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; private static Buffer buffer = new Buffer();</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; public static void main(String[] args) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; ExecutorService executor = Executors.newFixedThreadPool(2);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; executor.execute(new Producer());</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; executor.execute(new Consumer());</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; executor.shutdown();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; private static class Buffer {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; private static final int MAX = 4;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; private LinkedList&lt;Integer&gt; queue = new LinkedList&lt;&gt;();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; private static Lock lock = new ReentrantLock();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; private static Condition notEmpty = lock.newCondition();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; private static Condition notFull = lock.newCondition();</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; public void write(int value) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lock.lock();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try{</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while (queue.size() == MAX){</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(&quot;Buffer is full, producer is waiting...&quot;);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; notFull.await();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; queue.offer(value);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; notEmpty.signal();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }catch(InterruptedException e){</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.printStackTrace();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }finally {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lock.unlock();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; public int read(){</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int value = 0;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lock.lock();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try{</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while (queue.isEmpty()){</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(&quot;\tBuffer is empty, consumer is waiting...&quot;);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; notEmpty.await();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value = queue.remove();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; notFull.signal();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }catch(InterruptedException e){</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.printStackTrace();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }finally {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lock.unlock();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return &nbsp;value;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; private static class Producer implements Runnable {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; public void run() {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try{</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int i = 1;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while (true) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(&quot;Producing: &quot; + i);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.write(i++);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Thread.sleep((int)(Math.random() * 2000));</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }catch(InterruptedException e){</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.printStackTrace();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; private static class Consumer implements Runnable {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; public void run(){</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try{</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while(true){</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(&quot;\tConsuming: &quot; + buffer.read());</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Thread.sleep((int)(Math.random() * 2000));</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }catch(InterruptedException e){</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.printStackTrace();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">}</span></p></td></tr></table><p class="c12"><span class="c29 c33">POSIX code:</span></p><p class="c12 c16"><span class="c29 c33"></span></p><table class="c46"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c5">#include &lt;stdio.h&gt;</span></p><p class="c6"><span class="c5">#include &lt;stdlib.h&gt;</span></p><p class="c6"><span class="c5">#include &lt;pthread.h&gt;</span></p><p class="c6"><span class="c5">#include &lt;semaphore.h&gt;</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">#define BUFFER_SIZE 10</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">int buffer[BUFFER_SIZE];</span></p><p class="c6"><span class="c5">int count = 0;</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">pthread_mutex_t mutex;</span></p><p class="c6"><span class="c5">sem_t empty;</span></p><p class="c6"><span class="c5">sem_t full;</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">void *producer(void *param);</span></p><p class="c6"><span class="c5">void *consumer(void *param);</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">int main(){</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; pthread_t prod, cons;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; pthread_mutex_init(&amp;mutex, NULL);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; sem_init(&amp;empty, 0, BUFFER_SIZE);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; sem_init(&amp;full, 0, 0);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; </span></p><p class="c6"><span class="c5">&nbsp; &nbsp; pthread_create(&amp;prod, NULL, producer, NULL);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; pthread_create(&amp;cons, NULL, consumer, NULL);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; pthread_join(prod, NULL);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; pthread_join(cons, NULL);</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; pthread_mutex_destroy(&amp;mutex);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; sem_destroy(&amp;empty);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; sem_destroy(&amp;full);</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; return 0;</span></p><p class="c6"><span class="c5">}</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">void *producer(void *param){</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; int item;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; while(1){</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; item = rand() % 100;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; sem_wait(&amp;empty);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; pthread_mutex_lock(&amp;mutex);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; buffer[count++] = item;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;Producer produced: %d\n&quot;, item);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; pthread_mutex_unlock(&amp;mutex);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; sem_post(&amp;full);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">}</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">void *consumer(void *param){</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; int item;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; while(1){</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; sem_wait(&amp;full);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; pthread_mutex_lock(&amp;mutex);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; item = buffer[--count];</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;Consumer consumed: %d\n&quot;, item);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; pthread_mutex_unlock(&amp;mutex);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; sem_post(&amp;empty);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">}</span></p></td></tr></table><p class="c12 c16"><span class="c29 c33"></span></p><p class="c12 c16"><span class="c29 c33"></span></p><p class="c12 c16"><span class="c29 c33"></span></p><p class="c12 c16"><span class="c29 c33"></span></p><p class="c12 c16"><span class="c29 c33"></span></p><p class="c12 c16"><span class="c29 c33"></span></p><p class="c12 c16"><span class="c29 c33"></span></p><p class="c12"><span class="c33">Graphs:</span></p><p class="c12"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 562.54px; height: 363.42px;"><img alt="" src="images/image26.png" style="width: 562.54px; height: 363.42px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c12 c16"><span class="c29 c65"></span></p><p class="c12"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 552.47px; height: 360.84px;"><img alt="" src="images/image32.png" style="width: 552.47px; height: 360.84px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c122"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 571.42px; height: 366.43px;"><img alt="" src="images/image14.png" style="width: 571.42px; height: 366.43px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c122"><span class="c29 c33">Screenshots:</span></p><p class="c122"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 260.75px; height: 429.43px;"><img alt="" src="images/image60.png" style="width: 260.75px; height: 429.43px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 121.86px; height: 389.23px;"><img alt="" src="images/image57.png" style="width: 121.86px; height: 389.23px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c122"><span class="c29 c57">B) </span><span class="c29 c62">Multithreaded &ndash; synchronized solution </span><span class="c29 c57">of the dining philosophers&rsquo; synchronization problem again</span><span class="c57">&nbsp;</span><span class="c29 c57">both in JAVA (or PYTHON), starting with the code here &nbsp;</span><span class="c14">https://www.baeldung.com/java-dining-philoshophers </span><span class="c29 c57">and in POSIX pthreads as here, &nbsp;</span><span class="c14">https://sites.cs.ucsb.edu/~rich/class/cs170/notes/DiningPhil/index.html</span><span class="c29 c57">, using the &nbsp;algorithms and solutions developed in the Dining Philosophers Testbed with pthreads in this &nbsp;latter reference. Use, also, the solution we analyzed in the lectures (page 7.12 of the &nbsp;transparencies involving the monitor </span><span class="c29 c62">monitor DiningPhilosophers </span></p><p class="c97 c145"><span class="c29 c62">{ &nbsp;</span></p><p class="c213"><span class="c29 c62">enum { THINKING; HUNGRY, EATING) state [5] ;&hellip;&hellip;&hellip;.) </span></p><p class="c25"><span class="c29 c62">&nbsp;</span><span class="c29 c57">Again, as in A above generalize for N philosophers. Then, compare in detail all solutions &nbsp;providing all graphs for the performance of these solutions concerning execution of the multi &nbsp;threads involved regarding all resources needed (memory , CPU usage etc.) and time needed &nbsp;to execute the relevant multithreaded systems as functions of N. </span></p><p class="c25 c16"><span class="c29 c57"></span></p><p class="c25"><span class="c29 c33">Java:</span></p><p class="c25 c16"><span class="c29 c33"></span></p><table class="c110 c128"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">public class DiningPhilosophers {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; public static void main(String[] args) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; int N = 5; // Change as needed</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; Monitor monitor = new Monitor(N);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; for (int i = 0; i &lt; N; i++) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new Philosopher(i, monitor).start();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">}</span></p><p class="c6"><span class="c5">class Philosopher extends Thread {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; private final int id;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; private final Monitor monitor;</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; public Philosopher(int id, Monitor monitor) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; this.id = id;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; this.monitor = monitor;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; public void run() {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (int i = 0; i &lt; 100; i++) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(&quot;Philosopher &quot; + id + &quot; THINKING&quot;);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Thread.sleep((int)(Math.random() * 100));</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; monitor.takeForks(id);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(&quot;Philosopher &quot; + id + &quot; EATING&quot;);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Thread.sleep((int)(Math.random() * 100));</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; monitor.putForks(id);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; } catch (InterruptedException e) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Thread.currentThread().interrupt();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">}</span></p><p class="c6"><span class="c5">enum State { THINKING, HUNGRY, EATING }</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">class Monitor {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; private final int N;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; private final State[] state;</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; public Monitor(int n) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; this.N = n;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; this.state = new State[N];</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; for (int i = 0; i &lt; N; i++) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; state[i] = State.THINKING;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; public synchronized void takeForks(int i) throws InterruptedException {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; state[i] = State.HUNGRY;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; test(i);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; while (state[i] != State.EATING) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wait();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; public synchronized void putForks(int i) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; state[i] = State.THINKING;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; test((i + N - 1) % N);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; test((i + 1) % N);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; private void test(int i) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; if (state[i] == State.HUNGRY &amp;&amp;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; state[(i + N - 1) % N] != State.EATING &amp;&amp;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; state[(i + 1) % N] != State.EATING) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; state[i] = State.EATING;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; notifyAll();</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">}</span></p><p class="c6 c16"><span class="c5"></span></p></td></tr></table><p class="c25"><span class="c29 c33">POSIX:</span></p><p class="c25 c16"><span class="c29 c33"></span></p><table class="c110 c128"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c5">#include &lt;stdio.h&gt;</span></p><p class="c6"><span class="c5">#include &lt;stdlib.h&gt;</span></p><p class="c6"><span class="c5">#include &lt;pthread.h&gt;</span></p><p class="c6"><span class="c5">#include &lt;unistd.h&gt;</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">#define N 5</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">enum { THINKING, HUNGRY, EATING } state[N];</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">pthread_mutex_t mutex;</span></p><p class="c6"><span class="c5">pthread_cond_t self[N];</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">void test(int i) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; if (state[i] == HUNGRY &amp;&amp;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; state[(i + N - 1) % N] != EATING &amp;&amp;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; state[(i + 1) % N] != EATING) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; state[i] = EATING;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; pthread_cond_signal(&amp;self[i]);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">}</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">void take_forks(int i) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; pthread_mutex_lock(&amp;mutex);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; state[i] = HUNGRY;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; test(i);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; while (state[i] != EATING) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; pthread_cond_wait(&amp;self[i], &amp;mutex);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; pthread_mutex_unlock(&amp;mutex);</span></p><p class="c6"><span class="c5">}</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">void put_forks(int i) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; pthread_mutex_lock(&amp;mutex);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; state[i] = THINKING;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; test((i + N - 1) % N);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; test((i + 1) % N);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; pthread_mutex_unlock(&amp;mutex);</span></p><p class="c6"><span class="c5">}</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">void *philosopher(void *arg) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; int id = *(int *)arg;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for (int iter = 0; iter &lt; 100; ++iter) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;Philosopher %d is THINKING\n&quot;, id);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; usleep(rand() % 100000);</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; take_forks(id);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;Philosopher %d is EATING\n&quot;, id);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; usleep(rand() % 100000);</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; put_forks(id);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; return NULL;</span></p><p class="c6"><span class="c5">}</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">int main() {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; pthread_t threads[N];</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; int ids[N];</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; pthread_mutex_init(&amp;mutex, NULL);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for (int i = 0; i &lt; N; ++i) {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; pthread_cond_init(&amp;self[i], NULL);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; state[i] = THINKING;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; ids[i] = i;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for (int i = 0; i &lt; N; ++i)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; pthread_create(&amp;threads[i], NULL, philosopher, &amp;ids[i]);</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for (int i = 0; i &lt; N; ++i)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; pthread_join(threads[i], NULL);</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; pthread_mutex_destroy(&amp;mutex);</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for (int i = 0; i &lt; N; ++i)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; pthread_cond_destroy(&amp;self[i]);</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; return 0;</span></p><p class="c6"><span class="c5">}</span></p><p class="c6 c16"><span class="c5"></span></p></td></tr></table><p class="c25"><span class="c29 c33">Screenshots:</span></p><p class="c25"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 212.47px; height: 511.00px;"><img alt="" src="images/image15.png" style="width: 212.47px; height: 511.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 317.47px; height: 511.42px;"><img alt="" src="images/image44.png" style="width: 317.47px; height: 511.42px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c25"><span class="c29 c33">Graphs:</span></p><p class="c25"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 458.15px; height: 300.05px;"><img alt="" src="images/image16.png" style="width: 458.15px; height: 300.05px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c25"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 478.47px; height: 309.34px;"><img alt="" src="images/image56.png" style="width: 478.47px; height: 309.34px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c25"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 497.47px; height: 316.48px;"><img alt="" src="images/image40.png" style="width: 497.47px; height: 316.48px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c113 c16"><span class="c29 c57"></span></p><p class="c113 c16"><span class="c29 c57"></span></p><p class="c113 c16"><span class="c29 c57"></span></p><p class="c113 c16"><span class="c29 c57"></span></p><p class="c113 c16"><span class="c29 c57"></span></p><p class="c16 c113"><span class="c29 c57"></span></p><p class="c113"><span class="c29 c57">2) Find the Optimal TIME QUANTUM in Round-Robin CPU scheduling algorithm in a multilevel &nbsp;feedback queue. &nbsp;</span></p><p class="c216"><span class="c50">A) Consider N processes that are produced randomly with RANDOM Burst times (in the range 10 to 1000 time &nbsp;units) and arriving at random moments within a range of time 0 to M time units &lt;&lt; N. For instance 1000 &nbsp;processes arrived within 0..100 time units. N and M should vary, and they are independent variables. Consider &nbsp;the known multilevel feedback queue be</span><span class="c50">low</span></p><p class="c123"><span class="c50">Simulate this setup and study in detail through many runs (for instance 100-5000 processes for 100-500 independent &nbsp;simulations) the multilevel feedback queue scheduling problem in order to find optimal values for the two time &nbsp;quantum Q1, Q2 above so as to achieve. &nbsp;</span></p><p class="c56 c129"><span class="c69">n </span><span class="c50">Max throughput </span></p><p class="c56 c195"><span class="c69">n </span><span class="c50">Min turnaround time &nbsp;</span></p><p class="c88 c56"><span class="c69">n </span><span class="c50">Min waiting time &nbsp;</span></p><p class="c88 c56"><span class="c69">n </span><span class="c50">Min response time </span></p><p class="c143 c93"><span class="c50">for all N processes. </span></p><p class="c93 c136"><span class="c50">Present all your results in detail in tables and graphs. The code should be in JAVA/C++ /or PYTHON (preferably in &nbsp;Python). Each level i of the three-level feedback queue above is assigned a time Li. Therefore, if we assume 100 ms &nbsp;of time, the first level should run for L1, the second for L2 and the third one for 100-L1-L2. L1, L2 are again &nbsp;independent variables. In conclusion, you should present graphs and tables of the above criteria </span></p><p class="c129 c56"><span class="c69">n </span><span class="c50">Max throughput </span></p><p class="c88 c56"><span class="c69">n </span><span class="c50">Min turnaround time &nbsp;</span></p><p class="c97 c155"><span class="c50">With respect to Q1, Q2, L1, L2 </span></p><p class="c6 c56"><span class="c69">n </span><span class="c50">Min waiting time &nbsp;</span></p><p class="c56 c88"><span class="c69">n </span><span class="c50">Min response time </span></p><p class="c88 c56 c16"><span class="c50"></span></p><p class="c88 c56"><span class="c33">Python:</span></p><table class="c51"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c5">import random</span></p><p class="c6"><span class="c5">import queue</span></p><p class="c6"><span class="c5">import numpy as np</span></p><p class="c6"><span class="c5">import matplotlib.pyplot as plt</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">class Process:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; def __init__(self, pid, arrival_time, burst_time):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; self.pid = pid</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; self.arrival_time = arrival_time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; self.burst_time = burst_time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; self.remaining_time = burst_time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; self.start_time = None</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; self.completion_time = None</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; def __repr__(self):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; return f&quot;PID={self.pid}, AT={self.arrival_time}, BT={self.burst_time}, RT={self.remaining_time}&quot;</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">def generate_processes(N, M):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; processes = []</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for pid in range(N):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; arrival_time = random.randint(0, M)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; burst_time = random.randint(10, 1000)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; processes.append(Process(pid, arrival_time, burst_time))</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; return processes</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">def mlfq_scheduler(processes, Q1, Q2, L1, L2):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; time = 0</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; completed_processes = 0</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; level_queues = [queue.Queue(), queue.Queue(), queue.Queue()]</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; stats = {&#39;TAT&#39;: [], &#39;waiting_times&#39;: [], &#39;response_times&#39;: []}</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; process_queue = sorted(processes, key=lambda p: p.arrival_time)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; </span></p><p class="c6"><span class="c5">&nbsp; &nbsp; while completed_processes &lt; len(processes):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; while process_queue and process_queue[0].arrival_time &lt;= time:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; level_queues[0].put(process_queue.pop(0))</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; for level in range(3):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if not level_queues[level].empty():</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; current_process = level_queues[level].get()</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if current_process.start_time is None:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; current_process.start_time = time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time_slice = [Q1, Q2, current_process.remaining_time][level]</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; execution_time = min(time_slice, current_process.remaining_time)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; current_process.remaining_time -= execution_time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time += execution_time</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if current_process.remaining_time == 0:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; current_process.completion_time = time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; completed_processes += 1</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; turnaround_time = current_process.completion_time - current_process.arrival_time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; waiting_time = turnaround_time - current_process.burst_time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; response_time = current_process.start_time - current_process.arrival_time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stats[&#39;TAT&#39;].append(turnaround_time)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stats[&#39;waiting_times&#39;].append(waiting_time)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stats[&#39;response_times&#39;].append(response_time)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; next_level = min(level + 1, 2)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; level_queues[next_level].put(current_process)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; else:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time += 1 &nbsp;</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; return stats</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">def calculate_metrics(stats):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; avg_turnaround_time = np.mean(stats[&#39;TAT&#39;])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; avg_waiting_time = np.mean(stats[&#39;waiting_times&#39;])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; avg_response_time = np.mean(stats[&#39;response_times&#39;])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; throughput = len(stats[&#39;TAT&#39;]) / max(stats[&#39;TAT&#39;])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; return avg_turnaround_time, avg_waiting_time, avg_response_time, throughput</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">def run_simulations(num_simulations, N, M, Q1_values, Q2_values, L1_values, L2_values):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; results = []</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for Q1 in Q1_values:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; for Q2 in Q2_values:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for L1 in L1_values:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for L2 in L2_values:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if L1 + L2 &gt;= 100:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue &nbsp;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all_metrics = {&#39;TAT&#39;: [], &#39;waiting_times&#39;: [], &#39;response_times&#39;: [], &#39;throughputs&#39;: []}</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for _ in range(num_simulations):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; processes = generate_processes(N, M)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stats = mlfq_scheduler(processes, Q1, Q2, L1, L2)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; metrics = calculate_metrics(stats)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all_metrics[&#39;TAT&#39;].append(metrics[0])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all_metrics[&#39;waiting_times&#39;].append(metrics[1])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all_metrics[&#39;response_times&#39;].append(metrics[2])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all_metrics[&#39;throughputs&#39;].append(metrics[3])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; avg_metrics = (</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; np.mean(all_metrics[&#39;TAT&#39;]),</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; np.mean(all_metrics[&#39;waiting_times&#39;]),</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; np.mean(all_metrics[&#39;response_times&#39;]),</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; np.mean(all_metrics[&#39;throughputs&#39;])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; results.append((Q1, Q2, L1, L2, avg_metrics))</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; return results</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">def plot_results(results):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; fig, axs = plt.subplots(2, 2, figsize=(20, 12))</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for result in results:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; Q1, Q2, L1, L2, metrics = result</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; label = f&quot;Q1={Q1}, Q2={Q2}, L1={L1}, L2={L2}&quot;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; axs[0, 0].scatter(Q1, metrics[0], alpha=0.6, label=label)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; axs[0, 1].scatter(Q1, metrics[1], alpha=0.6, label=label)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; axs[1, 0].scatter(Q1, metrics[2], alpha=0.6, label=label)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; axs[1, 1].scatter(Q1, metrics[3], alpha=0.6, label=label)</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; axs[0, 0].set_title(&#39;Avg TAT vs Q1&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; axs[0, 1].set_title(&#39;Avg Waiting Time vs Q1&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; axs[1, 0].set_title(&#39;Avg Response Time vs Q1&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; axs[1, 1].set_title(&#39;Throughput vs Q1&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for ax in axs.flat:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; ax.set_xlabel(&#39;Q1&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; ax.set_ylabel(&#39;Metrics&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; </span></p><p class="c6"><span class="c5">&nbsp; &nbsp; handles, labels = axs[0, 0].get_legend_handles_labels()</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; fig.legend(handles, labels, loc=&#39;upper right&#39;, bbox_to_anchor=(1.15, 1))</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; plt.tight_layout(rect=[0, 0, 0.85, 1])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; plt.show()</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">N = 1000</span></p><p class="c6"><span class="c5">M = 100</span></p><p class="c6"><span class="c5">num_simulations = 10</span></p><p class="c6"><span class="c5">Q1_values = [10, 20, 30, 40, 50]</span></p><p class="c6"><span class="c5">Q2_values = [20, 40, 60, 80, 100]</span></p><p class="c6"><span class="c5">L1_values = [10, 20, 30, 40, 50]</span></p><p class="c6"><span class="c5">L2_values = [20, 40, 60, 80]</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">results = run_simulations(num_simulations, N, M, Q1_values, Q2_values, L1_values, L2_values)</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c73">plot_results(results)</span></p></td></tr></table><p class="c39"><span class="c33">&nbsp; &nbsp; &nbsp; Graphs:</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 665.40px; height: 470.48px;"><img alt="" src="images/image19.png" style="width: 783.15px; height: 470.48px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c39 c16"><span class="c29 c33"></span></p><p class="c194"><span class="c50">B) Consider the same setup as above but now in the third level both FCFS and SJF are running. Therefore, the &nbsp;time assigned for the third level is split in two using a Q percentage. Therefore, we run first SJF for T% of &nbsp;the time assigned in the third level and for (100-T)% we run second FCFS. &nbsp;</span></p><p class="c90"><span class="c50">Present AGAIN all your results in detail in tables and graphs The code should be in JAVA/C++ /or PYTHON &nbsp;(preferably in Python). Each level i of the three level feedback queue above is assigned AGAIN a time Li. &nbsp;Therefore, if we assume 100 ms of time the, the first level should run for L1, the second for L2 and the third &nbsp;one for 100-L1-L2. L1, L2 are again independent variables. In conclusion you should present graphs and &nbsp;tables of the following criteria </span></p><p class="c129 c56"><span class="c69">n </span><span class="c50">Max throughput </span></p><p class="c88 c56"><span class="c69">n </span><span class="c50">Min turnaround time &nbsp;</span></p><p class="c88 c56"><span class="c69">n </span><span class="c50">Min waiting time &nbsp;</span></p><p class="c88 c56"><span class="c69">n </span><span class="c50">Min response time </span></p><p class="c143"><span class="c50">&nbsp;With respect now to Q1, Q2, L1, L2 T. </span></p><p class="c143 c16"><span class="c50"></span></p><p class="c143 c16"><span class="c50"></span></p><p class="c143 c16"><span class="c50"></span></p><p class="c88 c56"><span class="c29 c33">Python:</span></p><p class="c88 c56 c16"><span class="c29 c33"></span></p><table class="c51"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c5">import random</span></p><p class="c6"><span class="c5">import queue</span></p><p class="c6"><span class="c5">import numpy as np</span></p><p class="c6"><span class="c5">import matplotlib.pyplot as plt</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">class Process:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; def __init__(self, pid, arrival_time, burst_time):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; self.pid = pid</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; self.arrival_time = arrival_time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; self.burst_time = burst_time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; self.remaining_time = burst_time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; self.start_time = None</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; self.completion_time = None</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; def __repr__(self):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; return f&quot;PID={self.pid}, AT={self.arrival_time}, BT={self.burst_time}, RT={self.remaining_time}&quot;</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">def generate_processes(N, M):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; processes = []</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for pid in range(N):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; arrival_time = random.randint(0, M)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; burst_time = random.randint(10, 1000)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; processes.append(Process(pid, arrival_time, burst_time))</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; return processes</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">def mlfq_scheduler(processes, Q1, Q2, L1, L2):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; time = 0</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; completed_processes = 0</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; level_queues = [queue.Queue(), queue.Queue(), queue.Queue()]</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; stats = {&#39;TAT&#39;: [], &#39;waiting_times&#39;: [], &#39;response_times&#39;: []}</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; process_queue = sorted(processes, key=lambda p: p.arrival_time)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; </span></p><p class="c6"><span class="c5">&nbsp; &nbsp; while completed_processes &lt; len(processes):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; while process_queue and process_queue[0].arrival_time &lt;= time:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; level_queues[0].put(process_queue.pop(0))</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; for level in range(3):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if not level_queues[level].empty():</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; current_process = level_queues[level].get()</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if current_process.start_time is None:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; current_process.start_time = time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time_slice = [Q1, Q2, current_process.remaining_time][level]</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; execution_time = min(time_slice, current_process.remaining_time)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; current_process.remaining_time -= execution_time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time += execution_time</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if current_process.remaining_time == 0:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; current_process.completion_time = time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; completed_processes += 1</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; turnaround_time = current_process.completion_time - current_process.arrival_time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; waiting_time = turnaround_time - current_process.burst_time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; response_time = current_process.start_time - current_process.arrival_time</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stats[&#39;TAT&#39;].append(turnaround_time)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stats[&#39;waiting_times&#39;].append(waiting_time)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stats[&#39;response_times&#39;].append(response_time)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; next_level = min(level + 1, 2)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; level_queues[next_level].put(current_process)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; else:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time += 1 &nbsp;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; return stats</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">def calculate_metrics(stats):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; avg_turnaround_time = np.mean(stats[&#39;TAT&#39;])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; avg_waiting_time = np.mean(stats[&#39;waiting_times&#39;])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; avg_response_time = np.mean(stats[&#39;response_times&#39;])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; throughput = len(stats[&#39;TAT&#39;]) / max(stats[&#39;TAT&#39;])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; return avg_turnaround_time, avg_waiting_time, avg_response_time, throughput</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">def run_simulations(num_simulations, N, M, Q1_values, Q2_values, L1_values, L2_values):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; results = []</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for Q1 in Q1_values:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; for Q2 in Q2_values:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for L1 in L1_values:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for L2 in L2_values:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if L1 + L2 &gt;= 100:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue </span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all_metrics = {&#39;TAT&#39;: [], &#39;waiting_times&#39;: [], &#39;response_times&#39;: [], &#39;throughputs&#39;: []}</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for _ in range(num_simulations):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; processes = generate_processes(N, M)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stats = mlfq_scheduler(processes, Q1, Q2, L1, L2)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; metrics = calculate_metrics(stats)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all_metrics[&#39;TAT&#39;].append(metrics[0])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all_metrics[&#39;waiting_times&#39;].append(metrics[1])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all_metrics[&#39;response_times&#39;].append(metrics[2])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all_metrics[&#39;throughputs&#39;].append(metrics[3])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; avg_metrics = (</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; np.mean(all_metrics[&#39;TAT&#39;]),</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; np.mean(all_metrics[&#39;waiting_times&#39;]),</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; np.mean(all_metrics[&#39;response_times&#39;]),</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; np.mean(all_metrics[&#39;throughputs&#39;])</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; results.append((Q1, Q2, L1, L2, avg_metrics))</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; return results</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">def plot_results(results):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; fig, axs = plt.subplots(2, 2, figsize=(20, 12))</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; markers = [&#39;o&#39;, &#39;s&#39;, &#39;^&#39;, &#39;D&#39;, &#39;v&#39;, &#39;&lt;&#39;, &#39;&gt;&#39;, &#39;p&#39;, &#39;*&#39;, &#39;h&#39;] &nbsp;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for idx, result in enumerate(results):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; Q1, Q2, L1, L2, metrics = result</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; label = f&quot;Q1={Q1}, Q2={Q2}, L1={L1}, L2={L2}&quot;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; marker = markers[idx % len(markers)] &nbsp;</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; axs[0, 0].scatter(Q1, metrics[0], alpha=0.6, label=label, marker=marker)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; axs[0, 1].scatter(Q1, metrics[1], alpha=0.6, label=label, marker=marker)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; axs[1, 0].scatter(Q1, metrics[2], alpha=0.6, label=label, marker=marker)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; axs[1, 1].scatter(Q1, metrics[3], alpha=0.6, label=label, marker=marker)</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; axs[0, 0].set_title(&#39;Avg TAT vs Q1&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; axs[0, 1].set_title(&#39;Avg Waiting Time vs Q1&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; axs[1, 0].set_title(&#39;Avg Response Time vs Q1&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; axs[1, 1].set_title(&#39;Throughput vs Q1&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for ax in axs.flat:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; ax.set_xlabel(&#39;Q1&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; ax.set_ylabel(&#39;Metrics&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; </span></p><p class="c6"><span class="c5">&nbsp; &nbsp; handles, labels = axs[0, 0].get_legend_handles_labels()</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; fig.legend(handles, labels, loc=&#39;upper center&#39;, bbox_to_anchor=(0.5, -0.05), ncol=4)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; plt.tight_layout()</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; plt.show()</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">N = 1000</span></p><p class="c6"><span class="c5">M = 100</span></p><p class="c6"><span class="c5">num_simulations = 10</span></p><p class="c6"><span class="c5">Q1_values = [10, 20, 30, 40, 50]</span></p><p class="c6"><span class="c5">Q2_values = [20, 40, 60, 80, 100]</span></p><p class="c6"><span class="c5">L1_values = [10, 20, 30, 40, 50]</span></p><p class="c6"><span class="c5">L2_values = [20, 40, 60, 80]</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">results = run_simulations(num_simulations, N, M, Q1_values, Q2_values, L1_values, L2_values)</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c73">plot_results(results)</span></p><p class="c6 c16"><span class="c29 c33"></span></p></td></tr></table><p class="c88 c56 c16"><span class="c29 c33"></span></p><p class="c39"><span class="c29 c33">&nbsp;Graphs:</span></p><p class="c39"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 378.67px;"><img alt="" src="images/image13.png" style="width: 630.14px; height: 378.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c48"><span class="c29 c57">3) Consider again N processes that are produced randomly with RANDOM Burst times (in the range &nbsp;10 to 1000 time units) and arriving at random moments within a range of time 0 to M time units &nbsp;For instance, 1000 processes arrived within 0..100 time units. N and M should vary, and they are &nbsp;independent variables. Suppose the same setup is repeated, after M time units have ended, with &nbsp;different N, M values again randomly selected. This process continues forever. Suppose finally &nbsp;that the system can SERVE up to R processes per time unit. The processes that exceed this number &nbsp;R should be postponed according to FCFS algorithm in order to be served. In this given setup &nbsp;calculate all quantities of M/M/1 and M/M/S queuing models. The population of processes is &nbsp;obviously infinite. You will calculate the averages of all known quantities when time goes to &nbsp;infinity. Also, calculate the same quantities when N, M, R are constant OVER TIME. In this case, draw all diagrams of how M/M/1, M/M/S quantities and probabilities vary with M, N, R. Is there &nbsp;any dependence on the random function used?? Change the random function used and show the &nbsp;differences.</span></p><p class="c48"><span class="c33">Python:</span></p><p class="c16 c48"><span class="c29 c57"></span></p><table class="c106"><tr class="c96"><td class="c98" colspan="1" rowspan="1"><p class="c6"><span class="c5">import numpy as np</span></p><p class="c6"><span class="c5">import pandas as pd</span></p><p class="c6"><span class="c5">import matplotlib.pyplot as plt</span></p><p class="c6"><span class="c5">import math</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5"># M/M/S Queue metrics</span></p><p class="c6"><span class="c5">def mms_metrics(lambda_rate, mu, s):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; rho = lambda_rate / (s * mu)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; if rho &gt;= 1:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; return None</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; def erlang_c(lambda_, mu_, s_):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; rho_ = lambda_ / (s_ * mu_)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; summation = sum((lambda_ / mu_)**n / math.factorial(n) for n in range(s_))</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; P0 = 1 / (summation + ((lambda_ / mu_)**s_ / (math.factorial(s_) * (1 - rho_))))</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; Pq = ((lambda_ / mu_)**s_ * P0) / (math.factorial(s_) * (1 - rho_))</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; return Pq</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5">&nbsp; &nbsp; Pq = erlang_c(lambda_rate, mu, s)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; Lq = Pq * lambda_rate / (s * mu - lambda_rate)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; Wq = Lq / lambda_rate</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; W = Wq + 1 / mu</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; L = lambda_rate * W</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; return {&#39;rho&#39;: rho, &#39;L&#39;: L, &#39;Lq&#39;: Lq, &#39;W&#39;: W, &#39;Wq&#39;: Wq}</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5"># Simulation setup</span></p><p class="c6"><span class="c5">N_values = [100, 150, 200]</span></p><p class="c6"><span class="c5">M_values = [100, 150, 200]</span></p><p class="c6"><span class="c5">R_values = [5, 10, 15, 20]</span></p><p class="c6"><span class="c5">mu = 0.5 &nbsp;# Service rate: 0.5 processes per unit time</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5"># Collect results</span></p><p class="c6"><span class="c5">data = []</span></p><p class="c6"><span class="c5">for N in N_values:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for M in M_values:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; for R in R_values:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lambda_rate = N / M</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; metrics = mms_metrics(lambda_rate, mu, R)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if metrics:</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; row = {</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#39;N&#39;: N,</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#39;M&#39;: M,</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#39;R&#39;: R,</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#39;lambda&#39;: lambda_rate,</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#39;rho&#39;: metrics[&#39;rho&#39;],</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#39;L&#39;: metrics[&#39;L&#39;],</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#39;Lq&#39;: metrics[&#39;Lq&#39;],</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#39;W&#39;: metrics[&#39;W&#39;],</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#39;Wq&#39;: metrics[&#39;Wq&#39;]</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data.append(row)</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5"># Create DataFrame</span></p><p class="c6"><span class="c5">df = pd.DataFrame(data)</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5"># Plotting function</span></p><p class="c6"><span class="c5">def plot_metric(metric):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; fig, ax = plt.subplots(figsize=(10, 6))</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; for M in sorted(df[&#39;M&#39;].unique()):</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; subset = df[df[&#39;M&#39;] == M]</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; ax.plot(subset[&#39;R&#39;], subset[metric], marker=&#39;o&#39;, label=f&#39;M={M}&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; ax.set_title(f&#39;{metric} vs R (for different M)&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; ax.set_xlabel(&#39;R (Number of Servers)&#39;)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; ax.set_ylabel(metric)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; ax.legend()</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; ax.grid(True)</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; plt.tight_layout()</span></p><p class="c6"><span class="c5">&nbsp; &nbsp; plt.show()</span></p><p class="c6 c16"><span class="c5"></span></p><p class="c6"><span class="c5"># Plot selected metrics</span></p><p class="c6"><span class="c5">plot_metric(&#39;L&#39;)</span></p><p class="c6"><span class="c5">plot_metric(&#39;Lq&#39;)</span></p><p class="c6"><span class="c5">plot_metric(&#39;W&#39;)</span></p><p class="c6"><span class="c5">plot_metric(&#39;Wq&#39;)</span></p><p class="c6"><span class="c73">plot_metric(&#39;rho&#39;)</span></p><p class="c6 c16"><span class="c29 c57"></span></p></td></tr></table><p class="c16 c189"><span class="c29 c57"></span></p><p class="c39"><span class="c29 c33">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c39 c16"><span class="c29 c33"></span></p><p class="c16 c39"><span class="c29 c33"></span></p><p class="c39 c16"><span class="c29 c33"></span></p><p class="c39 c16"><span class="c29 c33"></span></p><p class="c39 c16"><span class="c29 c33"></span></p><p class="c39 c16"><span class="c29 c33"></span></p><p class="c39 c16"><span class="c29 c33"></span></p><p class="c39 c16"><span class="c29 c33"></span></p><p class="c39 c16"><span class="c29 c33"></span></p><p class="c39"><span class="c29 c33">Graphs:</span></p><p class="c39"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 378.67px;"><img alt="" src="images/image41.png" style="width: 630.14px; height: 378.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c39"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 378.67px;"><img alt="" src="images/image6.png" style="width: 630.14px; height: 378.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c39"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 378.67px;"><img alt="" src="images/image10.png" style="width: 630.14px; height: 378.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c39"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 378.67px;"><img alt="" src="images/image45.png" style="width: 630.14px; height: 378.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c39"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 630.14px; height: 378.67px;"><img alt="" src="images/image58.png" style="width: 630.14px; height: 378.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c16 c186"><span class="c50"></span></p><p class="c16 c82"><span class="c50"></span></p><p class="c120 c16 c190"><span class="c104"></span></p><div><p class="c8"><span class="c0"></span></p></div></body></html>